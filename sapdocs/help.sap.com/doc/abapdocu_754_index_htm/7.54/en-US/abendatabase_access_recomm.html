<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENDATABASE_ACCESS_RECOMM -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abendatabase_access_recomm.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:52:50 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="Rules for Accessing ABAP-Managed Database Objects">
<title>
Rules for Accessing ABAP-Managed Database Objects - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abendatabase_access_recomm.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abendatabase_access_recomm.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_language_external_data.html')" class="blue">Processing External Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_sql.html')" class="blue">ABAP Database Access</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_managed_db_objects.html')" class="blue">ABAP-Managed Database Objects</a>&nbsp;&rarr;&nbsp;
</span>
<p><span class="h1">
Rules for Accessing ABAP-Managed Database Objects
</span></p>
<p>
The preceding sections
</p>
<ul class="disc">
<li>show an <a href="javascript:call_link('abenabap_managed_db_objects_oview.html')" class="blue">overview of ABAP-managed database objects</a></li>
</ul>
<ul class="disc">
<li>summarize <a href="javascript:call_link('abenabap_managed_db_objects_access.html')" class="blue">how ABAP-managed database objects are accessed</a>.</li>
</ul>
<p>
The following rules for accessing ABAP-managed database objects are based on these two points.
</p>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABENDATABASE_ACCESS_RECOMM_1" class="blue">Basic Rule</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABENDATABASE_ACCESS_RECOMM_2" class="blue">Rules for Valid Use</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENDATABASE_ACCESS_RECOMM_3" class="blue">ABAP SQL</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENDATABASE_ACCESS_RECOMM_4" class="blue">AMDP</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENDATABASE_ACCESS_RECOMM_5" class="blue">ABAP-Managed Native SQL</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENDATABASE_ACCESS_RECOMM_6" class="blue">Mixed Access</A></li>
</ul>
<A name="@@ITOC@@ABENDATABASE_ACCESS_RECOMM_1"></A>
<p><span class="h2">
Basic Rule
</span></p>
<dl><dd>
ABAP-managed database objects are only to be used by ABAP programs in AS ABAP and for access through its <a href="javascript:call_link('abendatabase_interface_glosry.html')" class="grey" title="Glossary Entry">database interface</a>.
</dd></dl>
<p>
The way in which instances of ABAP-managed database objects are created is the sole responsibility of AS ABAP. The actual implementation can change in incompatible ways when the release is upgraded. When using
<a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">non-ABAP managed Native SQL</a> to access objects, the same restrictions apply as when using
<a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">ABAP-managed Native SQL</a> (see below). Moreover, there is no
<a href="javascript:call_link('abennative_sql_interface_glosry.html')" class="grey" title="Glossary Entry">Native SQL interface</a>
that can act as a layer to catch any changes. For example, it is not even possible to guarantee the names of the ABAP-managed database objects, such as
<a href="javascript:call_link('abencds_database_view_glosry.html')" class="grey" title="Glossary Entry">CDS database views</a>,
<a href="javascript:call_link('abenamdp_procedure_glosry.html')" class="grey" title="Glossary Entry">AMDP procedures</a>, or
<a href="javascript:call_link('abenamdp_function_glosry.html')" class="grey" title="Glossary Entry">AMDP functions</a>. Access methods such as using a
<a href="javascript:call_link('abencds_database_view_glosry.html')" class="grey" title="Glossary Entry">CDS database view</a> as a data source of a
<a href="javascript:call_link('abenhana_view_glosry.html')" class="grey" title="Glossary Entry">SAP HANA view</a> or calling an
<a href="javascript:call_link('abenamdp_function_glosry.html')" class="grey" title="Glossary Entry">AMDP function</a> in a non-ABAP managed database procedure can become invalid at any time. Furthermore, the
<a href="javascript:call_link('abenhana_session_variables_abexa.html')" class="blue">ABAP-specific session variables</a> in the
SAP HANA database, which can modify the way ABAP-managed database objects work, are not set and where-used lists using ABAP methods are not possible. If
<a href="javascript:call_link('abendata_aging_glosry.html')" class="grey" title="Glossary Entry">data aging</a> is to be respected, this has to be programmed.
</p>
<p><span class="h4">
Note
</span></p>
<p>
In exceptional cases, applications can bypass this basic rule if they can accept the lack of technical
support provided by the AS ABAP infrastructure when ABAP-managed database objects are accessed from
outside AS ABAP and errors occur as a result. Applications are themselves responsible for avoiding errors like this and removing any errors that do occur:
</p>
<ul class="disc">
<li>Applications delivered by SAP must be secured reliably against errors. If necessary, the prerequisites for accessing ABAP-managed database objects from outside AS ABAP must be described in SAP Notes.</li>
</ul>
<ul class="disc">
<li>Partners and customers should only access ABAP-managed database objects from outside AS ABAP when this is allowed by SAP and when the associated prerequisites are known and can be met.</li>
</ul>
<A name="@@ITOC@@ABENDATABASE_ACCESS_RECOMM_2"></A>
<p><span class="h2">
Rules for Valid Use
</span></p>
<dl><dd>
Within the database, ABAP-managed database objects can only be accessed from other ABAP-managed database objects. ABAP programs should use
<a href="javascript:call_link('abenabap_managed_db_objects_osql.html')" class="blue">ABAP SQL</a> as the primary method for accessing ABAP-managed database objects.
<a href="javascript:call_link('abenabap_managed_db_objects_amdp.html')" class="blue">AMDP</a> should only be used when ABAP SQL is not enough. And
<a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">ABAP-managed Native SQL</a> should itself only be used when AMDP is not enough.
<a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">Non-ABAP managed Native SQL</a> is not used to access database objects, as specified in the basic rule.
</dd></dl>
<A name="@@ITOC@@ABENDATABASE_ACCESS_RECOMM_3"></A>
<p><span class="h3">
ABAP SQL
</span></p>
<p>
<a href="javascript:call_link('abenabap_managed_db_objects_osql.html')" class="blue">ABAP SQL</a> is the primary method for accessing
ABAP-managed database objects. Only ABAP SQL supports all functional and semantic attributes of ABAP-managed database objects. Any internal changes made to ABAP-managed database objects are handled by the
<a href="javascript:call_link('abenopen_sql_interface_glosry.html')" class="grey" title="Glossary Entry">ABAP SQL interface</a> and are transparent for the ABAP program.
</p>
<A name="@@ITOC@@ABENDATABASE_ACCESS_RECOMM_4"></A>
<p><span class="h3">
AMDP
</span></p>
<p>
In comparison with Native SQL, <a href="javascript:call_link('abenabap_managed_db_objects_amdp.html')" class="blue">AMDP</a>
provides a high-order wrapper of database-specific SQL. If the scope of ABAP SQL is not sufficient,
the first option is to try AMDP for access to ABAP-managed database objects. This mainly applies to
database procedure calls not supported in ABAP SQL, but also to wrappers of SQL elements that do not
yet exist in ABAP SQL and which do not have an adequate alternative, such as the use of non-supported built-in functions.
</p>
<p>
In principle, AMDP should only be used in accordance with its design:
</p>
<ul class="disc">
<li>Calls of <a href="javascript:call_link('abenamdp_method_glosry.html')" class="grey" title="Glossary Entry">AMDP methods</a> from ABAP or other AMDP methods.</li>
</ul>
<ul class="disc">
<li>Access to <a href="javascript:call_link('abencds_table_function_glosry.html')" class="grey" title="Glossary Entry">CDS table functions</a> using ABAP CDS and ABAP SQL.</li>
</ul>
<ul class="disc">
<li>If possible, no calls from Native SQL</li>
</ul>
<p>
The use of AMDP lifts or weakens some <a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">Native
SQL</a> restrictions, but it still far from provides the same support for functional and semantic attributes of ABAP-managed database objects as in ABAP SQL.
</p>
<p>
Most of the following rules for Native SQL apply also to the implementation of AMDP methods, particularly to DML writes.
</p>
<p><span class="h4">
Note
</span></p>
<p>
There is no benefit in moving SQL statements to AMDP methods, if they can be formulated in ABAP SQL. See the <a href="javascript:call_link('abenamdp_vs_open_sql_abexa.html')" class="blue">executable example</a>.
</p>
<A name="@@ITOC@@ABENDATABASE_ACCESS_RECOMM_5"></A>
<p><span class="h3">
ABAP-Managed Native SQL
</span></p>
<p>
<a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">ABAP-managed Native SQL</a>
(<a href="javascript:call_link('abenadbc.html')" class="blue">ADBC</a>, <a href="javascript:call_link('abennativesql.html')" class="blue"><span class="qtext">EXEC SQL</span></a>) is subject to most of the same restrictions as
<a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">non-ABAP-managed Native SQL</a>. The field order defined in ABAP Dictionary is just as impossible to know as the semantic attributes.
<a href="javascript:call_link('abennative_sql_type_mapping.html')" class="blue">Mappings</a> between ABAP types and database types are only possible for certain types. There is no
<a href="javascript:call_link('abenopen_sql_client_handling.html')" class="blue">implicit client handling</a> and the table buffer is always bypassed. The current instances of
<a href="javascript:call_link('abencds_entity_glosry.html')" class="grey" title="Glossary Entry">CDS entities</a> must be known
on the database, such as a CDS view with input parameters created as a database view or database function. Incompatible changes are also a possibility.
<a href="javascript:call_link('abencds_access_control_glosry.html')" class="grey" title="Glossary Entry">CDS access control</a> is bypassed. Access to objects using the
<a href="javascript:call_link('abennative_sql_interface_glosry.html')" class="grey" title="Glossary Entry">Native SQL interface</a>
offers some benefits over non-ABAP-managed Native SQL, such as the availability of environment information in session variables (on HANA only and non-modifiable) or the fact that
<a href="javascript:call_link('abendata_aging_glosry.html')" class="grey" title="Glossary Entry">data aging</a> is respected.
Despite this, this method should only be used if AMDP methods are not sufficient. The following rules should be followed in this case:
</p>
<ul class="disc">
<li>Only <a href="javascript:call_link('abendml_glosry.html')" class="grey" title="Glossary Entry">DML</a> read statements should be used.</li>
</ul>
<ul class="circlem2">
<li>These read statements should not be dependent on any other attributes of the ABAP-managed database objects, with the exception of their names and the names of components. It should be noted here that, when database objects of
<a href="javascript:call_link('abencds_entity_glosry.html')" class="grey" title="Glossary Entry">CDS entities</a> are accessed, even the name cannot be guaranteed</li>
</ul>
<ul class="circlem2">
<li><a href="javascript:call_link('abennative_sql_type_mapping.html')" class="blue">Mappings</a> between ABAP types and database
types are only possible for certain types. In all other cases, unexpected results or errors can occur. This applies in particular to platform-specific truncating or padding of values.</li>
</ul>
<ul class="circlem2">
<li>The field order is undefined and is not stable. <span class="qtext400">SELECT *</span>, for example, should not be used to access objects.</li>
</ul>
<ul class="circlem2">
<li>It is probable that an ABAP-managed database object is replaced by a different type of database object, such as a database table by a view.</li>
</ul>
<ul class="circlem2">
<li>If necessary, the ABAP-specific attributes that are respected automatically in ABAP SQL, such as client handling or special type conversions, must be programmed explicitly when using Native SQL.</li>
</ul>
<ul class="disc">
<li><a href="javascript:call_link('abendml_glosry.html')" class="grey" title="Glossary Entry">DML</a> write statements, such
as <span class="qtext400">INSERT</span>, <span class="qtext400">UPDATE</span> or, <span class="qtext400">DELETE</span>
can cause problems and should be avoided. Alongside the points for reads above, the following should be noted:</li>
</ul>
<ul class="circlem2">
<li>There are no ABAP-specific type conversions and
<a href="javascript:call_link('abennull_value_glosry.html')" class="grey" title="Glossary Entry">null values</a> are not avoided, which can cause data inconsistencies and problems when accessing objects in ABAP programs.</li>
</ul>
<ul class="circlem2">
<li>Native SQL writes are not registered by <a href="javascript:call_link('abenbuffer_synchro.html')" class="blue">buffer synchronization</a> in the
<a href="javascript:call_link('abenbuffer_synchro.html')" class="blue">table buffer</a>, which means they are not detected in ABAP SQL.</li>
</ul>
<ul class="circlem2">
<li>In certain phases in system delivery or in upgrades, ABAP-managed database objects that permit writes
can be replaced temporarily by database objects that reject writes. Hence, these objects would produce errors when accessed.</li>
</ul>
<ul class="disc">
<li>ABAP-managed database objects should never be accessed using
<a href="javascript:call_link('abenddl_glosry.html')" class="grey" title="Glossary Entry">DDL</a>. It is technically possible
to use DDL, however changes to the definition of ABAP-managed databases are the sole responsibility
of frameworks such as ABAP Dictionary or AMDP. In the worst case, the direct use of DDL for ABAP-managed database objects can make AS ABAP unusable.</li>
</ul>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>As is the case when using non-ABAP managed Native SQL, applications that use ABAP-managed Native SQL are responsible for any aspects not supported by the Native SQL interface. One example is when a
<a href="javascript:call_link('abencds_database_view_glosry.html')" class="grey" title="Glossary Entry">CDS database view</a> is accessed whose
<a href="javascript:call_link('abenddl_source_code_glosry.html')" class="grey" title="Glossary Entry">DDL source code</a> uses the
<a href="javascript:call_link('abencds_f1_session_variable.html')" class="blue">CDS session variable</a> <span class="qtext400">client</span>.
This is represented in the database object by the HANA session variable <span class="qtext400">CDS_CLIENT</span>,
which is not set by the Native SQL interface The application itself must provide the required value, otherwise it cannot access the object in question.</li>
</ul>
<ul class="disc">
<li>It might be possible to handle any future incompatible changes made to ABAP-managed database objects using the Native SQL interface, but this cannot be guaranteed.</li>
</ul>
<A name="@@ITOC@@ABENDATABASE_ACCESS_RECOMM_6"></A>
<p><span class="h3">
Mixed Access
</span></p>
<p>
The various types of access to ABAP-managed database objects can also occur in mixed forms (from a technical perspective). This means that, for one or more applications, it is possible to use
<a href="javascript:call_link('abenabap_managed_db_objects_osql.html')" class="blue">ABAP SQL</a>,
<a href="javascript:call_link('abenabap_managed_db_objects_amdp.html')" class="blue">AMDP</a>, or
<a href="javascript:call_link('abenabap_managed_db_objects_nsql.html')" class="blue">Native SQL</a> to access one and the same
database object. There is a risk here that mixing ABAP SQL with AMDP and Native SQL to access objects
can produce errors, since Native SQL expects ABAP-specific behavior that is only guaranteed when using ABAP SQL. Examples:
</p>
<ul class="disc">
<li>Different conversion rules when mapping non-matching types</li>
</ul>
<ul class="disc">
<li>Different handling of null values</li>
</ul>
<ul class="disc">
<li>Differently set environment information</li>
</ul>
<p>
For this reason, care should be taken to preserve the semantics of the ABAP SQL statements when using AMDP and Native SQL to access ABAP-managed data objects that can also be accessed by ABAP SQL.
</p>
<ul class="disc">
<li>When data is read using AMDP or Native SQL, the type conversions for non-matching types must be respected and the values may need to be modified to make them ABAP-specific.</li>
</ul>
<ul class="disc">
<li>When data is written using AMDP and Native SQL, it must not be modified in ways that make subsequent ABAP SQL statements behave differently than when changes are made using ABAP SQL.</li>
</ul>
<p>
In mixed access cases, all options in the implementation of AMDP methods or Native SQL should be exploited only as far as they do not endanger the consistency of an ABAP-managed data model.
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abendatabase_access_recomm.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:52:50 GMT -->
</html>
