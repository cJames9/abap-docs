<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENDDICDDL_DEFINE_FILTER_DRUL -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abenddicddl_define_filter_drul.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:45 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="DEFINE FILTER DEPENDENCY RULE">
<meta name="keywords" content="ABAP, Dictionary, DEFINE FILTER DEPENDENCY RULE">
<title>
DEFINE FILTER DEPENDENCY RULE - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abenddicddl_define_filter_drul.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abenddicddl_define_filter_drul.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_dictionary.html')" class="blue">ABAP - Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenddic_dependency_rules.html')" class="blue">Dependency Rules in ABAP Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenddic_define_dependency_rule.html')" class="blue">Dictionary DDL for defining dependency rules</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenddicddl_define_drul.html')" class="blue">DEFINE DEPENDENCY RULE</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@DEFINE FILTER DEPENDENCY RULE@@!ABAP_DDIC_STATEMENT!@@"></A>
<p><span class="h1">
DEFINE FILTER DEPENDENCY RULE
</span></p>
<A name="@@ITOC@@ABENDDICDDL_DEFINE_FILTER_DRUL_1"></A>
<p><span class="h2">
Syntax
</span></p>
<p>
<span class="qtext400">DEFINE FILTER DEPENDENCY RULE drul <br>&nbsp;&nbsp;ON dbtab <br>&nbsp;&nbsp;&nbsp;&nbsp;IF { cond_pattern } <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN { derived_cond }</span>
</p>
<p><span class="h4">
Effect
</span></p>
<p>
Variant of the <a href="javascript:call_link('abendictionary_ddl_glosry.html')" class="grey" title="Glossary Entry">Dictionary
DDL</a> statement <a href="javascript:call_link('abenddicddl_define_drul.html')" class="blue"><span class="qtext400">DEFINE DEPENDENCY RULE</span></a> used to define a filter
<a href="javascript:call_link('abendependency_rule_glosry.html')" class="grey" title="Glossary Entry">dependency rule</a>. A
filter dependency rule can be defined for precisely one database table <span class="qtext400">dbtab</span>.
It derives an additional filter condition <span class="qtext400">derived_cond</span> from the pattern
<span class="qtext400">cond_pattern</span> When the database table is read, the SAP HANA database optimizer
finds the pattern in the <span class="qtext400">WHERE</span> condition and, if necessary, adds the additional filter condition <span class="qtext">AND</span> to this condition.
</p>
<p>
<span class="bold">cond_pattern</span>
</p>
<p>
In <span class="qtext400">cond_pattern</span>, a pattern from a relational expression can be specified in the curly brackets after <span class="qtext400">IF</span> as follows:
</p>
<p>
<span class="qtext400">lhs =<i class=bn>|</i>&lt;<i class=bn>|</i>><i class=bn>|</i>&lt;=<i class=bn>|</i>>= rhs</span>
</p>
<p>
It is not possible to join multiple expressions using <span class="qtext400">AND</span> or <span class="qtext400">OR</span> or to negate them using <span class="qtext400">NOT</span>.
</p>
<ul class="disc">
<li>The following can be specified as the left side <span class="qtext400">lhs</span> of the comparison:</li>
</ul>
<ul class="circlem2">
<li><span class="qtext400">dbtab.column</span> for a column <span class="qtext400">column</span> of the database table <span class="qtext400">dbtab</span>.</li>
</ul>
<ul class="disc">
<li>The following can be specified as the right side <span class="qtext400">rhs</span> of the comparison:</li>
</ul>
<ul class="circlem2">
<li><span class="qtext400">dbtab.column</span> for a column <span class="qtext400">column</span> of the database table <span class="qtext400">dbtab</span>.</li>
</ul>
<ul class="circlem2">
<li>A character literal or a numeric literal. This syntax is the same as in <a href="javascript:call_link('abencds_f1_literal.html')" class="blue">literals in ABAP CDS</a>, but without the domain prefix.</li>
</ul>
<ul class="circlem2">
<li>A numbered placeholder <span class="qtext400">$1</span>, <span class="qtext400">$2</span>, ...</li>
</ul>
<p>
<span class="bold">derived_cond</span>
</p>
<p>
In <span class="qtext400">derived_cond</span>, a template from a relational expression can be specified in the curly brackets after <span class="qtext400">THEN</span> as follows:
</p>
<p>
<span class="qtext400">lhs =<i class=bn>|</i>&lt;<i class=bn>|</i>><i class=bn>|</i>&lt;=<i class=bn>|</i>>= rhs <i
class=bn>[</i>OR lhs =<i class=bn>|</i>&lt;<i class=bn>|</i>><i class=bn>|</i>&lt;=<i class=bn>|</i>>= rhs ...<i class=bn>]</i></span>
</p>
<p>
Single comparisons cannot be placed in parentheses <span class="qtext400">( )</span>. Negations using <span class="qtext400">NOT</span> are not possible.
</p>
<ul class="disc">
<li>The following can be specified as the left side <span class="qtext400">lhs</span> of a comparison:</li>
</ul>
<ul class="circlem2">
<li><span class="qtext400">dbtab.column</span> for the column <span class="qtext400">column</span> of the database table <span class="qtext400">dbtab</span>.</li>
</ul>
<ul class="disc">
<li>The following can be specified as the right side <span class="qtext400">rhs</span> of a comparison:</li>
</ul>
<ul class="circlem2">
<li><span class="qtext400">dbtab.column</span> for the column <span class="qtext400">column</span> of the database table <span class="qtext400">dbtab</span>.</li>
</ul>
<ul class="circlem2">
<li>A character literal or a numeric literal. This syntax is the same as in <a href="javascript:call_link('abencds_f1_literal.html')" class="blue">literals in ABAP CDS</a>, but without the domain prefix.</li>
</ul>
<ul class="circlem2">
<li>A numbered placeholder <span class="qtext400">$1</span>, <span class="qtext400">$2</span>, ...,
which must also be specified in <span class="qtext400">cond_pattern</span>. When the condition is added,
the operand for the condition is inserted here for which the same placeholder exists in the pattern <span class="qtext400">cond_pattern</span>.</li>
</ul>
<ul class="circlem2">
<li><a href="javascript:call_link('abenddic_builtin_functions.html')" class="blue">Built-in functions in ABAP Dictionary</a> in <a href="javascript:call_link('abencds_f1_builtin_functions.html')" class="blue">ABAP CDS</a> syntax.</li>
</ul>
<ul class="circlem2">
<li><a href="javascript:call_link('abencds_f1_simple_case_expression.html')" class="blue">Simple case distinctions</a> in ABAP CDS syntax.</li>
</ul>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>It cannot be guaranteed that the SAP HANA database finds the pattern <span class="qtext400">cond_pattern</span>.
This is why the additional condition <span class="qtext400">derived_cond</span> must not modify the
results set of the original query. This is technically possible, but produces undefined behavior in
cases where the SAP HANA database optimizer finds the pattern <span class="qtext400">cond_pattern</span> in some reads but not in others.</li>
</ul>
<ul class="disc">
<li>The additional condition for a query can be viewed in the
<a href="javascript:call_link('abensql_trace_glosry.html')" class="grey" title="Glossary Entry">SQL Trace</a> tool (transaction <span class="lnkgrey">ST05</span>) by choosing <span class="italic">Display Execution Plan</span>.</li>
</ul>
<p><span class="h4">
Example
</span></p>
<p>
The following dependency rule demonstrates how the additional condition works:
</p>
<dl><dd>
<span class="qtext400">DEFINE FILTER DEPENDENCY RULE demo_drul_1 <br>&nbsp;&nbsp;ON demo_parts_1 <br>&nbsp;&nbsp;&nbsp;&nbsp;IF { demo_parts_1.value > $1 } <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN { demo_parts_1.area = $1 }</span>
</dd></dl>
<p>
On the SAP HANA database, it modifies the results set of every read performed on the database table
DEMO_PARTS_1. This is done for demonstration purposes here and should never occur in real situations.
The program <span class="lnkgrey">DEMO_DEPENDENCY_RULE_1</span>uses identical <span class="qtext">SELECT</span>
statements to access the database table DEMO_PARTS_1 with a dependency rule and an identical table, DEMO_PARTS, without a dependency rule:
</p>
<dl><dd>
<span class="qtext">DATA num TYPE i. <br>cl_demo_input=>request( CHANGING field = num ). <br> <br>"Dependency Rule demo_drul_1 <br>
SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM demo_parts_1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE value > @num <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ORDER BY id <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(result1). <br>
cl_demo_output=>write( result1 ). <br> <br>"No Dependency Rule <br>SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM demo_parts <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE value > @num <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ORDER BY id <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(result2). <br>cl_demo_output=>display( result2 ).</span>
</dd></dl>
<p>
When DEMO_PARTS_1 is accessed, the SAP HANA database optimizer evaluates the dependency rule. It finds the pattern
</p>
<p>
<span class="qtext400">demo_parts_1.value > $1</span>
</p>
<p>
and adds the additional condition accordingly to create the following logical condition:
</p>
<p>
<span class="qtext">WHERE value > @num AND area = @num</span>.
</p>
<p>
This restricts the results set to those rows in which the column AREA also has the value of <span class="qtext">num</span>. This restriction does not apply when DEMO_PARTS is accessed.
</p>
<p>
If the first <span class="qtext">SELECT</span> statement is transformed into a <a href="javascript:call_link('abapwith.html')" class="blue">
<span class="qtext">WITH</span></a> statement or if alias names are used, for example, the optimizer
may not find the pattern and may not add an additional condition. In this case, the result of this example is dependent on the behavior of the optimizer, which should never occur in production programs.
</p>
<p><span class="h4">
Example
</span></p>
<p>
The following filter dependency rule for the database table DEMO_PARTS_2 must not modify the results set. For this to happen, the data in the database table must have the expected values.
</p>
<dl><dd>
<span class="qtext400"> DEFINE FILTER DEPENDENCY RULE demo_drul_2 <br>&nbsp;&nbsp;ON demo_parts_2 <br>&nbsp;&nbsp;&nbsp;&nbsp;IF { demo_parts_2.value >= 30 } <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN { demo_parts_2.area >= 3 }</span>
</dd></dl>
<p>
The program <span class="lnkgrey">DEMO_DEPENDENCY_RULE_2</span>uses identical <span class="qtext">SELECT</span>
statements to access the database table DEMO_PARTS_2 with a dependency rule and an identical table, DEMO_PARTS, without a dependency rule:
</p>
<dl><dd>
<span class="qtext"> <br>"Dependency Rule demo_drul_2 <br>SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM demo_parts_2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE value >= 30&nbsp;&nbsp;AND value &lt; 40 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ORDER BY id <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(result1). <br> <br>"No Dependency Rule <br>SELECT * <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM demo_parts <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE value >= 30 AND value &lt; 40 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ORDER BY id <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(result2). <br> <br>ASSERT result1 = result2.</span>
</dd></dl>
<p>
If the data in the database table is structured so that in rows where the column VALUE contains values
greater than or equal to 30 the values in the column AREA are greater than or equal to 3, the results
sets of both reads are identical. To derive an additional condition with a dependency on the condition
<span class="qtext">value &lt; 40</span>, a further filter dependency rule could be defined for the same database table.
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abenddicddl_define_filter_drul.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:45 GMT -->
</html>
