<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPLOOP_AT_ITAB_GROUP_BY_KEY -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaploop_at_itab_group_by_key.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:51 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="LOOP AT itab - group_key">
<title>
LOOP AT itab - group_key - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abaploop_at_itab_group_by_key.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abaploop_at_itab_group_by_key.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_data_working.html')" class="blue">Processing Internal Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenitab.html')" class="blue">Internal Tables</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abentable_processing_statements.html')" class="blue">Processing Statements for Internal Tables</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abaploop_at_itab_variants.html')" class="blue">LOOP AT itab</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abaploop_at_itab_group_by.html')" class="blue">LOOP AT itab - GROUP BY</a>&nbsp;&rarr;&nbsp;
</span>
<p><span class="h1">
LOOP AT itab - group_key
</span></p>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext"> ... key <i class=bn>|</i> ( key1 = dobj1 key2 = dobj2 ... <br>&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i>gs = GROUP SIZE<i class=bn>]</i> <i class=bn>[</i>gi = GROUP INDEX<i class=bn>]</i> ) ...</span> <br><br>
</P>
<p><span class="h3">
Extras:
</span></p>
<P>
   <A HREF="#!ABAP_ADDITION_1@1@" class="blue"> 1. <span class="qtext">... gs = GROUP SIZE</span> </A> <br><br><A HREF="#!ABAP_ADDITION_2@2@" class="blue"> 2. <span class="qtext">... gi = GROUP INDEX</span> </A> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
Group key expression for constructing the group key in the
<a href="javascript:call_link('abaploop_at_itab_group_by.html')" class="blue">grouping</a> of internal tables. The group key is the result of the group key expression, whose data type is defined as follows:
</P>
<ul class="disc">
<li>
If <span class="qtext">key</span> is specified, the group key is a single data object with any data type.
<br><br></li>
<li>
If <span class="qtext">( key1 = dobj1 key2 = dobj2 ...
)</span> is specified, the group key is a structure with the components <span class="qtext">key1</span>,
<span class="qtext">key2</span>, ... The components can have any names and any data types. The structure type is defined here as a bound data type of the structure.
<br></li>
</ul>
<P>
<span class="qtext">key</span> or <span class="qtext">key1</span>, <span class="qtext">key2</span>, ... are
<a href="javascript:call_link('abengeneral_expr_position_glosry.html')" class="grey" title="Glossary Entry">general expression
positions</a> in which the current row can be used in accordance with the output behavior defined in
<a href="javascript:call_link('abaploop_at_itab.html')" class="blue"><span class="qtext">result</span></a>. The data types of
<span class="qtext">key</span> or <span class="qtext">key1</span>, <span class="qtext">key2</span>, ... must be known completely and statically.
</P>
<P>
For each row of the internal table <span class="qtext">itab</span> read in the grouping phase, the value
of the group key is calculated from the data objects, expressions, or calls specified here using the group key expression.
</P>
<P>
If a group key binding is defined in the output behavior <a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">
<span class="qtext">group_result</span></a> of the group loop, the data object or field symbol specified here can be used to access the value of the group key of every group in the group loop.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
If the grouping is to be useful, the value of the group key calculated for every read row of <span class="qtext">itab</span> must have a suitable relationship to the row in question. The following are some special cases:
<br></li>
</ul>
<ul class="circlem2">
<li>If the group key is a value that depends on the row, there is only one group to which all read rows belong.</li>
</ul>
<ul class="circlem2">
<li>If the group key is different for every read row, there are the same number of groups as rows and each group contains only one row.</li>
</ul>
<dl>

<dd>
The simplest cases are direct assignments of values of the row to the group key or its components. The right side comprises general expression positions, which means that any type of evaluation is possible.
</dd>
</dl>
<ul class="disc">
<li>
The ability to directly construct any type of structure makes it easy to create multi-component group
keys without needing to declare a matching structure first or to concatenate the key components in, for example, a string.
<br><br></li>
<li>
The syntax shown here applies both to groupings with <a href="javascript:call_link('abaploop_at_itab_group_by.html')" class="blue"><span class="qtext">
LOOP AT itab ... GROUP BY</span></a> and to groupings with <a href="javascript:call_link('abenfor_groups_of.html')" class="blue"><span class="qtext">FOR GROUPS ... OF</span></a>. <br><br>
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<p>
A structured group key is used to group by more than just one criterion. The group criteria here are
simply columns of the internal table. This is a representative binding, in which the work area <span class="qtext">wa</span> is reused in the group loop to access the group key.
</p>
<p class="qtextml1">
<span class="qtext">
SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM spfli <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(spfli_tab). <br>
 <br>LOOP AT spfli_tab INTO DATA(wa) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY ( key1 = wa-carrid key2 = wa-airpfrom ). <br>
&nbsp;&nbsp;cl_demo_output=>write( |{ wa-carrid } { wa-airpfrom }| ). <br>ENDLOOP. <br>cl_demo_output=>display( ). <br><br>
</span>
</p>
<A NAME="@@GROUP SIZE@@LOOP AT GROUP BY@@"></A>
<A NAME="@@GROUP INDEX@@LOOP AT GROUP BY@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_1@1@"></A> <span class="bold">Addition 1</span>
</span></p>
<P>
 <span class="qtext">... gs = GROUP SIZE</span>   <br><!-- /A -->
</P>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_2@2@"></A> <span class="bold">Addition 2</span>
</span></p>
<P>
 <span class="qtext">... gi = GROUP INDEX</span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
Declares additional components for a structured group key. These components are not part of the group key and are used as a repository of group-specific information instead:
</P>
<ul class="disc">
<li>
The component <span class="qtext">gs</span> is filled with the number of group members for each group.
<br><br></li>
<li>
The component <span class="qtext">gi</span> is filled with a group index for each group. The group index of the group key constructed first is 1 and is raised by 1 for each new group key.
<br></li>
</ul>
<P>
Before the additional components can be declared, a group key binding must be defined in the output
behavior <a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue"><span class="qtext">group_result</span></a>.
The additional components can be accessed in the group loop using the data object or field symbol specified here.
</P>
<P>
The components <span class="qtext">gs</span> and <span class="qtext">gi</span> can be given any name.
The language elements <span class="qtext">GROUP SIZE</span> or <span class="qtext">GROUP INDEX</span> on the right side give the components their special semantics.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
If the groups are not sorted using <a href="javascript:call_link('abaploop_at_itab_group_by.html')" class="blue"><span class="qtext">ASCENDING</span></a>
or <a href="javascript:call_link('abaploop_at_itab_group_by.html')" class="blue"><span class="qtext">DESCENDING</span></a>, the
groups in the group loop are processed in the order of the group index. If the groups are sorted in different ways, the original position is noted in the group index.
<br><br></li>
<li>
The additional components can still be evaluated even if the addition <a href="javascript:call_link('abaploop_at_itab_group_by.html')" class="blue"><span class="qtext">WITHOUT MEMBERS</span></a> is used and the group members cannot be accessed.
<br><br></li>
<li>
Implicitly, no further values are created that match the results of
<a href="javascript:call_link('abenaggregate_expression_glosry.html')" class="grey" title="Glossary Entry">aggregate expressions</a>
when <a href="javascript:call_link('abapgroupby_clause.html')" class="blue"><span class="qtext">GROUP BY</span></a> is used in
the ABAP SQL statement <a href="javascript:call_link('abapselect.html')" class="blue"><span class="qtext">SELECT</span></a>,
except in the component <span class="qtext">gs</span> with the right side <span class="qtext">GROUP SIZE</span>. Aggregations like this are easy to program (see the
<a href="javascript:call_link('abenloop_group_by_aggregates_abexa.html')" class="blue">example</a>), particularly when applying
constructor operators such as <a href="javascript:call_link('abenconstructor_expression_reduce.html')" class="blue"><span class="qtext">REDUCE</span></a>
to the group members. The ABAP SQL addition <a href="javascript:call_link('abaphaving_clause.html')" class="blue"><span class="qtext">HAVING</span></a> for restricting the loops of groups is a similar case. Here, for example, the
<a href="javascript:call_link('abenfilter_operator_glosry.html')" class="grey" title="Glossary Entry">filter
operator</a> <a href="javascript:call_link('abenconstructor_expression_filter.html')" class="blue"><span class="qtext">FILTER</span></a> can be used. <br><br>
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<p>
Declaration of a structured group key with additional components for group index and group size. A group key binding must be defined with <span class="qtext">INTO data(key)</span>.
</p>
<p class="qtextml1">
<span class="qtext">
SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM spfli <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(spfli_tab). <br>
 <br>LOOP AT spfli_tab INTO DATA(wa) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY ( key1 = wa-carrid key2 = wa-airpfrom <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; indx = GROUP INDEX <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size = GROUP SIZE ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO data(key). <br>
&nbsp;&nbsp;cl_demo_output=>write( |{ key-indx } { key-key1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} { key-key2 } { key-size }| ). <br>ENDLOOP. <br>cl_demo_output=>display( ). <br><br>
</span>
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaploop_at_itab_group_by_key.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:51 GMT -->
</html>
