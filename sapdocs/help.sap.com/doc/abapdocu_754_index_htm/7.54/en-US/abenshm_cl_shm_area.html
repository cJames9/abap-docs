<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENSHM_CL_SHM_AREA -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abenshm_cl_shm_area.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:40 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="Shared Objects - CL_SHM_AREA">
<title>
Shared Objects - CL_SHM_AREA - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abenshm_cl_shm_area.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abenshm_cl_shm_area.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencreate_objects.html')" class="blue">Creating Objects and Values</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_shared_objects.html')" class="blue">Shared Objects</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenshm_classes.html')" class="blue">Shared Objects - Classes and Interfaces</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenshm_cl_abap_memory_area.html')" class="blue">Shared Objects - CL_ABAP_MEMORY_AREA</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@CL_SHM_AREA@@!ABAP_CLASS!@@"></A>
<p><span class="h1">
Shared Objects - CL_SHM_AREA
</span></p>
<p>
The class <span class="lnkgrey">CL_SHM_AREA</span> is a subclass of
<a href="javascript:call_link('abenshm_cl_abap_memory_area.html')" class="blue">CL_ABAP_MEMORY_AREA</a> and the superclass of
all area classes that are generated when an area is created using transaction <span class="lnkgrey">SHMA</span>. This class contains general attributes and methods for the corresponding
<a href="javascript:call_link('abenarea_handle_glosry.html')" class="grey" title="Glossary Entry">area handles</a>.
</p>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_1" class="blue">Instance Attributes</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_2" class="blue">PROPERTIES</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_3" class="blue">INST_NAME</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_4" class="blue">CLIENT</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_5" class="blue">Static Methods</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_6" class="blue">MULTI_ATTACH</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_7" class="blue">DETACH_ALL_AREAS</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_8" class="blue">Instance Methods</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_9" class="blue">DETACH</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_10" class="blue">DETACH_COMMIT</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_11" class="blue">DETACH_ROLLBACK</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_12" class="blue">GET_LOCK_KIND</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_13" class="blue">GET_ROOT</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_14" class="blue">Instance Events</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_15" class="blue">SHM_COMMIT_EVENT</A></li>
</ul>
<ul class="circlem2">
<li><A HREF="#@@ITOC@@ABENSHM_CL_SHM_AREA_16" class="blue">SHM_ROLLBACK_EVENT</A></li>
</ul>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_1"></A>
<p><span class="h2">
Instance Attributes
</span></p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_2"></A>
<p><span class="h3">
PROPERTIES
</span></p>
<p>
Structure of type SHM_PROPERTIES with the property READ-ONLY. The components in the structure contain area properties that are generally set using transaction SHMA. The components in the structure are as follows:
</p>
<ul class="disc">
<li>AUTO_BUILD</li>
</ul>
<dl><dd>
If the value is ABAP_TRUE, the area instance versions of an area can be built automatically. The prerequisite
for the value ABAP_TRUE is that the component AUTO_BUILD_CLASS is not initial. If the value is ABAP_FALSE, the area instance versions of an area cannot be built automatically.
</dd></dl>
<ul class="disc">
<li>AUTO_BUILD_CLASS</li>
</ul>
<dl><dd>
Contains the name of the <a href="javascript:call_link('abenshm_area_constructor_class.html')" class="blue">area constructor class</a> that implements the constructor BUILD using the interface
<a href="javascript:call_link('abenshm_if_shm_build_instance.html')" class="blue">IF_SHM_BUILD_INSTANCE</a> to build area instance
versions automatically. This component is only filled if the area handle is bound by an change lock to an area instance version and is otherwise initial.
</dd></dl>
<ul class="disc">
<li>BUILD_KIND</li>
</ul>
<dl><dd>
Specifies when area instance versions of the area are built automatically using the area constructor in the
<a href="javascript:call_link('abenshm_area_constructor_class.html')" class="blue">area constructor class</a>. If the value is
CL_SHM_AREA=>BUILD_KIND_NONE, area instance versions are not built automatically. This is always the
case if the component AUTO_BUILD has the value ABAP_FALSE. If the component AUTO_BUILD has the value
ABAP_TRUE, the component BUILD_KIND can have the values CL_SHM_AREA=>BUILD_KIND_DUE_TO_READ_REQUEST
or CL_SHM_AREA=>BUILD_KIND_DUE_TO_INVALIDATION. If the component has the value CL_SHM_AREA=>BUILD_KIND_DUE_TO_READ_REQUEST
and no active area instance versions exist, the area constructor is called automatically when a read
is performed. If the component has the value CL_SHM_AREA=>BUILD_KIND_DUE_TO_INVALIDATION, the area constructor
is called in the same way as when using the value CL_SHM_AREA=>BUILD_KIND_DUE_TO_READ_REQUEST. As before,
the constructor is called in transitions from an active version to an obsolete or expired version, without an active area instance version being created.
</dd></dl>
<ul class="disc">
<li>CLIENT_DEPENDENT</li>
</ul>
<dl><dd>
If the value is ABAP_TRUE, the area is client-specific. Area instance versions of the same area are
distinguished using both the current client ID in the attribute CLIENT and using their names. If the component has the value ABAP_FALSE (default setting), the area is not client-specific and CLIENT is initial.
</dd></dl>
<ul class="disc">
<li>DISPLACE_KIND</li>
</ul>
<dl><dd>
Controls whether area instance versions of the area may be displaced. If the value is CL_SHM_AREA=>DISPLACE_KIND_NONE,
they are not displaceable (default setting). If the value is CL_SHM_AREA=>DISPLACE_KIND_SERIALIZABLE,
they are displaceable. Before displacements, the content is serialized and is saved persistently. It
is reloaded into the shared memory using a read or update on the area instance version. The prerequisite
for this is that each class instantiated in the area instance has to implement the interface <span class="lnkgrey">IF_SERIALIZABLE_OBJECT</span>.
If the component has the value CL_SHM_AREA=>DISPLACE_KIND_DISPLACABLE, the area instance versions are
displaceable. Here, the content is lost in displacements (known as full displacement). Displacements
take place only if no area handle is bound to an area instance version of the displaceable area instance at the same time.
</dd></dl>
<ul class="disc">
<li>HAS_VERSIONS</li>
</ul>
<dl><dd>
If the value is ABAP_TRUE, the area supports versioning. If the value is ABAP_FALSE, there is a maximum of one single area instance version.
</dd></dl>
<ul class="disc">
<li>IDLE_TIME</li>
</ul>
<dl><dd>
Defines how many minutes an area instance version is preserved in the shared memory (after a change
lock or shared lock has been released) before it is deleted automatically. If the value is 0 (default
setting), the area instance version is not deleted automatically. Values other than 0 are only possible
if the components INVALIDATE_TIME and REFRESH_TIME both have the value 0. In the case of transactional
areas, time measurement starts with the first database commit after a lock is released using the method DETACH_COMMIT.
</dd></dl>
<ul class="disc">
<li>INVALIDATE_TIME</li>
</ul>
<dl><dd>
Defines the minutes until an area instance version becomes obsolete after a change lock is released.
If the value is 0 (default setting), an area instance version never becomes obsolete. Values other than
0 are only possible if the components IDLE_TIME and REFRESH_TIME both have the value 0. In the case
of transactional areas, time measurement starts with the first database commit after a lock is released using the method DETACH_COMMIT.
</dd></dl>
<ul class="disc">
<li>LIFE_CONTEXT</li>
</ul>
<dl><dd>
Sets the visibility and lifetime of the area instance versions of the area. If this method has the value
CL_SHM_AREA=>LIFE_CONTEXT_APPSERVER, the area instance versions exist until the AS Instance is shut down (default value). If it has the value CL_SHM_AREA=>LIFE_CONTEXT_SESSION, the area instances exist until the last
<a href="javascript:call_link('abenmain_session_glosry.html')" class="grey" title="Glossary Entry">ABAP session</a> of the current
user ends. If it has the value CL_SHM_AREA=>LIFE_CONTEXT_MODE, the area instances exist for as long
as the current ABAP session is active. If it has the value CL_SHM_AREA=>LIFE_CONTEXT_MEMORY, the area instances exist for as long as the data exists in the ABAP memory of the current call sequence.
</dd></dl>
<ul class="disc">
<li>MAX_AREA_SIZE</li>
</ul>
<dl><dd>
Specifies the maximum permitted size of an area in KB. The size of an area matches the total memory requirement of all area instance versions of the area. The default value is currently 0 and does not restrict the size.
</dd></dl>
<ul class="disc">
<li>MAX_VERSION_SIZE</li>
</ul>
<dl><dd>
Specifies the maximum permitted size of an area in KB. The size of an area matches the total memory requirement of all area instance versions of the area. The default value is currently 0 and does not restrict the size.
</dd></dl>
<ul class="disc">
<li>MAX_VERSIONS</li>
</ul>
<dl><dd>
Specifies the maximum number of area instance versions for an area instance of an area. Obsolete areas
are not counted. The default value is 0 and does not restrict the size. If the component HAS_VERSIONS
has the value ABAP_FALSE, MAX_VERSIONS is always 1. Otherwise, MAX_VERSIONS can be any non-negative whole number that is not 1.
</dd></dl>
<ul class="disc">
<li>REFRESH_TIME</li>
</ul>
<dl><dd>
Defines the minutes until an area instance version is built by an automatic call of the area constructor.
If the value is 0 (default setting), an area instance version is never built automatically. Values other
than 0 are only possible if the components IDLE_TIME and INVALIDATE_TIME both have the value 0. In the
case of transactional areas, time measurement starts with the first database commit after a lock is
released using the method DETACH_COMMIT. The prerequisite is that an active version of the area instance
version exists at the start of the build. If the method DETACH_COMMIT was not successful, the preceding
area instance version is preserved (if areas are versioned) and the automatic rebuild raises appropriate
exceptions. The area constructor can catch the exceptions CATCH CX_SHM_ERROR and CX_SHM_FAILURE itself
and, for example, call the method INVALIDATE_INSTANCE of the area class to delete a preceding area instance
version explicitly. If an automatic area build fails due to the failure of the method DETACH_COMMIT, no automatic rebuilds take place until the method is executed successfully.
</dd></dl>
<ul class="disc">
<li>TRANSACTIONAL</li>
</ul>
<dl><dd>
If the value is ABAP_TRUE, the area is transactional (default setting). Any changes to the area instance
versions of the area do not become active until the next database commit after the method DETACH_COMMIT
is executed. If the value is ABAP_FALSE, the area is not transactional and changes become active immediately after the method DETACH_COMMIT is executed.
</dd></dl>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_3"></A>
<p><span class="h3">
INST_NAME
</span></p>
<p>
Text field of type SHM_INST_NAME with the property READ-ONLY. This attribute contains the name of the current area instance. This attribute is set when an area instance is created using the method ATTACH_FOR_WRITE of the
<a href="javascript:call_link('abenshm_area_class.html')" class="blue">area class</a>.
</p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_4"></A>
<p><span class="h3">
CLIENT
</span></p>
<p>
Text field of type MANDT with the property READ-ONLY. In client-specific areas (the component CLIENT_DEPENDENT
of the structure PROPERTIES has the value ABAP_TRUE), this attribute contains the current client ID of the area instance. This attribute is initial in a cross-client area.
</p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_5"></A>
<p><span class="h2">
Static Methods
</span></p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_6"></A>
<p><span class="h3">
MULTI_ATTACH
</span></p>
<p>
Enables shared locks, exclusive locks, or update locks to be set at the same time on multiple area instances
of one or more areas. The method MULTI_ATTACH is the only way to have change access to multiple area instances at the same time or, in other words, set multiple change locks at once.
</p>
<p><span class="h4">
Input/Output Parameters
</span></p>
<ul class="disc">
<li>ATTACH_TAB of type SHM_ATTACH_TAB</li>
</ul>
<dl><dd>
Internal table whose rows contain information about the individually requested locks. The components of the rows are as follows:
</dd></dl>
<ul class="circlem2">
<li>AREA_NAME of type SHM_AREA_NAME <br> <br>Area name</li>
</ul>
<ul class="circlem2">
<li>INST_NAME of type SHM_INST_NAME <br> <br>Name of the area instance. If the area instance is accessed using the default name, the value CL_SHM_AREA=>DEFAULT_INSTANCE must be passed.</li>
</ul>
<ul class="circlem2">
<li>CLIENT of type MANDT <br> <br>Client ID for client-specific areas. If the area instance is accessed
using the current client ID, the current client must also be passed. The component must be initial in the case of cross-client areas.</li>
</ul>
<ul class="circlem2">
<li>LOCK_KIND of type SHM_LOCK_KIND <br> <br>Access type (possible values are CL_SHM_AREA=>LOCK_KIND_READ, CL_SHM_AREA=>LOCK_KIND_WRITE, or CL_SHM_AREA=>LOCK_KIND_UPDATE).</li>
</ul>
<ul class="circlem2">
<li>ATTACH_MODE of type SHM_ATTACH_MODE <br> <br>Behavior in case of changes (possible values are CL_SHM_AREA=>ATTACH_MODE_DEFAULT, CL_SHM_AREA=>ATTACH_MODE_DETACH_READER, or CL_SHM_AREA=>ATTACH_MODE_WAIT).</li>
</ul>
<ul class="circlem2">
<li>LEVEL of type <span class="qtext">i</span> <br> <br>Order in which the locks are set. Table rows
with smaller values in the column are evaluated before table rows with larger values. If the values are equal, the order of the rows in the table is used as the deciding factor.</li>
</ul>
<ul class="circlem2">
<li>HANDLE of type <span class="qtext">REF TO cl_shm_area</span> <br> <br>This column returns a reference
to an area handle for the area instance version for which the lock was requested (provided that this
was successful). If an exception is raised, the value of the column is initial for either all rows or for the affected rows (depending on the value of the input parameter IGNORE_ERRORS).</li>
</ul>
<ul class="circlem2">
<li>EXCEPTION of type <span class="qtext">REF TO cx_root</span> <br> <br>If an exception is raised,
this column returns a reference to the exception object for either one row or all relevant rows (depending
on the value of IGNORE_ERRORS). In addition to the exceptions of ATTACH methods for settings individual
locks in the area class, the exception CX_SHM_MULTI_ATTACH_ERROR can also be raised in the following
cases: a write lock and an update lock are requested at the same time on an area instance version (the
exception text here is DUPLICATE_CHANGE_LOCK), a lock for a client other than the current client is
requested on an area instance version with automatic area building (the exception text here is ILLEGAL_AUTO_BUILD_CLIENT),
a client ID is specified for a cross-client area (the exception text here is ILLEGAL_CLIENT_FOR_AREA). In success cases, the column is initial.</li>
</ul>
<dl><dd>
For more information about the individual components, see also the description of the parameters from the ATTACH methods for setting individual locks in the <a href="javascript:call_link('abenshm_area_class.html')" class="blue">area class</a>.
</dd></dl>
<p><span class="h4">
Input Parameters
</span></p>
<ul class="disc">
<li>IGNORE_ERRORS of type ABAP_BOOL</li>
</ul>
<dl><dd>
Controls error handling of methods. Possible values are ABAP_TRUE and ABAP_FALSE.
</dd></dl>
<ul class="circlem2">
<li>If ABAP_TRUE is passed, the system attempts to set the remaining locks following an exception when
the lock was set. In the rows of the ATTACH_TAB parameter where an error occurred, the reference to
the area handle in the HANDLE column is initialized and the reference in the EXCEPTION column is set to the corresponding exception object.</li>
</ul>
<ul class="circlem2">
<li>If ABAP_FALSE is passed, the method is terminated following an exception while trying to set a lock.
The column HANDLE is initialized in all rows of the parameter ATTACH_TAB. The reference to the corresponding exception object in the column EXCEPTION is set in the row where the error occurred.</li>
</ul>
<dl><dd>
All area instances for which an error occurred in the method MULTI_ATTACH have the same state after
the method ends as they did before the method was called. This means the previous locks and the statuses remain the same.
</dd></dl>
<ul class="disc">
<li>WAIT_TIME of the type <span class="qtext">i</span></li>
</ul>
<dl><dd>
Specifies the wait time in milliseconds for all rows of the parameter ATTACH_TAB where the value CL_SHM_AREA=>ATTACH_MODE_WAIT
is specified in the column ATTACH_MODE. The wait time must be greater than or equal to 0 and is distributed
to the relevant lock requests. If multiple change locks are set and the first lock can be set during
the wait time, the remaining wait time can be used by the other locks. The time available for the remaining rows is therefore reduced by the wait time used each time a row of this type is evaluated.
</dd></dl>
<p>
<span class="bold">Caution</span>
</p>
<p>
In the case of change locks with a wait time that are set using MULTI_ATTACH, the same mutual exclusions
apply as to the methods ATTACH_FOR_WRITE and ATTACH_FOR_UPDATE of the area class. This may prevent locks
from being set in certain cases. For example, if a MULTI_ATTACH with a wait time is executed in parallel
in two programs, where program 1 first sets a change lock A and then a change lock B, program 2 does
this in reverse order, and then lock A is set in program 1 and lock B is set in program 2, at least
one of the second locks cannot be set. If there is a lock request for the second lock (lock B in program 1 and lock A in program 2), each program has to wait for the other program&#x2019;s wait time to expire.
</p>
<p><span class="h4">
Output Parameters
</span></p>
<ul class="disc">
<li>ERROR_FLAG of type ABAP_BOOL</li>
</ul>
<dl><dd>
Specifies whether one or more exceptions were raised during the method. If ERROR_FLAG has the value
ABAP_FALSE, this means all locks were set successfully. If ERROR_FLAG has the value ABAP_TRUE, not all
locks could be set. The locks contain references to the exception object or objects for either one or
more rows (depending on the value of the input parameter IGNORE_ERRORS) of the column EXCEPTION of the parameter ATTACH_TAB.
</dd></dl>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_7"></A>
<p><span class="h3">
DETACH_ALL_AREAS
</span></p>
<p>
Releases all locks of the current <a href="javascript:call_link('abeninternal_session_glosry.html')" class="grey" title="Glossary Entry">
internal session</a> on any area instance versions of any areas. This deactivates all of the area handles
of the internal session. If an exclusive lock or update lock is released, this rejects any changes that were made to area instance versions up to then.
</p>
<p><span class="h4">
Return Value
</span></p>
<ul class="disc">
<li>RC of type SHM_RC</li>
</ul>
<dl><dd>
Possible values:
</dd></dl>
<ul class="circlem2">
<li>CL_SHM_AREA=>RC_DONE if all locks were released.</li>
</ul>
<ul class="circlem2">
<li>CL_SHM_AREA=>RC_NOTHING_TO_BE_DONE if no locks were released because no locks existed in the first place.</li>
</ul>
<p>
<span class="bold">Note</span>
</p>
<p>
The method DETACH_ALL_AREAS does not require any input parameters for the client ID, since it accesses
both client-specific and cross-client area instances independently of the client. To delete all locks
in a special client, the corresponding area handles must be accessed individually. These can be managed in an internal table.
</p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_8"></A>
<p><span class="h2">
Instance Methods
</span></p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_9"></A>
<p><span class="h3">
DETACH
</span></p>
<p>
Releases the lock on the current area handle. The area handle is then inactive.
</p>
<p><span class="h4">
Exceptions
</span></p>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_WRONG_HANDLE</span></li>
</ul>
<dl><dd>
An change lock was active and not a shared lock (the exception text here is READ_HANDLE_REQUIRED)
</dd></dl>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_ALREADY_DETACHED</span></li>
</ul>
<dl><dd>
No shared lock was active.
</dd></dl>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_10"></A>
<p><span class="h3">
DETACH_COMMIT
</span></p>
<p>
Releases a change lock (an exclusive lock or update lock) on the current area handle and confirms the
changes that were made. The area handle is then inactive. The prerequisite for this is that the current area instance version must contain an instance of the area root class (known as a
<a href="javascript:call_link('abenroot_object_glosry.html')" class="grey" title="Glossary Entry">root object</a>). In addition, there must be no references from the area instance version to a different area instance of the shared objects memory or to the
<a href="javascript:call_link('abeninternal_session_glosry.html')" class="grey" title="Glossary Entry">internal session</a>.
</p>
<p>
If an exception is raised when the method is executed, the change lock is not released correctly. Although
it is persisted, the lock cannot be released a second time using the method DETACH_COMMIT. The DETACH_ROLLBACK can be used instead.
</p>
<p>
In the case of non-transactional areas (the component TRANSACTIONAL of the structure PROPERTIES has
the value ABAP_FALSE), any changes to the current area instance version become active immediately after
the method DETACH_COMMIT is executed. In the case of transactional areas (the component TRANSACTIONAL
of the structure PROPERTIES has the value ABAP_TRUE), the changes that are completed when the method
DETACH_COMMIT is executed are not active until the next database commit. The following rules apply during the time between the completion of the method DETACH_COMMIT and the next database commit:
</p>
<ul class="disc">
<li>In the case of transactional areas with versioning, all requested shared locks access the previous version.</li>
</ul>
<ul class="disc">
<li>No reads are possible for transactional areas without versioning.</li>
</ul>
<ul class="disc">
<li>It is not possible to set a new change lock for areas with versioning or for areas without versioning.</li>
</ul>
<p>
When the method DETACH_COMMIT is called, the event SHM_COMMIT_EVENT of the generated area class is raised automatically.
</p>
<p><span class="h4">
Exceptions
</span></p>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_WRONG_HANDLE</span></li>
</ul>
<dl><dd>
A shared lock was active instead of a change lock (the exception text here is WRITE_HANDLE_REQUIRED)
</dd></dl>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_ALREADY_DETACHED</span></li>
</ul>
<dl><dd>
No change lock was active.
</dd></dl>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_COMPLETION_ERROR</span></li>
</ul>
<dl><dd>
Subclasses:
</dd></dl>
<ul class="circlem2">
<li><span class="lnkgrey">CX_SHM_ROOT_OBJECT_INITIAL</span> <br>No root object was assigned to the area instance version.</li>
</ul>
<ul class="circlem2">
<li><span class="lnkgrey">CX_SHM_EXTERNAL_REFERENCE</span> <br>There are still references from the current area instance version to a different area instance of the shared objects memory or to the internal session.</li>
</ul>
<ul class="circlem2">
<li><span class="lnkgrey">CX_SHM_EVENT_EXECUTION_FAILED</span> <br>An exception was raised when an event handler was executed for SHM_COMMIT_EVENT. The exception raised can be read using the attribute PREVIOUS.</li>
</ul>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_SECONDARY_COMMIT</span></li>
</ul>
<dl><dd>
An attempt was made to release a change lock again (a release had already failed previously) using DETACH_COMMIT instead of DETACH_ROLLBACK.
</dd></dl>
<p>
CX_SHM_COMPLETION_ERROR and CX_SHM_SECONDARY_COMMIT are subclasses of CX_SHM_DETACH_ERROR.
</p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_11"></A>
<p><span class="h3">
DETACH_ROLLBACK
</span></p>
<p>
Releases a change lock (an exclusive lock or update lock) on the current area handle and discards the changes that were made. The area handle is then inactive.
</p>
<p>
For areas without versioning, no active version of the area exists once the method has been executed.
The previous version is still available for areas with versioning. In the case of transactional areas,
a new change lock can be set on the relevant area instance (even before the next database commit) once the method DETACH_ROLLBACK has been executed.
</p>
<p>
When the method DETACH_ROLLBACK is called, the event SHM_ROLLBACK_EVENT is raised automatically before it is executed.
</p>
<p><span class="h4">
Exceptions
</span></p>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_WRONG_HANDLE</span></li>
</ul>
<dl><dd>
A shared lock was active instead of a change lock (the exception text here is WRITE_HANDLE_REQUIRED).
</dd></dl>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_ALREADY_DETACHED</span></li>
</ul>
<dl><dd>
No change lock was active.
</dd></dl>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_EVENT_EXECUTION_FAILED</span></li>
</ul>
<dl><dd>
An exception was raised when an event handler was executed for SHM_ROLLBACK_EVENT. The exception raised can be read using the attribute PREVIOUS.
</dd></dl>
<p>
CX_SHM_EVENT_EXECUTION_FAILED is a subclass of CX_SHM_COMPLETION_ERROR, which is a subclass of CX_SHM_DETACH_ERROR.
</p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_12"></A>
<p><span class="h3">
GET_LOCK_KIND
</span></p>
<p>
Returns the type of the current lock for an area handle.
</p>
<p><span class="h4">
Return Value
</span></p>
<ul class="disc">
<li>LOCK_KIND of type SHM_LOCK_KIND</li>
</ul>
<dl><dd>
Possible values:
</dd></dl>
<ul class="circlem2">
<li>CL_SHM_AREA=>LOCK_KIND_READ if the area handle holds a shared lock.</li>
</ul>
<ul class="circlem2">
<li>CL_SHM_AREA=>LOCK_KIND_WRITE if the area handle holds an exclusive lock.</li>
</ul>
<ul class="circlem2">
<li>CL_SHM_AREA=>LOCK_KIND_UPDATE if the area handle holds an update lock.</li>
</ul>
<ul class="circlem2">
<li>CL_SHM_AREA=>LOCK_KIND_COMPLETION_ERROR if the area handle holds a change lock after the method DETACH_COMMIT ended with an exception.</li>
</ul>
<ul class="circlem2">
<li>CL_SHM_AREA=>LOCK_KIND_DETACHED, if the area handle does not hold any locks or if it is not bound to an area instance version.</li>
</ul>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_13"></A>
<p><span class="h3">
GET_ROOT
</span></p>
<p>
Returns a reference to the <a href="javascript:call_link('abenroot_object_glosry.html')" class="grey" title="Glossary Entry">root
object</a> (instance of the area root class) for an area handle. This method is intended for the unlikely
case where multiple handles need to be handled for different areas with different area root classes. Otherwise the attribute ROOT of the
<a href="javascript:call_link('abenshm_area_class.html')" class="blue">area class</a> can be accessed directly.
</p>
<p><span class="h4">
Return value
</span></p>
<ul class="disc">
<li>ROOT of type <span class="qtext">REF TO object</span></li>
</ul>
<p><span class="h4">
Exceptions
</span></p>
<ul class="disc">
<li><span class="lnkgrey">CX_SHM_ALREADY_DETACHED</span></li>
</ul>
<dl><dd>
The area handle is not bound to an area instance version.
</dd></dl>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_14"></A>
<p><span class="h2">
Instance Events
</span></p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_15"></A>
<p><span class="h3">
SHM_COMMIT_EVENT
</span></p>
<p>
This event is raised by the area handle automatically when the method DETACH_COMMIT is called.
</p>
<A name="@@ITOC@@ABENSHM_CL_SHM_AREA_16"></A>
<p><span class="h3">
SHM_ROLLBACK_EVENT
</span></p>
<p>
This event is raised by the area handle automatically when the method DETACH_ROLLBACK is called.
</p>
<p>

</p>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abenshm_area_class.html')" class="blue">Shared Objects - Area Classes</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abenshm_cl_shm_area.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:40 GMT -->
</html>
