<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPSELECT_SINGLE -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapselect_single.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:50 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="SELECT - SINGLE">
<title>
SELECT - SINGLE - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapselect_single.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapselect_single.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_language_external_data.html')" class="blue">Processing External Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_sql.html')" class="blue">ABAP Database Access</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenopensql.html')" class="blue">ABAP SQL</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenopen_sql_reading.html')" class="blue">ABAP SQL - Reads</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenselect_clauses.html')" class="blue">SELECT clauses</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@SINGLE@@SELECT@@"></A>
<p><span class="h1">
SELECT - SINGLE <br><br>
</span></p>
<P>
<a href="javascript:call_link('abapselect_shortref.html')" class="blue">Quick Reference</a> <br><br>
</P>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">... SINGLE <i class=bn>[</i>FOR UPDATE<i class=bn>]</i> ...</span> <br><br>
</P>
<p><span class="h3">
Addition:
</span></p>
<P>
   <A HREF="#!ABAP_ONE_ADD@1@" class="blue"> <span class="qtext">... FOR UPDATE</span> </A> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
The ABAP-specific addition <span class="qtext">SINGLE</span> makes the results set of a
<a href="javascript:call_link('abenquery_glosry.html')" class="grey" title="Glossary Entry">query</a>
a single row set. The addition is possible with a standalone <a href="javascript:call_link('abapselect.html')" class="blue"><span class="qtext">SELECT</span></a> statement or with the
<a href="javascript:call_link('abenmainquery_glosry.html')" class="grey" title="Glossary Entry">main query</a> of a standalone
<a href="javascript:call_link('abapwith.html')" class="blue"><span class="qtext">WITH</span></a> statement. If <span class="qtext">SINGLE</span>
is specified, these statements does not open a loop closed using <a href="javascript:call_link('abapendselect.html')" class="blue"><span class="qtext">
ENDSELECT</span></a> or <a href="javascript:call_link('abapendwith.html')" class="blue"><span class="qtext">ENDWITH</span></a> during imports to a non-table-like
<a href="javascript:call_link('abapinto_clause.html')" class="blue">target area</a>, and no internal tables can be specified as a <a href="javascript:call_link('abapinto_clause.html')" class="blue">target area</a>.
</P>
<ul class="disc">
<li>
If the selection of the <span class="qtext">SELECT</span> statement covers precisely one row, this row is included in the results set.
<br><br></li>
<li>
If the selection of the <span class="qtext">SELECT</span> statement covers more than one row, one of these rows is included in the results set at random.
<br></li>
</ul>
<P>
The following restrictions apply:
</P>
<ul class="disc">
<li>
The additions <a href="javascript:call_link('abenwhere_logexp_itab.html')" class="blue"><span class="qtext">FOR ALL ENTRIES</span></a>,
<a href="javascript:call_link('abaporderby_clause.html')" class="blue"><span class="qtext">ORDER BY</span></a>, and <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue">
<span class="qtext">UP TO</span>, <span class="qtext">OFFSET</span></a> cannot be used together with <span class="qtext">SINGLE</span>.
<br><br></li>
<li>
The addition <span class="qtext">SINGLE</span> cannot be used in the
<a href="javascript:call_link('abenmainquery_glosry.html')" class="grey" title="Glossary Entry">main query</a> of statement <a href="javascript:call_link('abapopen_cursor.html')" class="blue"><span class="qtext">OPEN CURSOR</span></a> or in
<a href="javascript:call_link('abensubquery_glosry.html')" class="grey" title="Glossary Entry">subqueries</a>.
<br></li>
</ul>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
The addition <span class="qtext">SINGLE</span> is designed to pass precisely one row to a
<a href="javascript:call_link('abenflat_structure_glosry.html')" class="grey" title="Glossary Entry">flat structure</a> as a
work area without opening a loop closed using <a href="javascript:call_link('abapendselect.html')" class="blue"><span class="qtext">
ENDSELECT</span></a> or <a href="javascript:call_link('abapendwith.html')" class="blue"><span class="qtext">ENDWITH</span></a>.
<br></li>
</ul>
<ul class="circlem2">
<li>Usually, the row must be identified precisely and it must be specified uniquely in the <a href="javascript:call_link('abapwhere.html')" class="blue"><span class="qtext">WHERE</span> condition</a>. In a
<a href="javascript:call_link('abapselect_data_source.html')" class="blue">data source</a>, this is usually done by specifying comparison values for the
<a href="javascript:call_link('abenprimary_key_glosry.html')" class="grey" title="Glossary Entry">primary key</a>. The
<a href="javascript:call_link('abenextended_program_check_glosry.html')" class="grey" title="Glossary Entry">extended program check</a> produces a warning if no precise row is identified.</li>
</ul>
<ul class="circlem2">
<li>If no unique row is identified, the addition <span class="qtext">SINGLE</span> can also be used to detect whether a corresponding row exists. In this case, the warning from the extended program check must be hidden using a
<a href="javascript:call_link('abenpragma_glosry.html')" class="grey" title="Glossary Entry">pragma</a>. To avoid unnecessary transports of data, a <span class="qtext">SELECT</span> list can also be used that contains nothing but a single constant (see the
<a href="javascript:call_link('abensql_expr_literal_abexa.html')" class="blue">executable example</a>).</li>
</ul>
<dl>

<dd>
In the case of rows specified in full, a <span class="qtext">SELECT</span> statement with the addition <span class="qtext">SINGLE</span> is generally faster than specifying only part of the row.
</dd>
</dl>
<ul class="disc">
<li>
The results set of <span class="qtext">SELECT</span> statements with the addition <span class="qtext">SINGLE</span>
matches the set from the addition <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue"><span class="qtext">UP
TO 1 ROWS</span></a> without using the addition <a href="javascript:call_link('abaporderby_clause.html')" class="blue"><span class="qtext">ORDER BY</span></a>.
<br></li>
</ul>
<ul class="circlem2">
<li>If the addition <span class="qtext">SINGLE</span> is used, it is not necessary to use the statements
<a href="javascript:call_link('abapendselect.html')" class="blue"><span class="qtext">ENDSELECT</span></a>, <a href="javascript:call_link('abapendwith.html')" class="blue">
<span class="qtext">ENDWITH</span></a> or to import the row into an internal table. Not all additions of the <span class="qtext">SELECT</span> statement, however, can be used.</li>
</ul>
<ul class="circlem2">
<li>If the addition <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue"><span class="qtext">UP TO 1 ROWS</span></a>
is used, the statement <a href="javascript:call_link('abapendselect.html')" class="blue"><span class="qtext">ENDSELECT</span></a>
or <a href="javascript:call_link('abapendwith.html')" class="blue"><span class="qtext">ENDWITH</span></a> must be specified or
the row must be imported into an internal table. The addition <a href="javascript:call_link('abaporderby_clause.html')" class="blue"><span class="qtext">ORDER BY</span></a> can, however, be specified.</li>
</ul>
<dl>

<dd>
A <span class="qtext">SELECT</span> statement with the addition <span class="qtext">SINGLE</span> can
be optimized for reading a single row, which means is generally somewhat faster than when using the
addition <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue"><span class="qtext">UP TO 1 ROWS</span></a>. In practice, however, this difference can usually be ignored. In light of this, the following is recommended:
</dd>
</dl>
<ul class="circlem2">
<li>Use of the addition <span class="qtext">SINGLE</span> to read a row specified in full precisely.</li>
</ul>
<ul class="circlem2">
<li>Use of the addition <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue"><span class="qtext">UP TO 1 ROWS</span></a> to read a maximum of one row from a set of selected rows.</li>
</ul>
<ul class="disc">
<li>
The addition <a href="javascript:call_link('abaporderby_clause.html')" class="blue"><span class="qtext">ORDER BY</span></a> cannot
be used together with <span class="qtext">SINGLE</span>, which means that it is not possible to define
which row is read from a non-unique selection. Instead, the addition <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue">
<span class="qtext">UP TO 1 ROWS</span></a> can be specified with the addition <a href="javascript:call_link('abaporderby_clause.html')" class="blue">
<span class="qtext">ORDER BY</span></a> to define which row is read from a non-unique selection.
<br><br></li>
<li>
If <span class="qtext">SINGLE</span> is specified and
<a href="javascript:call_link('abenselect_into_lob_handles.html')" class="blue">LOB handles</a> are created in the <a href="javascript:call_link('abapinto_clause.html')" class="blue">
<span class="qtext">INTO</span> clause</a>, all primary key fields joined by <span class="qtext">AND</span>
in logical expressions must be checked for equivalence in the <a href="javascript:call_link('abapwhere.html')" class="blue"><span class="qtext">
WHERE</span> condition</a>. If this is not possible, the addition <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue"><span class="qtext">UP TO 1 ROWS</span></a> can be used instead of <span class="qtext">SINGLE</span>.
<br><br></li>
<li>
If the addition <span class="qtext">SINGLE</span> is used, after the
<a href="javascript:call_link('abenselect_into_lob_handles.html')" class="blue">creation of LOB handles</a>, all
<a href="javascript:call_link('abenselect_into_lob_handles.html')" class="blue">reader streams</a> which are created when executing the statement <span class="qtext">SELECT</span>, as well as
<a href="javascript:call_link('abenselect_into_lob_handles.html')" class="blue">locators</a>, continue to exist until they are
closed, either explicitly with one of their methods, or implicitly at the end of the current database
LUW. The associated database operation is not completed during this time. It is best to close all LOB handles as soon as possible.
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<P>
Reads the row with the information about Lufthansa flight 0400 from the database table <span class="lnkgrey">SPFLI</span>.
</P>
<p class="qtextml1">
<span class="qtext">
SELECT SINGLE * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM spfli <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE carrid = 'LH' AND <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connid = '0400' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO @DATA(wa). <br><br>
</span>
</p>
<p><span class="h4">
Example
</span></p>
<P>
The program <span class="lnkgrey">DEMO_SELECT_SINGLE_VS_UP_TO</span> compares the performance of <span class="qtext">
SELECT</span> statements with the addition <span class="qtext">SINGLE</span> with similar statements
with the addition <a href="javascript:call_link('abapselect_up_to_offset.html')" class="blue"><span class="qtext">UP TO 1 ROWS</span></a>. <br><br>
</P>
<A NAME="@@FOR UPDATE@@SELECT SINGLE@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ONE_ADD@1@"></A> <span class="bold">Addition</span>
</span></p>
<P>
<span class="qtext">... FOR UPDATE</span> <!-- /A -->  <br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
When reading an individual row using <span class="qtext">SINGLE</span>, the addition <span class="qtext">FOR UPDATE</span> sets a
<a href="javascript:call_link('abendatabase_lock_glosry.html')" class="grey" title="Glossary Entry">database lock</a> as an
<a href="javascript:call_link('abenexclusive_lock_glosry.html')" class="grey" title="Glossary Entry">exclusive lock</a> for this
row on the database. The statement <span class="qtext">SELECT</span> is then only executed if, in the
<a href="javascript:call_link('abapwhere.html')" class="blue"><span class="qtext">WHERE</span> condition</a>, all primary key
fields in logical expression which are joined using <span class="qtext">AND</span> are checked for equivalence. Otherwise the results set is empty and <span class="qtext">sy-subrc</span> is set to 8.
</P>
<P>
The addition <span class="qtext">FOR UPDATE</span> can be used only to access data sources that allow writes and cannot be specified when accessing views that allow only reads.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
If set incorrectly, the lock can produce a <a href="javascript:call_link('abendeadlock_glosry.html')" class="grey" title="Glossary Entry">deadlock</a>.
<br><br></li>
<li>
If the addition <span class="qtext">FOR UPDATE</span> is used, a standalone <a href="javascript:call_link('abapselect.html')" class="blue"><span class="qtext">SELECT</span></a> statement bypasses
<a href="javascript:call_link('abensap_buffering_glosry.html')" class="grey" title="Glossary Entry">table buffering</a>.
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<p>
In the following example, the <a href="javascript:call_link('abenexclusive_lock_glosry.html')" class="grey" title="Glossary Entry">exclusive
lock</a> set by the statement <a href="javascript:call_link('abapdelete_dbtab.html')" class="blue"><span class="qtext">DELETE</span></a> is resolved using a
<a href="javascript:call_link('abendb_commit.html')" class="blue">database commit</a>. This means that an exclusive lock is applied
by the statement <span class="qtext">SELECT</span> rather than waiting until the statement <a href="javascript:call_link('abapupdate.html')" class="blue"><span class="qtext">UPDATE</span></a> is executed.
</p>
<p class="qtextml1">
<span class="qtext">
DELETE FROM demo_expressions. <br>INSERT demo_expressions FROM @( VALUE #( id = 'X' ) ). <br>COMMIT CONNECTION default. <br>
 <br>... <br> <br>SELECT SINGLE FOR UPDATE id, num1 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM demo_expressions <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE id = 'X' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO @DATA(wa). <br> <br>... <br> <br>UPDATE demo_expressions SET num1 = 111 WHERE id = 'X'. <br><br>
</span>
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapselect_single.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:50 GMT -->
</html>
