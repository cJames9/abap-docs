<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPWITH_HIERARCHY -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapwith_hierarchy.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:52:09 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="WITH - HIERARCHY">
<title>
WITH - HIERARCHY - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapwith_hierarchy.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapwith_hierarchy.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_language_external_data.html')" class="blue">Processing External Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_sql.html')" class="blue">ABAP Database Access</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenopensql.html')" class="blue">ABAP SQL</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenopen_sql_reading.html')" class="blue">ABAP SQL - Reads</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abapwith.html')" class="blue">WITH</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@WITH HIERARCHY@@WITH@@"></A>
<p><span class="h1">
WITH - HIERARCHY
</span></p>
<A name="@@ITOC@@ABAPWITH_HIERARCHY_1"></A>
<p><span class="h2">
Syntax
</span></p>
<p>
<span class="qtext">... WITH HIERARCHY hierarchy <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>|</i> (hierarchy_syntax)</span> <br><br>
</p>
<p><span class="h4">
Effect
</span></p>
<P>
The addition <span class="qtext">WITH HIERARCHY</span> publishes a common table expression as a
<a href="javascript:call_link('abencte_hierarchy_glosry.html')" class="grey" title="Glossary Entry">CTE hierarchy</a>. Under
its name, a common table expression like this can be used in the subsequent queries of the current <a href="javascript:call_link('abapwith.html')" class="blue">
<span class="qtext">WITH</span></a> statement as a hierarchy <a href="javascript:call_link('abenselect_hierarchy.html')" class="blue"><span class="qtext">hierarchy</span></a>.
</P>
<P>
Only a single data source can be accessed in the subquery of the common table expression and this data
source must be a hierarchy <a href="javascript:call_link('abenselect_hierarchy.html')" class="blue"><span class="qtext">hierarchy</span></a>.
The hierarchy used as the data source of the subquery can be specified either statically or dynamically after <span class="qtext">HIERARCHY</span>.
</P>
<ul class="disc">
<li>
<span class="qtext">hierarchy</span> is used to specify either the name of the hierarchy or its alias name defined using <a href="javascript:call_link('abapfrom_clause.html')" class="blue"><span class="qtext">AS</span></a>. When the
<a href="javascript:call_link('abenhierarchy_generator_glosry.html')" class="grey" title="Glossary Entry">hierarchy generator</a>
<a href="javascript:call_link('abenselect_hierarchy_generator.html')" class="blue"><span class="qtext">HIERARCHY</span></a> is used, it must have an alias name and this name must be specified.
<br><br></li>
<li>
A parenthesized data object <span class="qtext">hierarchy_syntax</span> can be specified that, when
the statement is executed, must either contain the static syntax specifying the hierarchy or be initial.
In this case, the common table expression can be used only in other dynamic tokens of the <span class="qtext">WITH</span> statement. The data object <span class="qtext">hierarchy_syntax</span> can be a character-like data object or a
<a href="javascript:call_link('abenstandard_table_glosry.html')" class="grey" title="Glossary Entry">standard table</a> with
a character-like row type. The syntax in <span class="qtext">hierarchy_syntax</span>, as in the static
syntax, is not case-sensitive. Invalid syntax raises a handleable exception from the class CX_SY_DYNAMIC_OSQL_ERROR.
If <span class="qtext">hierarchy_syntax</span> is initial, the common table expression is not published as a table expression.
<br></li>
</ul>
<P>
The results set of a common table expression published as a CTE hierarchy includes the
<a href="javascript:call_link('abenddddl_hierarchy.html')" class="blue">hierarchy columns</a> of the hierarchy specified in the
subquery. The <a href="javascript:call_link('abapselect_list.html')" class="blue"><span class="qtext">SELECT</span></a> list of the subquery cannot contain any columns with the same name or alias name as a hierarchy column.
</P>
<p><span class="h4">
Note
</span></p>
<P>
If <span class="qtext">hierarchy_syntax</span> is specified dynamically, it is possible to decide at runtime whether a common table expression is published as a CTE hierarchy.
</P>
<p><span class="h4">
Example
</span></p>
<p>
Accesses CTE hierarchies in two hierarchy navigators <a href="javascript:call_link('abenhierarchy_navigator_glosry.html')" class="grey" title="Glossary Entry">
<span class="qtext">HIERARCHY_DESCENDANTS</span></a> (in the program <span class="lnkgrey">DEMO_HIERARCHY_CTE</span>)
joined in the main query of a <a href="javascript:call_link('abapwith.html')" class="blue"><span class="qtext">WITH</span></a> statement using a left outer join. The first CTE hierarchy represents the
<a href="javascript:call_link('abencds_hierarchy_glosry.html')" class="grey" title="Glossary Entry">CDS hierarchy</a> DEMO_CDS_PARENT_CHILD accessed in its subquery. The second CTE hierarchy represents the results set of the
<a href="javascript:call_link('abenhierarchy_generator_glosry.html')" class="grey" title="Glossary Entry">hierarchy generator</a>
<a href="javascript:call_link('abenselect_hierarchy_generator.html')" class="blue"><span class="qtext">HIERARCHY</span></a> used in its subquery. The <span class="qtext">ON</span> condition of the join compares two
<a href="javascript:call_link('abenhierarchy_column_glosry.html')" class="grey" title="Glossary Entry">hierarchy columns</a> of the CTE hierarchies. When <span class="lnkgrey">executed</span>, this program demonstrates the result.
</p>
<p class="qtextml1">
<span class="qtext">
WITH +hierarchy1 AS ( <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT FROM demo_cds_parent_child( p_id = 'A' ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FIELDS id AS id1, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent AS parent1 ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH HIERARCHY demo_cds_parent_child, <br>&nbsp;&nbsp;&nbsp;&nbsp; +hierarchy2 AS ( <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT FROM HIERARCHY( SOURCE demo_cds_parent_child_source <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CHILD TO PARENT ASSOCIATION _relat <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; START WHERE id = 'U' ) AS hierarchy <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FIELDS id AS id2, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent AS parent2 ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH HIERARCHY hierarchy <br>&nbsp;&nbsp;SELECT FROM HIERARCHY_DESCENDANTS( <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SOURCE +hierarchy1 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START WHERE hierarchy_parent_rank = 0 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISTANCE FROM 1 ) AS h1 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEFT OUTER JOIN <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HIERARCHY_DESCENDANTS( <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SOURCE +hierarchy2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; START WHERE hierarchy_parent_rank = 0 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DISTANCE FROM 1 ) AS h2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ON h1~hierarchy_rank = h2~hierarchy_rank <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FIELDS h1~id1, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h2~id2, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h1~parent1, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h2~parent2 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(result).
</span>
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapwith_hierarchy.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:52:09 GMT -->
</html>
