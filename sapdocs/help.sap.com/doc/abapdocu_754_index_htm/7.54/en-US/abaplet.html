<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPLET -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaplet.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:53 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="let_exp - LET ... IN">
<meta name="keywords" content="ABAP, LET Expressions">
<title>
let_exp - LET ... IN - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abaplet.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abaplet.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abendeclarations.html')" class="blue">Declarations</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenlocal_expr_declarations.html')" class="blue">Local Declarations in Expressions</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@LET@@ABAP_EXPRESSION@@"></A>
<A NAME="@@IN@@LET@@"></A>
<p><span class="h1">
let_exp - LET ... IN <br><br>
</span></p>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
 <span class="qtext">... LET <i class=bn>{</i>var1 = rhs1<i class=bn>}</i><i class=bn>|</i><i class=bn>{</i>&lt;fs1> = wrexpr1<i class=bn>}</i> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i class=bn>{</i>var2 = rhs2<i class=bn>}</i><i class=bn>|</i><i class=bn>{</i>&lt;fs2> = wrexpr2<i class=bn>}</i> ... IN ...</span> <br><br>
</P>
<p><span class="h2">
Alternatives:
</span></p>
<P>
   <A HREF="#!ABAP_ALTERNATIVE_1@1@" class="blue"> 1. <span class="qtext">... var = rhs ...</span> </A> <br>
<br><A HREF="#!ABAP_ALTERNATIVE_2@2@" class="blue"> 2. <span class="qtext">... &lt;fs> = wrexp ...</span> </A> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
A <span class="qtext">LET</span> expression defines variables <span class="qtext">var1</span>, <span class="qtext">
var2</span>, ... or field symbols <span class="qtext">&lt;fs1></span>, <span class="qtext">&lt;fs2></span>,
... as local helper fields in an expression and assigns values to them. When declared, the helper fields
can be used in the operand positions of the expression. There is no way of accessing a helper field
statically outside its expression. The documentation of an expression specifies whether it contains
a <span class="qtext">LET</span> expression and in which positions. Any <span class="qtext">LET</span> expressions in an expression or subexpression are evaluated first.
</P>
<P>
A helper field specified in a <span class="qtext">LET</span> expression is valid in the context in which
the <span class="qtext">LET</span> expression is specified. This can be a full expression or just part
of an expression. All helper fields of a full expression are in the same namespace. A previously specified
helper field can be specified in a further <span class="qtext">LET</span> expression of the same expression.
Furthermore, the helper fields are in the same namespace as the data objects or field symbols of the
current procedure or program. Helper fields cannot be defined in a <span class="qtext">LET</span> expression
if a data object or field symbol with the same name already exists in the procedure or program of the
expression. Conversely, no data objects or field symbols with names given to helper fields can be declared after an expression with a <span class="qtext">LET</span> expression.
</P>
<P>
When reusing helper fields in different expressions, the following applies:
</P>
<ul class="disc">
<li>
If a helper field is defined for the first time in the current procedure or program, it is declared <a href="javascript:call_link('abeninline_declarations.html')" class="blue">inline</a>.
<br><br></li>
<li>
If a helper field in the current procedure or program is defined again in a <span class="qtext">LET</span>
expression in a different expression and the derived data type matches, the helper field is bound to this expression and can be used there.
<br><br></li>
<li>
If a helper field in the current procedure or program is defined again in a <span class="qtext">LET</span>
expression in a different expression and the derived data type does not match, the helper field cannot be used there and a syntax error occurs.
<br></li>
</ul>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
<span class="qtext">LET</span> expressions can currently only be used in
<a href="javascript:call_link('abenconstructor_expressions.html')" class="blue">constructor expressions</a>. Subexpressions in which <span class="qtext">LET</span> expressions can be used are
<a href="javascript:call_link('abeniteration_expression_glosry.html')" class="grey" title="Glossary Entry">iteration expressions</a>
using <a href="javascript:call_link('abenfor.html')" class="blue"><span class="qtext">FOR</span></a> and with results specified after <span class="qtext">THEN</span> and <span class="qtext">ELSE</span> in the
<a href="javascript:call_link('abenconditional_expression_glosry.html')" class="grey" title="Glossary Entry">conditional expressions</a>
<a href="javascript:call_link('abenconditional_expression_cond.html')" class="blue"><span class="qtext">COND</span></a> and <a href="javascript:call_link('abenconditional_expression_switch.html')" class="blue"><span class="qtext">SWITCH</span></a>.
<br><br></li>
<li>
In the assignment of a value operator <span class="qtext">VALUE</span> to
<a href="javascript:call_link('abenvalue_constructor_params_struc.html')" class="blue">structures</a> or
<a href="javascript:call_link('abenvalue_constructor_params_itab.html')" class="blue">internal tables</a>, values from the left
side can be saved to helper fields using a <span class="qtext">LET</span> expression before the left side is overwritten.
<br><br></li>
<li>
A helper field defined in a <span class="qtext">LET</span> expression can be addressed dynamically in
the entire current context. This is not recommended, however, since expressions are not supposed to produce side effects.
<br><br></li>
<li>
It is a good idea to use <span class="qtext">LET</span> expressions whenever helper fields are required
for performance reasons (by avoiding multiple calculations) or the readability of an expression or whenever
values from the left side of an assignment in a <span class="qtext">VALUE</span> operator are needed on the right side.
<br></li>
</ul>
<p><span class="h4">
Executable Example
</span></p>
<P>
<a href="javascript:call_link('abenlet_abexa.html')" class="blue"><span class="qtext">LET</span> expression</a>. <br><br>
</P>
<p><span class="h2">
<A NAME="!ABAP_ALTERNATIVE_1@1@"></A> <span class="bold">Alternative 1</span>
</span></p>
<P>
<span class="qtext">... var = rhs ...</span> <br><br><br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
Defines a local helper variable <span class="qtext">var</span> as a helper field in a <span class="qtext">LET</span>
expression. The value of the right side, <span class="qtext">rhs</span>, is assigned to the helper variable as an initial value.
</P>
<P>
For the right side, <span class="qtext">rhs</span>, the same can be specified as in a regular assignment
using the <a href="javascript:call_link('abenequals_operator.html')" class="blue">assignment operator <span class="qtext">=</span></a>.
The data type of the helper variable is determined from the right side, <span class="qtext">rhs</span>,
in exactly the same way as when an inline declaration <a href="javascript:call_link('abendata_inline.html')" class="blue"><span class="qtext">
DATA(var)</span></a> is specified on the left side of an assignment operator using the <a href="javascript:call_link('abenequals_operator.html')" class="blue">
assignment operator <span class="qtext">=</span></a>. It must be possible to determine the data type in full from the right side to avoid syntax errors.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
The helper variables declared in a <span class="qtext">LET</span> expression generally keep the value
defined by <span class="qtext">rhs</span> while the expression is being calculated. It is possible to
modify the value of a helper variable in the expression, for example by binding to a <span class="qtext">CHANGING</span> parameter of a method, but this would be unusual.
<br><br></li>
<li>
The helper variables declared in a <span class="qtext">LET</span> expression are a good example of where long
<a href="javascript:call_link('abentelling_names_guidl.html')" class="lnkpurple" title="Guideline">readable names</a> are not
necessary and can even harm readability. The helper variables can only be used in their own expression, which means that short names (possibly even single-character names) are enough.
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<P>
Defines three local helper variables, <span class="qtext">x</span>, <span class="qtext">y</span>, and
<span class="qtext">z</span>, in a constructor expression to construct the values of a structure. The values of the helper variables are used for the structure components.
</P>
<p class="qtextml1">
<span class="qtext">
TYPES: <br>&nbsp;&nbsp; BEGIN OF struc, <br>&nbsp;&nbsp;&nbsp;&nbsp; col1 TYPE i, <br>&nbsp;&nbsp;&nbsp;&nbsp; col2 TYPE i, <br>
&nbsp;&nbsp; END OF struc. <br> <br>DATA(rnd) = cl_abap_random_int=>create( <br>&nbsp;&nbsp;seed = CONV i( sy-uzeit ) min = 1 max = 10 ). <br>
 <br>DO 5 TIMES. <br>&nbsp;&nbsp;DATA(struc) = VALUE struc( <br>&nbsp;&nbsp;&nbsp;&nbsp;LET x = rnd->get_next( ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = x * x <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z = sy-index * 1000 IN col1 = x + z <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; col2 = y + z ). <br>
&nbsp;&nbsp;cl_demo_output=>write( struc ). <br>ENDDO. <br>cl_demo_output=>display( ). <br><br>
</span>
</p>
<p><span class="h2">
<A NAME="!ABAP_ALTERNATIVE_2@2@"></A> <span class="bold">Alternative 2</span>
</span></p>
<P>
<span class="qtext">... &lt;fs> = wrexp ...</span> <br><br><br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
Defines a local field symbol <span class="qtext">&lt;fs></span> as a helper field in a <span class="qtext">LET</span> expression. Here, the result of the
<a href="javascript:call_link('abenwritable_expression_glosry.html')" class="grey" title="Glossary Entry">writable expression</a>
<span class="qtext">wrexp</span> is assigned to the field symbol. The same applies here as in assignments
of writable expressions using <a href="javascript:call_link('abapassign_mem_area_writable_exp.html')" class="blue"><span class="qtext">ASSIGN</span></a>,
which means that only the expressions specified there can be used. The typing of the field symbol is
determined by the type of <span class="qtext">wrexp</span> and is performed in the same way as in inline
declarations of a field symbol using the statement <a href="javascript:call_link('abenfield-symbol_inline.html')" class="blue"><span class="qtext">FIELD-SYMBOL</span></a>.
</P>
<p><span class="h4">
Example
</span></p>
<P>
Defines a field symbol and a variable as helper fields in a <span class="qtext">LET</span> expression in a conversion expression. The rows of an internal table are assigned to the field symbol.
</P>
<p class="qtextml1">
<span class="qtext">
TYPES: <br>&nbsp;&nbsp; BEGIN OF date, <br>&nbsp;&nbsp;&nbsp;&nbsp; year&nbsp;&nbsp;TYPE c LENGTH 4, <br>
&nbsp;&nbsp;&nbsp;&nbsp; month TYPE c LENGTH 2, <br>&nbsp;&nbsp;&nbsp;&nbsp; day&nbsp;&nbsp; TYPE c LENGTH 2, <br>
&nbsp;&nbsp; END OF date, <br>&nbsp;&nbsp; dates TYPE TABLE OF date WITH EMPTY KEY. <br> <br>DATA(dates) = VALUE dates( <br>
&nbsp;&nbsp;( year = '2013' month = '07' day = '16' ) <br>&nbsp;&nbsp;( year = '2014' month = '08' day = '31' ) <br>
&nbsp;&nbsp;( year = '2015' month = '09' day = '07' ) ). <br> <br>DO lines( dates ) TIMES. <br>&nbsp;&nbsp;DATA(isodate) = CONV string( <br>
&nbsp;&nbsp;&nbsp;&nbsp;LET &lt;date>&nbsp;&nbsp;= dates[ sy-index ] <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sep&nbsp;&nbsp; =&nbsp;&nbsp; '-' <br>
&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&lt;date>-year &amp;&amp; sep &amp;&amp; &lt;date>-month &amp;&amp; sep &amp;&amp; &lt;date>-day&nbsp;&nbsp;). <br>
&nbsp;&nbsp;cl_demo_output=>write( isodate ). <br>ENDDO. <br>cl_demo_output=>display( ).
</span>
</p>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<img src="exa.gif" alt="Example" title="Example">
<a href="javascript:call_link('abenlet_abexa.html')" class="blue">LET Expression</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaplet.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:53 GMT -->
</html>
