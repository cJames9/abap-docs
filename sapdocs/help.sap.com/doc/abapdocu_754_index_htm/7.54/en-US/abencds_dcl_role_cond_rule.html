<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENCDS_DCL_ROLE_COND_RULE -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_dcl_role_cond_rule.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:42 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="ABAP CDS - DEFINE ROLE, conditional_rule">
<title>
ABAP CDS - DEFINE ROLE, conditional_rule - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abencds_dcl_role_cond_rule.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abencds_dcl_role_cond_rule.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_dictionary.html')" class="blue">ABAP - Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds.html')" class="blue">ABAP CDS in ABAP Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_authorizations.html')" class="blue">ABAP CDS - Access Control</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_dcl_syntax.html')" class="blue">ABAP CDS - DCL Statements</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_define_role.html')" class="blue">ABAP CDS - DEFINE ROLE</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_dcl_role_rules.html')" class="blue">ABAP CDS - DEFINE ROLE, access_rules</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@GRANT SELECT ON WHERE@@!ABAP_CDS_DEFINE_ROLE!@@"></A>
<A NAME="@@COMBINATION MODE OR@@!ABAP_CDS_GRANT_SELECT!@@"></A>
<A NAME="@@COMBINATION MODE AND@@!ABAP_CDS_GRANT_SELECT!@@"></A>
<A NAME="@@REDEFINITION@@!ABAP_CDS_GRANT_SELECT!@@"></A>
<p><span class="h1">
ABAP CDS - DEFINE ROLE, conditional_rule
</span></p>
<A name="@@ITOC@@ABENCDS_DCL_ROLE_COND_RULE_1"></A>
<p><span class="h2">
Syntax
</span></p>
<p>
<span class="qtext400">GRANT SELECT ON cds_entity <br>&nbsp;&nbsp;&nbsp;&nbsp;<i class=bn>[</i>COMBINATION MODE OR <i class=bn>|</i> COMBINATION MODE AND <i class=bn>|</i> REDEFINITION<i class=bn>]</i> <br>&nbsp;&nbsp;&nbsp;&nbsp;WHERE
<a href="javascript:call_link('abencds_dcl_role_cond_expr.html')" class="blue">cond_expr</a>;</span>
</p>
<p>

</p>
<p><span class="h4">
Effect
</span></p>
<p>
Conditional access rule in the statement <a href="javascript:call_link('abencds_f1_define_role.html')" class="blue"><span class="qtext400">DEFINE ROLE</span></a> of the
<a href="javascript:call_link('abencds_dcl_glosry.html')" class="grey" title="Glossary Entry">CDS DCL</a>. A conditional access
rule <span class="qtext400">GRANT SELECT ON</span> with the addition <span class="qtext400">WHERE</span> restricts access to a CDS entity <span class="qtext400">cds_entity</span> using
<a href="javascript:call_link('abenaccess_condition_glosry.html')" class="grey" title="Glossary Entry">access conditions</a> <a href="javascript:call_link('abencds_dcl_role_cond_expr.html')" class="blue"><span class="qtext400">cond_expr</span></a>.
</p>
<p>
A single CDS entity can be specified in multiple access rules of a CDS role and multiple CDS roles can contain access rules for a single CDS entity.
</p>
<p>
If a CDS entity is specified in multiple access rules of a CDS role or in multiple CDS roles, the resulting
access conditions are joined using the method specified by the addition <span class="qtext400">COMBINATION MODE</span>.
</p>
<p><span class="h4">
<A NAME="!ABAP_ADDITION_1@1@"></A> <span class="bold">Addition 1</span>
</span></p>
<P>
<span class="qtext400">... WHERE</span><br><!-- /A -->
</P>
<p>
A <span class="qtext400">WHERE</span> clause is used to define an
<a href="javascript:call_link('abenaccess_condition_glosry.html')" class="grey" title="Glossary Entry">access condition</a> <a href="javascript:call_link('abencds_dcl_role_cond_expr.html')" class="blue">
<span class="qtext400">cond_expr</span></a> for the CDS entity <span class="qtext400">cds_entity</span>.
When a CDS entity is accessed using ABAP SQL, and an access rule is configured for this entity in a
role, the access conditions are evaluated implicitly. This means their selection is restricted accordingly
and hence any <a href="javascript:call_link('abapselect.html')" class="blue"><span class="qtext">SELECT</span></a> reads use
a logical "and" to add the access condition to the select condition of the statement passed to the database by the database interface.
</p>
<p><span class="h4">
<span class="bold">Addition 2</span>
</span></p>
<P>
<span class="qtext400">... COMBINATION MODE AND<i class=bn>|</i>OR</span>
</P>
<p>
The optional addition <span class="qtext400">COMBINATION MODE AND<i class=bn>|</i>OR</span> can be used
to define how the access conditions of multiple access rules for the same CDS entity <span class="qtext400">cds_entity</span>
are combined. This addition can be applied regardless of whether other access rules already exist for the CDS entity.
</p>
<p>
<span class="qtext400">COMBINATION MODE OR</span> is used to join the access conditions using the logical operator "or". If created, these access rules make the restrictions less strong.
</p>
<p>
<span class="qtext400">COMBINATION MODE AND</span> combines the current access rule with the logical operator "and&#x201D; and the other access rules. This means the restrictions are made stronger.
</p>
<p>
If multiple access rules with the combination methods
"<span class="qtext400">AND</span>" (<span class="qtext400">cond_and_1</span>, <span class="qtext400">cond_and_2</span>, ...), and
"<span class="qtext400">OR</span>" (<span class="qtext400">cond_or_1</span>, <span class="qtext400">cond_or_2</span>, ...) exist, the following expression produces the full condition:
</p>
<p>
<span class="qtext400">( cond_or_1 OR cond_or_2 OR ... ) AND cond_and_1 AND cond_and_2 AND ...</span>
</p>
<p>
A full access rule overrides the construction above, however, and produces a full access rule as the end result, even if there are rules with the mode <span class="qtext400">COMBINATION MODE AND</span>.
</p>
<p>
The following applies to the addition <span class="qtext400">COMBINATION MODE OR</span>:
</p>
<ul class="disc">
<li>The addition <span class="qtext400">COMBINATION MODE OR</span> does not need to be specified explicitly.
If there are multiple access rules for a CDS entity, they are joined implicitly using the logical operator
"or". For reasons of consistency, however, the addition <span class="qtext400">COMBINATION MODE OR</span> is recommended.</li>
</ul>
<ul class="disc">
<li>Any existing access controls without the explicit addition <span class="qtext400">COMBINATION MODE OR</span> are valid.</li>
</ul>
<p><span class="h4">
<span class="bold">Addition 3</span>
</span></p>
<P>
<span class="qtext400">... REDEFINITION</span>
</P>
<p>
The optional addition <span class="qtext400">REDEFINITION</span> is used to indicate that the access
rule in question is the only existing access rule for the CDS entity and any other access rules are
ignored. The addition makes it possible for customers and partners to replace all access rules delivered
by SAP for CDS entity with their own access rules without making modifications. The language element
<span class="qtext400">INHERITING CONDITIONS FROM SUPER</span> can, however, be used to incorporate conditions delivered by SAP in customer or partner access rules.
</p>
<p>
The following applies to the addition <span class="qtext400">REDEFINITION</span>:
</p>
<ul class="disc">
<li>This addition can be used in customer systems only. SAP does not deliver access rules of this type.</li>
</ul>
<ul class="disc">
<li>The addition can also be applied if there are no other access rules for an entity. It ensures that the conditions defined here are not disabled by any later access rules.</li>
</ul>
<ul class="disc">
<li>The addition can be used for a maximum of one access rule for a CDS entity. If used more than once, an activation error or import error occurs.</li>
</ul>
<ul class="disc">
<li>This addition also disables existing full access rules for a CDS entity. SAP does not deliver full
access rules, which means that this statement applies only to customer full access rules that are themselves overridden by customer <span class="qtext400">REDEFINITION</span> rules.</li>
</ul>
<p><span class="h4">
Note
</span></p>
<p>
No <a href="javascript:call_link('abenabstract_entity_glosry.html')" class="grey" title="Glossary Entry">abstract CDS entities</a> can be specified for <span class="qtext400">cds_entity</span>.
</p>
<p><span class="h4">
Example
</span></p>
<p>
The following CDS role defines an access condition for the CDS view <span class="qtext400">demo_cds_auth_lit_pfcg</span> in an access rule. Both a
<a href="javascript:call_link('abencds_f1_cond_pfcg.html')" class="blue">PFCG condition</a> for the
<a href="javascript:call_link('abenauthorization_object_glosry.html')" class="grey" title="Glossary Entry">authorization object</a> S_CARRID and a
<a href="javascript:call_link('abencds_f1_cond_literal.html')" class="blue">literal condition</a> for the currency field are specified.
</p>
<dl><dd>
<span class="qtext400">@MappingRole: true <br>define role demo_cds_role_lit_pfcg { <br>&nbsp;&nbsp;grant select on demo_cds_auth_lit_pfcg <br>
&nbsp;&nbsp;where (carrid) = <br>&nbsp;&nbsp;aspect pfcg_auth (s_carrid, carrid, actvt='03') and <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currcode = 'EUR'; }</span>
</dd></dl>
<p>
The CDS view is as follows:
</p>
<dl><dd>
<span class="qtext400">@AbapCatalog.sqlViewName: 'DEMO_CDS_LITPFCG' <br>@AccessControl.authorizationCheck: #CHECK <br>
define view demo_cds_auth_lit_pfcg <br> as select from <br> scarr <br> { <br> key carrid, <br> carrname, <br> currcode, <br> url <br> };&nbsp;&nbsp;&nbsp;&nbsp;</span>
</dd></dl>
<p>
The program <span class="lnkgrey">DEMO_CDS_AUTH_LIT_PFCG</span> uses <a href="javascript:call_link('abapselect.html')" class="blue"><span class="qtext">
SELECT</span></a> to access the view. CDS access control limits selections to that data for which the
current user has an authorization (in the classic role editor in <span class="lnkgrey">transaction PFCG</span>) and that meets the literal condition.
</p>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abencds_dcl_role_cond_expr.html')" class="blue">ABAP CDS - DEFINE ROLE, cond_expr</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_dcl_role_cond_rule.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:42 GMT -->
</html>
