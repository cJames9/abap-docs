<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPHAVING_CLAUSE -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaphaving_clause.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:51 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="SELECT - HAVING">
<title>
SELECT - HAVING - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abaphaving_clause.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abaphaving_clause.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_language_external_data.html')" class="blue">Processing External Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_sql.html')" class="blue">ABAP Database Access</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenopensql.html')" class="blue">ABAP SQL</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenopen_sql_reading.html')" class="blue">ABAP SQL - Reads</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenselect_clauses.html')" class="blue">SELECT clauses</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@HAVING@@SELECT@@"></A>
<p><span class="h1">
SELECT - HAVING <br><br>
</span></p>
<P>
<a href="javascript:call_link('abapselect_shortref.html')" class="blue">Quick Reference</a> <br><br>
</P>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">... HAVING <a href="javascript:call_link('abenasql_cond.html')" class="blue">sql_cond</a> ...</span> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
The addition <span class="qtext">HAVING</span> limits the number of rows in groups in the results set of a
<a href="javascript:call_link('abenquery_glosry.html')" class="grey" title="Glossary Entry">query</a> by using the logical expression
<span class="qtext">sql_cond</span> on these rows. The logical expression evaluates the content of row groups. Those rows are placed in the results set for which the logical expression is true.
</P>
<P>
The following should be noted with respected to the operands of the relational expressions of the logical expression <a href="javascript:call_link('abenwhere_logexp.html')" class="blue"><span class="qtext">sql_cond</span></a>:
</P>
<ul class="disc">
<li>
Non-aggregated <a href="javascript:call_link('abenopen_sql_columns.html')" class="blue">columns</a> used as operands in the
<a href="javascript:call_link('abapselect_data_source.html')" class="blue">data sources</a> specified after <a href="javascript:call_link('abapfrom_clause.html')" class="blue">
<span class="qtext">FROM</span></a> do not need to be specified in the <a href="javascript:call_link('abapselect_list.html')" class="blue">
<span class="qtext">SELECT</span> list</a> and must be specified after the addition <a href="javascript:call_link('abapgroupby_clause.html')" class="blue">
<span class="qtext">GROUP BY</span></a> instead. For each group, the value used for the grouping is evaluated.
<br><br></li>
<li>
If <a href="javascript:call_link('abapsql_expr.html')" class="blue">SQL expressions</a> are used on the left side, either the
same expression must be specified or all non-aggregated columns of the expression must be specified individually after <a href="javascript:call_link('abapgroupby_clause.html')" class="blue"><span class="qtext">GROUP BY</span></a>.
<br><br></li>
<li>
In a <span class="qtext">HAVING</span> condition, aggregate expressions <a href="javascript:call_link('abapselect_aggregate.html')" class="blue">
<span class="qtext">sql_agg</span></a> can be used directly or as operands of SQL expressions on both
sides of comparisons. Columns that are specified as the argument of an aggregate expression directly
or via an SQL expression do not need to be listed after <span class="qtext">GROUP BY</span>. This kind
of aggregate expression is evaluated for each row group defined in <span class="qtext">GROUP BY</span>
and its result is used as an operand in the comparison. The aggregate functions of the <a href="javascript:call_link('abapselect_list.html')" class="blue">
<span class="qtext">SELECT</span> list</a> and the <span class="qtext">HAVING</span> clause and the SQL expressions specified as arguments here do not need to be the same.
<br></li>
</ul>
<P>
If a <span class="qtext">HAVING</span> clause is specified, all columns in the <a href="javascript:call_link('abapselect_list.html')" class="blue"><span class="qtext">SELECT</span> list</a> that are not arguments of
<a href="javascript:call_link('abapselect_aggregate.html')" class="blue">aggregate expressions</a> here must be specified after
<a href="javascript:call_link('abapgroupby_clause.html')" class="blue"><span class="qtext">GROUP BY</span></a>. If the <a href="javascript:call_link('abapselect_list.html')" class="blue">
<span class="qtext">SELECT</span> list</a> is specified as <span class="qtext">*</span>, <span class="qtext">HAVING</span>
clauses without <a href="javascript:call_link('abapgroupby_clause.html')" class="blue"><span class="qtext">GROUP BY</span> clauses</a> cannot be used.
</P>
<P>
<a href="javascript:call_link('abenopen_sql_client_handling.html')" class="blue">Implicit ABAP SQL client handling</a> applies to the <span class="qtext">HAVING</span> clause. The
<a href="javascript:call_link('abenclient_column_glosry.html')" class="grey" title="Glossary Entry">client column</a> of a client-specific data source cannot be used as an operand in the <span class="qtext">HAVING</span> condition.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
Aggregate expressions on the left side of a logical expression after <span class="qtext">HAVING</span>
are SQL expressions. Thus, all SQL expressions except for window expressions can be specified there.
Aggregate expressions on the right side of a logical expression are an exception to the rule that no SQL expressions can be specified here.
<br><br></li>
<li>
Columns that are specified as arguments of aggregate expressions after <span class="qtext">HAVING</span> can also be specified after <span class="qtext">GROUP BY</span>.
<br><br></li>
<li>
If a column is specified using a <a href="javascript:call_link('abenopen_sql_path.html')" class="blue">path expression</a>, both
the parameter passing and any attributes specified are respected by comparisons between the <span class="qtext">SELECT</span> list and the <span class="qtext">HAVING</span> clause.
<br><br></li>
<li>
If the addition <span class="qtext">GROUP BY</span> is not specified or the data object <span class="qtext">column_syntax</span>
in the dynamic column specification after <span class="qtext">GROUP BY</span> is initial, the addition
<span class="qtext">HAVING</span> can only be specified if the entire results set is grouped into a
line (that is, if there are only aggregate expressions specified after <span class="qtext">SELECT</span>).
In this case, only aggregate expressions can be specified as operands in <span class="qtext">sql_cond</span>. These operands are evaluated for all rows in the results set.
<br><br></li>
<li>
The <a href="javascript:call_link('abenclient_column_glosry.html')" class="grey" title="Glossary Entry">client column</a> of a client-specific data source can still be used in the <span class="qtext">HAVING</span> condition if implicit
<a href="javascript:call_link('abenclient_handling_glosry.html')" class="grey" title="Glossary Entry">client handling</a> is
switched off using the obsolete addition <a href="javascript:call_link('abapselect_client_obsolete.html')" class="blue"><span class="qtext">CLIENT SPECIFIED</span></a>.
<br><br></li>
<li>
When an SQL expression is specified on the left side of the <span class="qtext">HAVING</span> condition or a host expression occurs on the right side, the syntax check is performed in
<a href="javascript:call_link('abenopensql_strict_mode_750.html')" class="blue">strict mode from Release 7.50</a>, which handles the statement more strictly than the regular syntax check.
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<P>

</P>
<P>
Reads the number of bookings in each class and for each flight date of a connection.
</P>
<p class="qtextml1">
<span class="qtext">
DATA: carrid TYPE sbook-carrid VALUE 'LH', <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connid TYPE sbook-connid VALUE '400'. <br>
 <br>cl_demo_input=>new( <br>&nbsp;&nbsp;)->add_field( CHANGING field = carrid <br>&nbsp;&nbsp;)->add_field( CHANGING field = connid )->request( ). <br>
 <br>SELECT fldate, class, COUNT( * ) AS class_cnt <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM sbook <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE connid = @connid <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY carrid, fldate, class <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HAVING carrid = @carrid <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ORDER BY fldate, class <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(result). <br> <br>cl_demo_output=>display( result ).
</span>
</p>
<p><span class="h4">
Executable Example
</span></p>
<p>
<a href="javascript:call_link('abensql_expr_in_aggregates_abexa.html')" class="blue">SQL Expressions, Use in Aggregate Expressions</a>
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaphaving_clause.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:51 GMT -->
</html>
