<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPCOLLECT -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapcollect.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:42 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="COLLECT">
<meta name="keywords" content="ABAP, COLLECT">
<title>
COLLECT - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapcollect.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapcollect.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_data_working.html')" class="blue">Processing Internal Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenitab.html')" class="blue">Internal Tables</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abentable_processing_statements.html')" class="blue">Processing Statements for Internal Tables</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@COLLECT@@!ABAP_STATEMENT!@@"></A>
<A NAME="@@INTO@@COLLECT@@"></A>
<p><span class="h1">
COLLECT <br><br>
</span></p>
<P>
<a href="javascript:call_link('abapcollect_shortref.html')" class="blue">Quick Reference</a> <br><br>
</P>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">COLLECT wa INTO itab <i class=bn>[</i><a href="javascript:call_link('abapcollect_itab_result.html')" class="blue">result</a><i class=bn>]</i>.</span> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This statement inserts the content of a work area <span class="qtext">wa</span> either as a single row
in an internal table <span class="qtext">itab</span> or adds the values of its numeric components to the corresponding values of existing rows with the same
<a href="javascript:call_link('abenprimary_table_key_glosry.html')" class="grey" title="Glossary Entry">primary table key</a>. <span class="qtext">wa</span> is a
<a href="javascript:call_link('abenfunctional_position_glosry.html')" class="grey" title="Glossary Entry">functional operand position</a>.
</P>
<P>
<a href="javascript:call_link('abapcollect_itab_result.html')" class="blue"><span class="qtext">result</span></a> can be used to set a reference to the inserted or changed row in the form of a field symbol or data reference.
</P>
<P>
Prerequisite for the use of this statement is that <span class="qtext">wa</span> is
<a href="javascript:call_link('abencompatible_glosry.html')" class="grey" title="Glossary Entry">compatible</a> with the row type of <span class="qtext">itab</span>. All components that are not part of the primary table key must have a
<a href="javascript:call_link('abennumeric_data_type_glosry.html')" class="grey" title="Glossary Entry">numeric data type</a>.
</P>
<P>
The table is scanned for a row with the same primary key as follows:
</P>
<ul class="disc">
<li>
In <a href="javascript:call_link('abenstandard_table_glosry.html')" class="grey" title="Glossary Entry">standard tables</a> that
are filled using <span class="qtext">COLLECT</span> only, the entry is determined by a temporary hash
administrator. The workload is independent of the number of entries in the table. The hash administrator
is temporary and is generally invalidated when the table is accessed to be changed. If <span class="qtext">COLLECT</span>
statements are specified after an invalidation, a linear search of all table rows is performed. The workload for this search increases in a linear fashion in relation to the number of entries. <br>
<br></li>
<li>
In <a href="javascript:call_link('abensorted_table_glosry.html')" class="grey" title="Glossary Entry">sorted tables</a>, the
entry is determined using a binary search. The workload has a logarithmic relationship to the number of entries in the table. <br>
<br></li>
<li>
In <a href="javascript:call_link('abenhashed_table_glosry.html')" class="grey" title="Glossary Entry">hashed tables</a>, the entry is determined using the hash administrator of the table and is always independent of the number of table entries.
<br></li>
</ul>
<P>
If no row is found with an identical primary key, a row is inserted as described below and filled with the content of <span class="qtext">wa</span>:
</P>
<ul class="disc">
<li>
In standard tables, the row is appended as the last row of the primary table index.
<br><br></li>
<li>
In sorted tables, the new row is inserted in the sort order of the internal table in accordance with its key values, and the primary table index of the subsequent rows is increased by 1.
<br><br></li>
<li>
In hashed tables, the new row is inserted into the internal table by the hash administrator, in accordance with its key values.
<br></li>
</ul>
<P>
If the internal table already contains one or more rows with an identical primary key, those values
of the components of work area <span class="qtext">wa</span> that are not part of the key are added
to the corresponding components of the uppermost existing row (in the case of index tables, this is the row with the lowest primary table index).
</P>
<P>
A non-handleable exception is raised if a duplicate entry in a unique
<a href="javascript:call_link('abensecondary_table_key_glosry.html')" class="grey" title="Glossary Entry">secondary table key</a> is produced when the statement <span class="qtext">COLLECT</span> is executed.
</P>
<P>
If the primary table key of a standard table is <a href="javascript:call_link('abenitab_empty_key.html')" class="blue">empty</a>,
all components of the row type must be numeric and the first row of the internal table is always compressed. If the system can statically detect this, the syntax check displays a warning that can be hidden using a
<a href="javascript:call_link('abenpragma_glosry.html')" class="grey" title="Glossary Entry">pragma</a>.
</P>
<P>
<span class="bold">System Fields</span>
</P>
<P>
The statement <span class="qtext">COLLECT</span> sets <span class="qtext">sy-tabix</span> for
<a href="javascript:call_link('abenstandard_table_glosry.html')" class="grey" title="Glossary Entry">standard tables</a> and
<a href="javascript:call_link('abensorted_table_glosry.html')" class="grey" title="Glossary Entry">sorted tables</a> to the row number of the inserted or existing row in the primary table index, and for
<a href="javascript:call_link('abenhashed_table_glosry.html')" class="grey" title="Glossary Entry">hashed tables</a> to the value 0. <br><br>
</P>
<p><span class="h4">
Programming Guideline
</span></p>
<P>
<a href="javascript:call_link('abencollect_guidl.html')" class="lnkpurple" title="Guideline">Do not fill standard tables with collections of rows</a>
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
<span class="qtext">COLLECT</span> should only be used if internal tables are to be created that are
genuinely unique or compressed. In this case, <span class="qtext">COLLECT</span> can greatly benefit
performance. If uniqueness or compression are not required, or the uniqueness is guaranteed for other
reasons, the statement <a href="javascript:call_link('abapinsert_itab.html')" class="blue"><span class="qtext">INSERT</span></a> should be used instead. <br>
<br></li>
<li>
The statement <span class="qtext">COLLECT</span> is not suitable for standard tables and should no longer
be used for them. <span class="qtext">COLLECT</span> can be used for sorted tables and hashed tables
without any problems since these, unlike standard tables, always have a separate, stable key administration
that can be utilized by <span class="qtext">COLLECT</span>. When used for sorted tables, these should
have a unique primary key or the table should be filled with <span class="qtext">COLLECT</span> only. For hashed tables, all prerequisites are fulfilled automatically. <br>
<br></li>
<li>
If a standard table is still filled using <span class="qtext">COLLECT</span>, it should not be edited
using any other statement, with the exception of <a href="javascript:call_link('abapmodify_itab.html')" class="blue"><span class="qtext">MODIFY</span></a>.
If the latter is used with the addition <span class="qtext">TRANSPORTING</span>, no primary key fields
can be changed. This is the only way to ensure that the table entries are always unique and compressed,
and that the statement <span class="qtext">COLLECT</span> runs efficiently. The function module <span class="lnkgrey">
ABL_TABLE_HASH_STATE</span> can be used to check whether a standard table is suitable for editing using <span class="qtext">COLLECT</span>. <br>
<br></li>
<li>
The method HAS_COLLECT_HASH_ADMIN of the class <span class="lnkgrey">CL_ABAP_ITAB_UTILITIES</span> can
be used in standard tables to check whether temporary hash management insists in the statement <span class="qtext">COLLECT</span>. <br>
<br></li>
<li>
Outside of classes, an <a href="javascript:call_link('abenitab_short_forms.html')" class="blue">obsolete short form</a> is possible where <span class="qtext">wa INTO</span> can be omitted if the internal table has a
<a href="javascript:call_link('abenheader_line_glosry.html')" class="grey" title="Glossary Entry">header line</a> <span class="qtext">itab</span> with the same name. The statement then uses the header line as the work area implicitly. <br><br>
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<P>
Compressed insertion of data from the database table <span class="qtext">sflight</span> into the internal
table <span class="qtext">seats_tab</span>. The rows in which the primary key components <span class="qtext">carrid</span>
and <span class="qtext">connid</span> are identical are compressed by adding the number of occupied seats to the numeric component <span class="qtext">seatsocc</span>.
</P>
<p class="qtextml1">
<span class="qtext">
DATA: BEGIN OF seats, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;carrid&nbsp;&nbsp; TYPE sflight-carrid, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connid&nbsp;&nbsp; TYPE sflight-connid, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seatsocc TYPE sflight-seatsocc, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END OF seats. <br> <br>DATA seats_tab LIKE HASHED TABLE OF seats <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WITH UNIQUE KEY carrid connid. <br>
 <br>SELECT carrid, connid, seatsocc <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM sflight <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO @seats. <br>&nbsp;&nbsp;COLLECT seats INTO seats_tab. <br>ENDSELECT. <br><br>
</span>
</p>
<p><span class="h4">
<a href="javascript:call_link('abenabap_language_exceptions.html')" class="blue">Exceptions</a>
</span></p>
<P>
<span class="bold">Handleable Exceptions</span>
</P>
<P>
<span class="lnkgrey">CX_SY_ARITHMETIC_OVERFLOW</span>
</P>
<ul class="disc">
<li>
<span class="italic">Cause:</span> Overflow in integer field when creating totals <br><span class="italic">Runtime error:</span> <span class="qtext">COLLECT_OVERFLOW</span>
<br><br></li>
<li>
<span class="italic">Cause:</span> Overflow in type <span class="qtext">p</span> field when creating totals <br><span class="italic">Runtime error:</span> <span class="qtext">COLLECT_OVERFLOW_TYPE_P</span> <br><br>
<br></li>
</ul>
<P>
<span class="bold">Non-Handleable Exceptions</span>
</P>
<ul class="disc">
<li>
<span class="italic">Cause:</span> <span class="qtext">COLLECT</span> used for non-numeric fields <br><span class="italic">Runtime error:</span> <span class="qtext">TABLE_COLLECT_CHAR_IN_FUNCTION</span>
<br><br></li>
<li>
<span class="italic">Cause:</span> <a href="javascript:call_link('abentables_parameters_restrictions.html')" class="blue">Memory area violated</a> when <span class="qtext">TABLES</span> parameter accessed <br>
<span class="italic">Runtime error:</span> <span class="qtext">ITAB_STRUC_ACCESS_VIOLATION</span> <br><br>
<br></li>
</ul>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abapcollect_itab_result.html')" class="blue">COLLECT - result</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapcollect.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:42 GMT -->
</html>
