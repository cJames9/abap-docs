<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPLOOP_AT_ITAB_GROUP_BY -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaploop_at_itab_group_by.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:35 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="LOOP AT itab - GROUP BY">
<title>
LOOP AT itab - GROUP BY - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abaploop_at_itab_group_by.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abaploop_at_itab_group_by.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_data_working.html')" class="blue">Processing Internal Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenitab.html')" class="blue">Internal Tables</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abentable_processing_statements.html')" class="blue">Processing Statements for Internal Tables</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abaploop_at_itab_variants.html')" class="blue">LOOP AT itab</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@GROUP BY@@LOOP AT itab@@"></A>
<p><span class="h1">
LOOP AT itab - GROUP BY <br><br>
</span></p>
<P>
<a href="javascript:call_link('abaploop_at_itab_shortref.html')" class="blue">Quick Reference</a> <br><br>
</P>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">LOOP AT itab <a href="javascript:call_link('abaploop_at_itab_result.html')" class="blue">result</a> <i class=bn>[</i>
<a href="javascript:call_link('abaploop_at_itab_cond.html')" class="blue">cond</a><i class=bn>]</i> GROUP BY <a href="javascript:call_link('abaploop_at_itab_group_by_key.html')" class="blue">group_key</a> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i>ASCENDING<i class=bn>|</i>DESCENDING <i class=bn>[</i>AS TEXT<i class=bn>]</i><i class=bn>]</i> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i>WITHOUT MEMBERS<i class=bn>]</i> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i><a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">group_result</a><i class=bn>]</i>. <br>
&nbsp;&nbsp;... <br>&nbsp;&nbsp;<a href="javascript:call_link('abaploop_at_group.html')" class="blue"><i class=bn>[</i>LOOP AT GROUP ...</a> <br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:call_link('abaploop_at_group.html')" class="blue">...</a> <br>
&nbsp;&nbsp;<a href="javascript:call_link('abaploop_at_group.html')" class="blue">ENDLOOP.<i class=bn>]</i></a> <br>&nbsp;&nbsp;... <br>ENDLOOP.</span> <br><br>
</P>
<p><span class="h3">
Extras:
</span></p>
<P>
   <A HREF="#!ABAP_ADDITION_1@1@" class="blue"> 1. <span class="qtext">... ASCENDING<i class=bn>|</i>DESCENDING <i class=bn>[</i>AS TEXT<i class=bn>]</i></span> </A> <br>
<br><A HREF="#!ABAP_ADDITION_2@2@" class="blue"> 2. <span class="qtext">... WITHOUT MEMBERS</span> </A> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This variant of the statement <a href="javascript:call_link('abaploop_at_itab_variants.html')" class="blue"><span class="qtext">LOOP
AT itab</span></a> groups the rows of the internal table and executes a loop across the groups. The
same applies to the syntax of the additions <a href="javascript:call_link('abaploop_at_itab_result.html')" class="blue">
<span class="qtext">result</span></a> and <a href="javascript:call_link('abaploop_at_itab_cond.html')" class="blue"><span class="qtext">cond</span></a> as to a
<a href="javascript:call_link('abaploop_at_itab.html')" class="blue">loop across rows</a> with the exception that the addition
<a href="javascript:call_link('abaploop_at_itab_result.html')" class="blue"><span class="qtext">TRANSPORTING NO FIELDS</span></a> cannot be specified.
</P>
<P>
If the addition <span class="qtext">GROUP BY</span> is specified, the <span class="qtext">LOOP</span> is processed in two phases:
</P>
<ul class="disc">
<li>
<span class="bold">Grouping</span> <br> <br>In the first phase, all rows specified by the conditions
<a href="javascript:call_link('abaploop_at_itab_cond.html')" class="blue"><span class="qtext">cond</span></a> are read in the processing order specified in a
<a href="javascript:call_link('abaploop_at_itab.html')" class="blue">loop across rows</a>. The statements in the statement block
between <span class="qtext">LOOP</span> and <span class="qtext">ENDLOOP</span> are not executed during
this operation. For each row read, a group key is constructed in the group key expression <a href="javascript:call_link('abaploop_at_itab_group_by_key.html')" class="blue">
<span class="qtext">group_key</span></a> instead. Each group key represents a group. Each row is assigned
to precisely one group (as a member). This is the group of all rows with the same group key. If the
addition <span class="qtext">WITHOUT MEMBERS</span> is not used, this assignment is internal and can be used for access to the members of a group in the second phase.
<br><br></li>
<li>
<span class="bold">Group Loop</span> <br> <br>In the second phase, a loop is executed across all groups.
The statements in the statement block between <span class="qtext">LOOP</span> and <span class="qtext">ENDLOOP</span>
are executed for each loop pass. The output behavior for the group loop is defined in <a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">
<span class="qtext">group_result</span></a> and the corresponding values can be accessed in the loop.
If the assignment of the table rows to their groups is defined, a member loop <a href="javascript:call_link('abaploop_at_group.html')" class="blue">
<span class="qtext">LOOP AT GROUP</span></a> can be nested in the <span class="qtext">LOOP</span> to read the rows in each group.
<br></li>
</ul>
<P>
The default order of the groups in the group loop plus the order of the members within a group is defined by the processing order of the <span class="qtext">LOOP</span> in the first phase:
</P>
<ul class="disc">
<li>
The default order of the groups is based on the time their group key is first created, which itself can be overridden using the additions <span class="qtext">ASCENDING</span> or <span class="qtext">DESCENDING</span>.
<br><br></li>
<li>
If the assignment of the rows to their group is defined, the order of the rows of a group is based on the time they are assigned to the group. This defines, in particular, the first row of each group, used as a representative in the
<a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">representative binding</a>.
<br></li>
</ul>
<P>
The internal table <span class="qtext">itab</span> cannot be modified in the group loop unless the addition <span class="qtext">WITHOUT MEMBERS</span> is specified. <br><br>
</P>
<P>
<span class="bold">System Fields</span>
</P>
<P>
This variant of the statement <span class="qtext">LOOP AT</span> with the addition <span class="qtext">GROUP BY</span> sets the values of the system field <span class="qtext">sy-tabix</span> in the group loop as follows:
</P>
<ul class="disc">
<li>
If a representative binding is defined in the <a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">output
behavior</a>, <span class="qtext">sy-tabix</span> is set to the value that would be set for the row representing the group in the <span class="qtext">LOOP</span> without grouping.
<br><br></li>
<li>
If a group key binding is defined in the <a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">output
behavior</a>, the groups are counted in <span class="qtext">sy-tabix</span>. The first loop pass sets <span class="qtext">sy-tabix</span> to 1 and each subsequent loop pass raises it by 1.
<br></li>
</ul>
<P>
After leaving the loop using <span class="qtext">ENDLOOP</span>, <span class="qtext">sy-tabix</span> is set to the value that it had before entering the loop. The same applies to <span class="qtext">sy-subrc</span> as in a
<a href="javascript:call_link('abaploop_at_itab.html')" class="blue">loop across rows</a>. <br><br>
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
A grouping (the assignment of rows to a group) exists only within the group loop and a group can only
be addressed here after <a href="javascript:call_link('abaploop_at_group.html')" class="blue"><span class="qtext">LOOP
AT GROUP</span></a> or <a href="javascript:call_link('abenfor_in_group.html')" class="blue"><span class="qtext">FOR ... IN GROUP</span></a>.
<br><br></li>
<li>
A member loop <a href="javascript:call_link('abaploop_at_group.html')" class="blue"><span class="qtext">LOOP AT GROUP</span></a>
is only possible in <span class="qtext">LOOP</span>s for which the internal table <span class="qtext">itab</span>
is specified directly as a data object and not specified as the result of a call or expression. If the
table is specified as the result of a call or expression, only the group keys exist in the group loop and not the groups themselves.
<br><br></li>
<li>
A <span class="qtext">LOOP</span> with the addition <span class="qtext">GROUP BY</span> is not possible for <a href="javascript:call_link('abenmesh_path_glosry.html')" class="grey" title="Glossary Entry">mesh paths</a>.
<br><br></li>
<li>
No <a href="javascript:call_link('abencontrol_level_processin_glosry.html')" class="grey" title="Glossary Entry">group level
processing</a> with the statement <a href="javascript:call_link('abapat_itab.html')" class="blue"><span class="qtext">AT</span></a> is possible in a <span class="qtext">LOOP</span> with the addition <span class="qtext">GROUP BY</span>.
<br><br></li>
<li>
Unlike in <a href="javascript:call_link('abencontrol_level_processin_glosry.html')" class="grey" title="Glossary Entry">group
level processing</a>, a grouping with <span class="qtext">GROUP BY</span> is not defined by the structure
of the rows and the processing order of the loop. A grouping with <span class="qtext">GROUP BY</span> can usually replace group level processing in cases where the internal table is sorted before the loop by the group key (see the
<a href="javascript:call_link('abenint_table_at_unsorted_abexa.html')" class="blue">example</a>).
<br><br></li>
<li>
Groupings using <span class="qtext">GROUP BY</span> replace self-programmed group loops (see the <a href="javascript:call_link('abenloop_group_by_explicit_abexa.html')" class="blue">example</a>).
<br><br></li>
<li>
Internal tables can also be grouped using the expression <a href="javascript:call_link('abenfor_groups_of.html')" class="blue"><span class="qtext">FOR GROUPS ... OF</span></a>. <br><br>
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<p>
The example shows the simplest form of grouping: by one column, without explicitly specifying the output
behavior of the group loop:  Within the loop, there is access to the work area <span class="qtext">wa</span>,
in particular to the component <span class="qtext">wa-carrid</span> that is used for grouping. The work
area <span class="qtext">wa</span> contains the first row of each group and represents the group in the loop. This is called a representative binding.
</p>
<p class="qtextml1">
<span class="qtext">
SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM spfli <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(spfli_tab). <br>
 <br>LOOP AT spfli_tab INTO DATA(wa) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY wa-carrid. <br>
&nbsp;&nbsp;cl_demo_output=>write( wa-carrid ). <br>ENDLOOP. <br>cl_demo_output=>display( ). <br><br>
</span>
</p>
<p><span class="h4">
Executable Examples
</span></p>
<P>
<a href="javascript:call_link('abenloop_group_by_abexas.html')" class="blue">Grouping Internal Tables</a> <br><br>
</P>
<A NAME="@@ASCENDING@@LOOP AT GROUP BY@@"></A>
<A NAME="@@DESCENDING@@LOOP AT GROUP BY@@"></A>
<A NAME="@@AS TEXT@@LOOP AT GROUP BY@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_1@1@"></A> <span class="bold">Addition 1</span>
</span></p>
<P>
<span class="qtext">... ASCENDING<i class=bn>|</i>DESCENDING <i class=bn>[</i>AS TEXT<i class=bn>]</i></span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
These additions sort the groups by the group key in ascending or descending order before the group loop
is executed. The groups are sorted in exactly the same way as when the statement <a href="javascript:call_link('abapsort_itab.html')" class="blue">
<span class="qtext">SORT</span></a> is used on an internal table whose primary table key is the group key and the addition <span class="qtext">AS TEXT</span> is applied accordingly.
</P>
<P>
The group loop is executed in the sort order. If the additions <span class="qtext">ASCENDING</span>
and <span class="qtext">DESCENDING</span> are not specified, the groups are in the order in which the value of a group key was constructed for the first time.
</P>
<p><span class="h4">
Note
</span></p>
<P>
Groups can be sorted as an addition to the statement <a href="javascript:call_link('abapsort_itab.html')" class="blue"><span class="qtext">SORT</span></a> if the criteria here are not enough.
</P>
<p><span class="h4">
Example
</span></p>
<p>
Like the example above, but with sorting by group key in descending order.
</p>
<p class="qtextml1">
<span class="qtext">
SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM spfli <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(spfli_tab). <br>
 <br>LOOP AT spfli_tab INTO DATA(wa) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY wa-carrid DESCENDING. <br>
&nbsp;&nbsp;cl_demo_output=>write( wa-carrid ). <br>ENDLOOP. <br>cl_demo_output=>display( ).
</span>
</p>
<p><span class="h4">
Executable Example
</span></p>
<P>
<a href="javascript:call_link('abenloop_group_by_sort_abexa.html')" class="blue">Grouping with <span class="qtext">LOOP</span> and Sort</a>. <br><br>
</P>
<A NAME="@@WITHOUT MEMBERS@@LOOP AT GROUP BY@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_2@2@"></A> <span class="bold">Addition 2</span>
</span></p>
<P>
<span class="qtext">... WITHOUT MEMBERS</span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
The addition <span class="qtext">WITHOUT MEMBERS</span> deactivates the default internal variant of
the assignment of each table row to its group. This addition constructs groups but there is not access
to the rows of the groups in the group loop. If the addition <span class="qtext">WITHOUT MEMBERS</span> is specified, the following applies:
</P>
<ul class="disc">
<li>
The <a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">output behavior</a> cannot be defined for a row of the group as a representative and a group key binding must be defined.
<br><br></li>
<li>
The group loop cannot contain a nested member loop <a href="javascript:call_link('abaploop_at_group.html')" class="blue"><span class="qtext">LOOP AT GROUP</span></a>.
<br><br></li>
<li>
The internal table <span class="qtext">itab</span> can be modified in the group loop.
<br></li>
</ul>
<p><span class="h4">
Note
</span></p>
<P>
The addition <span class="qtext">WITHOUT MEMBERS</span> is used to improve performance in all cases where the content of the groups is not required. <br><br>
</P>
<p><span class="h4">
Example
</span></p>
<p>
Like the example above, but with the addition <span class="qtext">WITHOUT MEMBERS</span>, for which
a group key binding is defined with <span class="qtext">INTO DATA(key)</span>. There is no access to the rows of the groups in the loop.
</p>
<p class="qtextml1">
<span class="qtext">
SELECT * <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM spfli <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO TABLE @DATA(spfli_tab). <br>
 <br>LOOP AT spfli_tab INTO DATA(wa) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY wa-carrid WITHOUT MEMBERS <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO DATA(key). <br>
&nbsp;&nbsp;cl_demo_output=>write( key ). <br>ENDLOOP. <br>cl_demo_output=>display( ). <br><br>
</span>
</p>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abaploop_at_itab_group_by_key.html')" class="blue">LOOP AT itab - group_key</a><br>
<a href="javascript:call_link('abaploop_at_itab_group_by_binding.html')" class="blue">LOOP AT itab - group_result</a><br>
<a href="javascript:call_link('abaploop_at_group.html')" class="blue">LOOP AT GROUP</a><br>
<a href="javascript:call_link('abenloop_group_by_abexas.html')" class="blue">Examples of Grouping with LOOP</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abaploop_at_itab_group_by.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:35 GMT -->
</html>
