<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENCDS_F1_DEFINE_PFCG_MAPPING -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_f1_define_pfcg_mapping.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:37 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="ABAP CDS - DEFINE PFCG_MAPPING">
<meta name="keywords" content="ABAP, CDS, DEFINE PFCG_MAPPING">
<title>
ABAP CDS - DEFINE PFCG_MAPPING - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abencds_f1_define_pfcg_mapping.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abencds_f1_define_pfcg_mapping.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_dictionary.html')" class="blue">ABAP - Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds.html')" class="blue">ABAP CDS in ABAP Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_authorizations.html')" class="blue">ABAP CDS - Access Control</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_dcl_syntax.html')" class="blue">ABAP CDS - DCL Statements</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_define_accesspolicy.html')" class="blue">ABAP CDS - DEFINE ACCESSPOLICY</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@DEFINE PFCG_MAPPING@@!ABAP_CDS_STATEMENT!@@"></A>
<A NAME="@@BETWEEN AND@@!ABAP_CDS_DEFINE_PM!@@"></A>
<A NAME="@@USING@@!ABAP_CDS_DEFINE_PM!@@"></A>
<p><span class="h1">
ABAP CDS - DEFINE PFCG_MAPPING
</span></p>
<A name="@@ITOC@@ABENCDS_F1_DEFINE_PFCG_MAPPING_1"></A>
<p><span class="h2">
Syntax
</span></p>
<p>
<span class="qtext400"><i class=bn>[</i><a href="javascript:call_link('abencds_f1_dcl_pm_annotations.html')" class="blue">pfcg_mapping_annot</a><i class=bn>]</i> <br>
<i class=bn>[</i>DEFINE<i class=bn>]</i> PFCG_MAPPING pfcg_mapping(output1<i class=bn>[</i>, output2 ...<i class=bn>]</i>) <br>
&nbsp;&nbsp;BETWEEN mapping_entity AND auth_object <i class=bn>[</i>IN SCENARIO scenario_name<i class=bn>]</i> <br>
&nbsp;&nbsp;{ input1 = auth_field1 <i class=bn>[</i>CONSTRAINT ID<i class=bn>]</i><i class=bn>[</i>, <br>
&nbsp;&nbsp;&nbsp;&nbsp;input2 = auth_field2 <i class=bn>[</i>CONSTRAINT ID<i class=bn>]</i> ... <i class=bn>]</i> }</span> <br><br>
</p>
<p><span class="h4">
Effect
</span></p>
<p>
Defines a <a href="javascript:call_link('abencds_pfcg_mapping_glosry.html')" class="grey" title="Glossary Entry">PFCG mapping</a> <span class="qtext400">pfcg_mapping</span> as part of a
<a href="javascript:call_link('abencds_access_policy_glosry.html')" class="grey" title="Glossary Entry">CDS access policy</a>
defined using <a href="javascript:call_link('abencds_f1_define_accesspolicy.html')" class="blue"><span class="qtext400">DEFINE ACCESSPOLICY</span></a>. The name of the PFCG mapping must match the name of the CDS access policy.
</p>
<p>
The definition of a PCFG mapping contains the following:
</p>
<ul class="disc">
<li>A comma-separated list after the name <span class="qtext400">pfcg_mapping</span> in which the output
fields of the PFCG mapping are defined. These fields must be elements of the CDS entity <span class="qtext400">mapping_entity</span>
specified after <span class="qtext400">BETWEEN</span>. The specified order applies.</li>
</ul>
<ul class="disc">
<li>A CDS entity <span class="qtext400">mapping_entity</span> specified after the keyword <span class="qtext400">BETWEEN</span>
to define the fields used in the mapping. This definition specifies the input and output fields of the mapping.</li>
</ul>
<ul class="disc">
<li>An <a href="javascript:call_link('abenauthorization_object_glosry.html')" class="grey" title="Glossary Entry">authorization
object</a> <span class="qtext400">auth_object</span> specified after the keyword <span class="qtext400">AND</span>. The PFCG mapping can be
<a href="javascript:call_link('abencds_f1_cond_pfcg_mapping.html')" class="blue">used</a> in precisely those
<a href="javascript:call_link('abencds_f1_cond_pfcg.html')" class="blue">PFCG conditions</a> in which this authorization object is specified after <span class="qtext400">ASPECT pfcg_auth</span>.</li>
</ul>
<ul class="disc">
<li>A comma-separated unordered list in curly brackets that associates the input fields <span class="qtext400">input1</span>, <span class="qtext400">input2</span>, ... of the mapping with
<a href="javascript:call_link('abenauthorization_field_glosry.html')" class="grey" title="Glossary Entry">authorization fields</a>
<span class="qtext400">auth_field</span> of the authorization object <span class="qtext400">auth_object</span>.</li>
</ul>
<ul class="circlem2">
<li>The input fields on the left sides must be elements of the CDS entity <span class="qtext400">mapping_entity</span> specified after <span class="qtext400">BETWEEN</span>.</li>
</ul>
<ul class="circlem2">
<li>Authorization fields of the authorization object <span class="qtext400">auth_object</span> must be specified on the right sides.</li>
</ul>
<ul class="circlem2">
<li>Any number of optional assignments can be flagged using the addition <span class="qtext400">CONSTRAINT ID</span>.</li>
</ul>
<p>
A PFCG mapping can be <a href="javascript:call_link('abencds_f1_cond_pfcg_mapping.html')" class="blue">used</a> in a
<a href="javascript:call_link('abencds_f1_cond_pfcg.html')" class="blue">PFCG</a> condition of the same authorization object. It is transformed to specific access conditions as follows when the condition is evaluated:
</p>
<ul class="disc">
<li>The values of the current user for the authorization fields assigned to the input fields fill the input fields of the mapping.</li>
</ul>
<ul class="disc">
<li>The output fields of the mapping are assigned to the elements within the <a href="javascript:call_link('abencds_f1_cond_pfcg_mapping.html')" class="blue">curly brackets</a> of the PFCG condition in the specified order.</li>
</ul>
<ul class="disc">
<li>The following applies to the input fields flagged with <span class="qtext400">CONSTRAINT ID</span>:</li>
</ul>
<ul class="circlem2">
<li>Only those authorization fields of the authorization object can be assigned that contain a single value in a specific authorization. Multiple values or patterns are not allowed (with the exception of full authorization using the value
"<span class="qtext400">*</span>"). Otherwise the PFCG mapping in the PFCG condition returns the value "false" for the authorization in question.</li>
</ul>
<ul class="circlem2">
<li>Full authorization can be assigned only when applied to all input fields of the PFCG mapping.</li>
</ul>
<ul class="disc">
<li>If full authorization exists for all input fields of the PFCG mapping (value
"<span class="qtext400">*</span>"), the PFCG mapping in the PFCG condition returns the value "true"
when evaluated. This makes it possible to read entries of the protected entity for which there are no output fields in the mapping.</li>
</ul>
<p><span class="h4">
<A NAME="!ABAP_ONE_ADD@1@"></A> <span class="bold">Addition</span><br><!-- /A -->
</span></p>
<P>
<span class="qtext400">... IN SCENARIO</span>
</P>
<p>
To use a PFCG mapping in a PFCG condition where the authorization object is subject to the switchable
authorization check, the PFCG mapping must also name the same scenario (as well as the same authorization object). For more information, see the
<a href="javascript:call_link('abencds_f1_cond_pfcg.html')" class="blue">PFCG condition</a> of the statement <span class="qtext400">DEFINE ROLE</span>. <br><br>
</p>
<p><span class="h4">
Note
</span></p>
<p>
In ABAP SQL access to a CDS entity assigned a role of this type, PFCG mappings are defined internally using a subquery after <span class="qtext400">EXISTS</span>. This can be seen in an
<a href="javascript:call_link('abensql_trace_glosry.html')" class="grey" title="Glossary Entry">SQL trace</a>. <br><br>
</p>
<p><span class="h4">
Example
</span></p>
<p>
The following example shows the definition of a PFCG mapping <span class="qtext400">demo_cds_auth_pfcg_mapping</span>
based on the CDS entity <span class="qtext400">demo_cds_mapping_entity</span> below. The output fields
of the PFCG mapping are the authorization fields <span class="qtext400">OBJECT</span>, <span class="qtext400">OBJ_NAME</span>,
and <span class="qtext400">DEVCLASS</span> of the authorization object <span class="qtext400">S_DEVELOP</span>. The input fields of the PFCG mapping are the elements of the CDS entity to which the output fields are assigned. The
<a href="javascript:call_link('abencds_f1_cond_pfcg_mapping.html')" class="blue">example</a> that demonstrates how a PFCG mapping is specified in a role shows how the mapping is used.
</p>
<ul class="disc">
<li><span class="bold">PFCG Mapping</span></li>
</ul>
<dl><dd>
<span class="qtext400">define accesspolicy demo_cds_pfcg_mapping&nbsp;&nbsp;{ <br>&nbsp;&nbsp;define pfcg_mapping demo_cds_pfcg_mapping( map_object,&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map_obj_name,&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map_devclass ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;between demo_cds_mapping_entity <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and S_DEVELOP <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ map_devclass = devclass, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map_object&nbsp;&nbsp; = objtype, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map_obj_name = objname } }</span>
</dd></dl>
<ul class="disc">
<li><span class="bold">CDS Entity</span></li>
</ul>
<dl><dd>
<span class="qtext400">@AbapCatalog.sqlViewName: 'DEMOCDSMAPPENT' <br>define view demo_cds_mapping_entity <br>
&nbsp;&nbsp;as select from <br>&nbsp;&nbsp;&nbsp;&nbsp;tadir <br>&nbsp;&nbsp;&nbsp;&nbsp;{ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;devclass as map_devclass, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object&nbsp;&nbsp; as map_object, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj_name as map_obj_name <br>
&nbsp;&nbsp;&nbsp;&nbsp;} <br>&nbsp;&nbsp;&nbsp;&nbsp;where <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;devclass =&nbsp;&nbsp;&nbsp;&nbsp;'SABAPDEMOS' <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and object&nbsp;&nbsp; =&nbsp;&nbsp;&nbsp;&nbsp;'PROG' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and obj_name like 'DEMO%'</span>
</dd></dl>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abencds_f1_dcl_pm_annotations.html')" class="blue">ABAP CDS - DEFINE PFCG_MAPPING, pfcg_mapping_annot</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_f1_define_pfcg_mapping.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:37 GMT -->
</html>
