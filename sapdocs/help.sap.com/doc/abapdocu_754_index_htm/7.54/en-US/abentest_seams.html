<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENTEST_SEAMS -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abentest_seams.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:52:19 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="Test Seams">
<meta name="keywords" content="ABAP, Injections, Test Seams">
<title>
Test Seams - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abentest_seams.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abentest_seams.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenprogram_editing.html')" class="blue">program editing</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_tests.html')" class="blue">Testing and Checking Programs</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_unit.html')" class="blue">ABAP Unit</a>&nbsp;&rarr;&nbsp;
</span>
<p><span class="h1">
Test Seams
</span></p>
<p>
Test seams are language constructs designed especially for <a href="javascript:call_link('abenunit_test_glosry.html')" class="grey" title="Glossary Entry">unit tests</a> and are implemented using the following statements:
</p>
<ul class="disc">
<li><a href="javascript:call_link('abaptest-seam.html')" class="blue"><span class="qtext">TEST-SEAM</span> - <span class="qtext">END-TEST-SEAM</span></a></li>
</ul>
<dl><dd>
Defines a test seam as a replaceable area in the production code of a program.
</dd></dl>
<ul class="disc">
<li><a href="javascript:call_link('abaptest-injection.html')" class="blue"><span class="qtext">TEST-INJECTION</span> - <span class="qtext">END-TEST-INJECTION</span></a></li>
</ul>
<dl><dd>
Replaces the executable statements of a test seam by the statements of an injection in a <a href="javascript:call_link('abentest_class_glosry.html')" class="grey" title="Glossary Entry">test class</a> of the same program.
</dd></dl>
<p>
Test seams have the following properties:
</p>
<ul class="disc">
<li>Test seams do not affect the production use of programs. No injection takes place, rather the original code is executed.</li>
</ul>
<ul class="disc">
<li>A program can contain more than one test seam.</li>
</ul>
<ul class="disc">
<li>Multiple injections can be defined for a single test seam.</li>
</ul>
<ul class="disc">
<li>Injections can only be created in test classes that are defined in a
<a href="javascript:call_link('abentest_include_glosry.html')" class="grey" title="Glossary Entry">test include</a>. Test seams can be used in all executable units of a master program that includes a test include , including local classes and subroutines
.</li>
</ul>
<ul class="disc">
<li>Unit tests can make injections while <a href="javascript:call_link('abentest_method_glosry.html')" class="grey" title="Glossary Entry">test methods</a> or the <span class="qtext">setup</span> method are being executed.</li>
</ul>
<ul class="disc">
<li>If injections are repeated in the same test seam, the last injection is the active injection.</li>
</ul>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>Test seams are a simple way of replacing or expanding source code in production parts of a program
for test purposes. If, for example, the behavior of certain statements prevents tests from running, the unit test can replace them with suitable alternatives. Typical scenarios are:</li>
</ul>
<ul class="circlem2">
<li>Authorization checks</li>
</ul>
<ul class="circlem2">
<li>Reading persistent data</li>
</ul>
<ul class="circlem2">
<li>Modifying persistent data</li>
</ul>
<ul class="circlem2">
<li>Creating test doubles</li>
</ul>
<ul class="disc">
<li>Test seams are intended mainly for use with legacy code that, due to
<a href="javascript:call_link('abenseperation_concerns_guidl.html')" class="lnkpurple" title="Guideline">separation of concerns</a>,
is no suitable for unit tests. New programs, on the other hand, should be modular in such a way that test seams are made unnecessary.</li>
</ul>
<p><span class="h4">
Example for authorization checks
</span></p>
<p>
An injection can use the statement <a href="javascript:call_link('abapauthority-check.html')" class="blue"><span class="qtext">AUTHORITY-CHECK</span></a>
to bypass the dependency of a unit test on the authorizations of the current user by setting a suitable return code.
</p>
<table border>
<tr>
<td><span class="bold">Test Seam</span></td>
<td><span class="bold">Injection</span></td>
</tr>
<tr>
<td><span class="qtext400">TEST-SEAM authorization_seam.<br>&nbsp;&nbsp;AUTHORITY-CHECK OBJECT 'S_CTS_ADMI'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID 'CTS_ADMFCT' FIELD 'TABL'.<br>END-TEST-SEAM.<br><br>IF sy-subrc = 0.<br>&nbsp;&nbsp;is_authorized = abap_true.<br>ENDIF.</span></td>
<td><span class="qtext400">TEST-INJECTION authorization_seam.<br>&nbsp;&nbsp;sy-subrc = 0.<br>END-TEST-INJECTION.</span></td>
</tr>
</table><br>
<p><span class="h4">
Example for reading persistent data
</span></p>
<p>
It is often not possible to make assumptions about the content of database tables or other repositories
in unit tests. Using test seams, unit tests can bypass the dependencies of persistent data by replacing it with constructed data.
</p>
<table border>
<tr>
<td><span class="bold">Test Seam</span></td>
<td><span class="bold">Injection</span></td>
</tr>
<tr>
<td><span class="qtext400">TEST-SEAM read_content_seam.<br>&nbsp;&nbsp;SELECT *<br>&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; FROM sflight<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE&nbsp;&nbsp;carrid IN @carrid_range AND<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fldate EQ @sy-datum<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO TABLE @flights.<br>END-TEST-SEAM.</span></td>
<td><span class="qtext400">TEST-INJECTION read_content_seam.<br>&nbsp;&nbsp;flights =<br>&nbsp;&nbsp;
&nbsp;VALUE #( ( carrid = 'LHA'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp; connid = 100 )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ( carrid = 'AFR'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connid = 900 ) ).<br>END-TEST-INJECTION.</span></td>
</tr>
</table><br>
<p><span class="h4">
Example for changing persistent data
</span></p>
<p>
When they run, unit tests must not modify production content of database tables or other repositories.
Using test seams, unit tests can record the operands of modifying database operations or compare actual
changes with expected changes. In the following source code section compares, the injection compares the change values with a public static attribute.
</p>
<table border>
<tr>
<td><span class="bold">Test Seam</span></td>
<td><span class="bold">Injection</span></td>
</tr>
<tr>
<td><span class="qtext400">TEST-SEAM store_content_seam.<br>&nbsp;&nbsp;MODIFY sflight<br>&nbsp;&nbsp;&nbsp;&nbsp;FROM TABLE @new_flights.<br>END-TEST-SEAM.</span></td>
<td><span class="qtext400">TEST-INJECTION store_content_seam.<br>&nbsp;&nbsp;cl_abap_unit_assert=>assert_equals(<br>
&nbsp;&nbsp;&nbsp; act = new_flights<br>&nbsp;&nbsp;&nbsp;&nbsp; exp = global_buffer=>exp_flights ).<br>END-TEST-INJECTION.</span></td>
</tr>
</table><br>
<p><span class="h4">
Example for a test double
</span></p>
<p>
In the following source code section, the production source text of class that is dependent on database
content is instantiated. The unit test injects the instantiated test double at the location of the production object.
</p>
<table border>
<tr>
<td><span class="bold">Test Seam</span></td>
<td><span class="bold">Injection</span></td>
</tr>
<tr>
<td><span class="qtext400">TEST-SEAM instantiation_seam.<br>&nbsp;&nbsp;me->oref = NEW #( ).<br>END-TEST-SEAM.</span></td>
<td><span class="qtext400">TEST-INJECTION instantiation_seam.<br>&nbsp;&nbsp;me->oref = NEW dummy_class( ).<br> END-TEST-INJECTION.</span></td>
</tr>
</table><br>
<p><span class="h4">
Example
</span></p>
<p>
See also the class <span class="lnkgrey">CL_AU_SAMPLE_TEST_SEAMS</span> in the package <span class="lnkgrey">SABP_UNIT_SAMPLE</span>.
</p>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abaptest-seam.html')" class="blue">TEST-SEAM</a><br>
<a href="javascript:call_link('abaptest-injection.html')" class="blue">TEST-INJECTION</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abentest_seams.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:52:19 GMT -->
</html>
