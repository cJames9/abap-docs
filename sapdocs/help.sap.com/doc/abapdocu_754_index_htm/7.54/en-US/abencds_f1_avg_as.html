<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENCDS_F1_AVG_AS -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_f1_avg_as.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:36 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="ABAP CDS - AVG, AS">
<title>
ABAP CDS - AVG, AS - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abencds_f1_avg_as.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abencds_f1_avg_as.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_dictionary.html')" class="blue">ABAP - Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds.html')" class="blue">ABAP CDS in ABAP Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenddic_cds_entities.html')" class="blue">ABAP CDS - Data Definitions</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_ddl_syntax.html')" class="blue">ABAP CDS - DDL for Data Definitions</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_define_view.html')" class="blue">ABAP CDS - DEFINE VIEW</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_select_statement.html')" class="blue">ABAP CDS - SELECT</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_operands_and_expressions.html')" class="blue">ABAP CDS - SELECT, Operands and Expressions</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_aggregate_functions.html')" class="blue">ABAP CDS - aggr_expr</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@AVG, AS@@!ABAP_CDS_EXPRESSION!@@"></A>
<p><span class="h1">
ABAP CDS - AVG, AS
</span></p>
<A name="@@ITOC@@ABENCDS_F1_AVG_AS_1"></A>
<p><span class="h2">
Syntax
</span></p>
<p>
<span class="qtext400">... AVG( <i class=bn>[</i>DISTINCT<i class=bn>]</i> operand AS dtype ) ...</span>
</p>
<p><span class="h4">
Effect
</span></p>
<p>
Aggregate expression <a href="javascript:call_link('abencds_f1_aggregate_functions.html')" class="blue"><span class="qtext400">AVG</span></a> of a
<a href="javascript:call_link('abencds_view_glosry.html')" class="grey" title="Glossary Entry">CDS view</a> with a data type
<span class="qtext400">dtype</span> specified. The data type determines the result type in which the average value is returned.
</p>
<p>
The same can be specified for the <span class="qtext400">operand</span> as for all
<a href="javascript:call_link('abencds_f1_aggregate_functions.html')" class="blue">aggregate expressions</a> with one exception;
<a href="javascript:call_link('abencds_f1_case_expression.html')" class="blue"><span class="qtext400">CASE</span></a> cannot be specified. The data type of <span class="qtext400">operand</span> must be numeric and have one of the types
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">INT1</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">INT2</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">INT4</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">INT8</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DEC</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">CURR</a>, <a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">QUAN</a>, or <a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">FLTP</a>.
</p>
<p>
The data type <span class="qtext400">dtype</span> can have the built-in numeric type
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DEC</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">CURR</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">QUAN</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DECFLOAT16</a>,
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DECFLOAT34</a>, or
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">FLTP</a>. The data type FLTP, however, can only be specified for operands of type FLTP. The data type <span class="qtext400">dtype</span> can be specified as follows:
</p>
<ul class="disc">
<li>Using a <a href="javascript:call_link('abendata_element_glosry.html')" class="grey" title="Glossary Entry">data element</a> with a permitted type.</li>
</ul>
<ul class="disc">
<li>Directly as a <a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">built-in data type</a> in ABAP Dictionary.</li>
</ul>
<p>
The following table shows the syntax for specifying built-in data types:
</p>
<table border>
<tr>
<td><span class="bold">dtype</span></td>
<td><span class="bold">Dictionary Type</span></td>
</tr>
<tr>
<td><span class="qtext400">abap.dec(len,decimals)</span></td>
<td><a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DEC</a> with length <span class="qtext400">len</span> and <span class="qtext400">decimals</span> decimal places</td>
</tr>
<tr>
<td><span class="qtext400">abap.curr(len,decimals)</span></td>
<td><a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">CURR</a> with length <span class="qtext400">len</span> and <span class="qtext400">decimals</span> decimal places</td>
</tr>
<tr>
<td><span class="qtext400">abap.quan(len,decimals)</span></td>
<td><a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">QUAN</a> with length <span class="qtext400">len</span> with <span class="qtext400">decimals</span> decimal places</td>
</tr>
<tr>
<td><span class="qtext400">abap.fltp<i class=bn>[</i>(16,16)<i class=bn>]</i></span></td>
<td><a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">FLTP</a></td>
</tr>
</table><br>
<p>
The value range of the data type <span class="qtext400">dtype</span> must cover the value range of the operand type:
</p>
<ul class="disc">
<li>If <span class="qtext400">operand</span> is an integer type, a type <span class="qtext400">dtype</span>
of type DEC, CURR, QUAN must have at least as many integer digits as is required by the value range
of the respective integer type, that is, 3 for INT1, 5 for INT2, 10 for INT4, and 19 for INT8. There is no restriction on the number of decimal places.</li>
</ul>
<ul class="disc">
<li>If <span class="qtext400">operand</span> has type DEC, CURR, QUAN, a type <span class="qtext400">dtype</span> of type DEC, CURR, QUAN must have at least any many integer digits and decimal places.</li>
</ul>
<ul class="disc">
<li>If <span class="qtext400">operand</span> has type FLTP, this type must also be specified for <span class="qtext400">dtype</span>.</li>
</ul>
<p>
If the average value cannot be represented exactly in the data type <span class="qtext400">dtype</span>, the result is rounded commercially.
</p>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>The addition <span class="qtext400">AS</span> to <span class="qtext400">AVG</span> bridges the gap
for average values where FLTP cannot be cast to other numeric data types with <a href="javascript:call_link('abencds_f1_cast_expression.html')" class="blue"><span class="qtext400">CAST</span></a>.</li>
</ul>
<ul class="disc">
<li>Since average values usually have decimal places, integer types are not supported for <span class="qtext400">dtype</span>. If necessary, the type DEC can be used without decimal places.</li>
</ul>
<ul class="disc">
<li>An aggregate expression <span class="qtext400">AVG</span> with the addition <span class="qtext400">AS
dtype</span> can be used in accordance with this type in a <a href="javascript:call_link('abencds_f1_cast_expression.html')" class="blue"><span class="qtext400">CAST</span></a> expression.</li>
</ul>
<ul class="disc">
<li>An aggregate expression <span class="qtext400">AVG</span> cannot be applied to operands with the
data type INT8 without using the addition <span class="qtext400">AS</span>. The addition <span class="qtext400">AS</span> can also be used to form average values for columns with data type INT8.</li>
</ul>
<ul class="disc">
<li>The actual calculation of the average value (determined by the involved data types) is platform-dependent.
This can produce underflows, overflows, and exceptions during the calculation. To prevent exceptions,
the total of the values for which the average value is being calculated should be within the value range of <span class="qtext400">dtype</span>.</li>
</ul>
<ul class="disc">
<li>If FLTP is specified explicitly for operands of type FLTP, this ensures that the result of <span class="qtext400">AVG</span> actually has this type at each operand position, which cannot be guaranteed otherwise.</li>
</ul>
<p><span class="h4">
Example
</span></p>
<p>
The following CDS view demonstrates different uses of the aggregate expression <span class="qtext400">AVG</span>.
The program <span class="lnkgrey">DEMO_CDS_AVG</span> accesses the view. The average value is calculated with and without addition DISTINCT and is returned in various types.
</p>
<dl><dd>
<span class="qtext400">@AbapCatalog.sqlViewName: 'DEMOCDSAVG' <br>@AccessControl.authorizationCheck: #NOT_REQUIRED <br>
define view Demo_Cds_Avg <br>&nbsp;&nbsp;as select from <br>&nbsp;&nbsp;&nbsp;&nbsp;demo_expressions <br>
&nbsp;&nbsp;&nbsp;&nbsp;{ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;num1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ) as avg_no_type, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg( distinct num1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ) as avg_no_type_distinct, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num1 as abap.dec(10,0) ) as avg_dec0, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg( distinct num1 as abap.dec(10,0) ) as avg_dec0_distinct, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num1 as abap.dec(12,2) ) as avg_dec2, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg( distinct num1 as abap.dec(12,2) ) as avg_dec2_distinct <br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</dd></dl>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_f1_avg_as.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:36 GMT -->
</html>
