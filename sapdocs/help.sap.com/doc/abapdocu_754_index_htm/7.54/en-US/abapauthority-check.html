<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPAUTHORITY-CHECK -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapauthority-check.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:36 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="AUTHORITY-CHECK">
<meta name="keywords" content="ABAP, AUTHORITY-CHECK">
<title>
AUTHORITY-CHECK - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapauthority-check.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapauthority-check.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenbc_authority_check.html')" class="blue">Authorizations</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@AUTHORITY-CHECK@@!ABAP_STATEMENT!@@"></A>
<A NAME="@@OBJECT@@AUTHORITY-CHECK@@"></A>
<A NAME="@@FIELD@@AUTHORITY-CHECK@@"></A>
<A NAME="@@DUMMY@@AUTHORITY-CHECK@@"></A>
<A NAME="@@ID@@AUTHORITY-CHECK@@"></A>
<p><span class="h1">
AUTHORITY-CHECK <br><br>
</span></p>
<P>
<a href="javascript:call_link('abapauthority-check_shortref.html')" class="blue">Quick Reference</a> <br><br>
</P>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">AUTHORITY-CHECK OBJECT auth_obj <i class=bn>[</i>FOR USER user<i class=bn>]</i></span> <br>
<span class="qtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID id1 <i class=bn>{</i>FIELD val1<i class=bn>}</i><i class=bn>|</i>DUMMY</span> <br>
<span class="qtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i>ID id2 <i class=bn>{</i>FIELD val2<i class=bn>}</i><i class=bn>|</i>DUMMY<i class=bn>]</i></span> <br>
<span class="qtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span> <br>
<span class="qtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i>ID id10 <i class=bn>{</i>FIELD val10<i class=bn>}</i><i class=bn>|</i>DUMMY<i class=bn>]</i>.</span> <br><br>
</P>
<p><span class="h3">
Addition:
</span></p>
<P>
   <A HREF="#!ABAP_ONE_ADD@1@" class="blue"> <span class="qtext">... FOR USER user</span> </A> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This statement checks whether an <a href="javascript:call_link('abenauthorization_glosry.html')" class="grey" title="Glossary Entry">authorization</a> is entered in the
<a href="javascript:call_link('abenuser_master_record_glosry.html')" class="grey" title="Glossary Entry">user master record</a> of the current user or of the user specified in <span class="qtext">user</span> for the
<a href="javascript:call_link('abenauthorization_object_glosry.html')" class="grey" title="Glossary Entry">authorization object</a>
entered in <span class="qtext">auth_obj</span>, and whether this authorization is sufficient for the
request specified in the statement. If the addition <span class="qtext">FOR USER</span> is not specified, the authorization of the current user is checked.
</P>
<P>
<span class="qtext">auth_obj</span> expects a <a href="javascript:call_link('abenflat_glosry.html')" class="grey" title="Glossary Entry">
flat</a> character-like field containing the name of an authorization object in upper case. The following can be specified for <span class="qtext">auth_obj</span>:
</P>
<ul class="disc">
<li>Literal or constants <br> <br>If the data object <span class="qtext">auth_obj</span> is specified
as a character literal or as a constant, it can be evaluated statically and the specified authorization object is identified as the used object.</li>
</ul>
<ul class="disc">
<li>Variable <br> <br>If the data object <span class="qtext">auth_obj</span> is specified as a variable, it is specified only dynamically and the content is not evaluated statically.</li>
</ul>
<P>
If <span class="qtext">id1 ... id10</span> is specified, at least one and a maximum of 10 different
authorization fields must be specified for the authorization object in question. <span class="qtext">id1
... id10</span> expects flat character-like fields containing the names of the authorization fields
in uppercase. If an authorization field is specified that does not appear in the authorization object,
checks are not possible and <span class="qtext">sy-subrc</span> is set to 4. Each specified authorization
field expects either a value to be checked by <span class="qtext">FIELD</span> in a flat character-like
field <span class="qtext">val1 ... val10</span> or the addition <span class="qtext">DUMMY</span>. The
value being checked can have a maximum of 40 characters and no more than 40 places from <span class="qtext">val1 ... val10</span> are evaluated. Fields that are longer produce a warning from the extended program check.
</P>
<P>
The authorization check is carried out if the <a href="javascript:call_link('abencheck_indicator_glosry.html')" class="grey" title="Glossary Entry">
check indicator</a> for the specified authorization object for the current context is set to <span class="italic">check</span>
with any <span class="italic">proposal status</span>. If the check indicator is set to <span class="italic">no
check</span>, no authorization check is carried out and <span class="qtext">sy-subrc</span> is set to 0, as with a successful check.
</P>
<P>
The authorization check is successful if one or more authorizations are created for the authorization
object in the user master record and if, for at least one of the authorizations, each of the value sets
defined there for the authorization fields specified using <span class="qtext">ID</span> includes the
value <span class="qtext"> val1 ... val10</span> to be checked. Authorization fields that are not included
in the statement or that have <span class="qtext">DUMMY</span> specified for them are not checked. If
the check is successful, <span class="qtext">sy-subrc</span> is set to 0. Otherwise, it is set to a value not equal to 0 (see below). <br><br>
</P>
<P>
<span class="bold">System Fields</span>
</P>
<table border>
<tr>
<td><span class="qtext"><span class="bold">sy-subrc</span></span></td>
<td><span class="bold">Meaning</span></td>
</tr>
<tr>
<td>0</td>
<td>Authorization successful or no check was carried out. An authorization for the authorization object was found in the user master record. Its value sets include the specified values.</td>
</tr>
<tr>
<td>4</td>
<td>Authorization check not successful. One or more authorizations were found for the authorization
object in the user master record and they include the value sets, but not the values specified, or incorrect authorization fields or too many fields were specified.</td>
</tr>
<tr>
<td>12</td>
<td>No authorization was found for the authorization object in the user master record.</td>
</tr>
<tr>
<td>24</td>
<td>This return code is no longer set.</td>
</tr>
<tr>
<td>40</td>
<td>An invalid user name was specified in <span class="qtext">user</span>.</td>
</tr>
</table><br>
<P>
In <a href="javascript:call_link('abenauthority_during_update.html')" class="blue">updates</a> the statement <span class="qtext">AUTHORITY-CHECK</span>
always sets the value <span class="qtext">sy-subrc</span> to 0 and does not make an authorization check.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
The authorization fields of an authorization object are fields for data and a field with the name ACTVT
for activities. Activities are represented by IDs with two characters defined in the ACTVT column of
the database table <span class="lnkgrey">TACT</span> or have a customer-specific definition in <span class="lnkgrey">
TACTZ</span>. Possible activities are assigned to the authorization field ACTVT in the authorization
object. The user master record, contains authorizations for data and activities in the form of operands for logical expressions stored as value sets.
<br><br></li>
<li>
When checking the authorization of the current user without the addition <span class="qtext">FOR USER</span>,
the content of the system field <span class="qtext">sy-uname</span> is not evaluated, but the actual user name is used instead.
<br><br></li>
<li>
The most important contexts for which <a href="javascript:call_link('abencheck_indicator_glosry.html')" class="grey" title="Glossary Entry">
check indicators</a> can be set are transactions. The execution of a statement <span class="qtext">AUTHORITY-CHECK</span>
can have different results depending on how the current program flow was started. In general, a check indicator should always been set to <span class="italic">check</span>.
<br><br></li>
<li>
For authorization objects of the areas AS ABAP (BC) and human resources management (HR), a check indicator cannot be set to <span class="italic">no check</span>.
<br><br></li>
<li>
Do not specify an authorization field of the specified authorization object more than once. If an authorization
field is specified more than once, however, the check takes place as if it were dealing with different fields, that is, the specified values are checked individually.
<br><br></li>
<li>
The transaction <span class="lnkgrey">SU53</span> shows the results of the last authorization check for a user.
<br><br></li>
<li>
Alongside explicit authorization checks using <span class="qtext">AUTHORITY-CHECK</span>, there are also implicit authorization checks, for example in
<a href="javascript:call_link('abenabap_program_call.html')" class="blue">program calls</a> or using
<a href="javascript:call_link('abencds_access_control_glosry.html')" class="grey" title="Glossary Entry">CDS access control</a> when accessing <a href="javascript:call_link('abencds_entity_glosry.html')" class="grey" title="Glossary Entry">CDS entities</a>.
<br><br></li>
<li>
The documented class <span class="lnkgrey">CL_AUTH_OBJECTS_TO_SQL</span> enables the generation of dynamic
<span class="qtext">WHERE</span> conditions from authorization objects. When a database table is accessed,
a <span class="qtext">WHERE</span> condition of this type makes it possible to select only that data
for which the current user has authorization. This may replace the use of statement <span class="qtext">AUTHORITY-CHECK</span>, for example in a <span class="qtext">SELECT</span> loop.
<br><br></li>
<li>
See also <a href="javascript:call_link('abenauthority_scrty.html')" class="blue">Insufficient Authorization Checks</a>.
<br></li>
</ul>
<p><span class="h4">
Example
</span></p>
<P>
Checks whether the current user has the authorization to display the airline he or she entered on the
<a href="javascript:call_link('abenselection_screen_glosry.html')" class="grey" title="Glossary Entry">selection screen</a>.
The authorization object used here is S_CARRID and includes the authorization fields CARRID for identifying
an airline and ACTVT for the activity. The code "03" represents the activity "Display", which is one of the activities assigned to the authorization object S_CARRID.
</P>
<p class="qtextml1">
<span class="qtext">
PARAMETERS carr TYPE spfli-carrid. <br> <br>AT SELECTION-SCREEN. <br>&nbsp;&nbsp;AUTHORITY-CHECK OBJECT 'S_CARRID' <br>
&nbsp;&nbsp;&nbsp;&nbsp;ID 'CARRID' FIELD carr <br>&nbsp;&nbsp;&nbsp;&nbsp;ID 'ACTVT'&nbsp;&nbsp;FIELD '03'. <br>
 <br>&nbsp;&nbsp;IF sy-subrc &lt;> 0. <br>&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE 'No authorization' TYPE 'E'. <br>&nbsp;&nbsp;ENDIF. <br><br>
</span>
</p>
<A NAME="@@FOR USER@@AUTHORITY-CHECK@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ONE_ADD@1@"></A> <span class="bold">Addition</span>
</span></p>
<P>
<span class="qtext">... FOR USER user</span> <!-- /A -->  <br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
If the addition <span class="qtext">FOR USER</span> is specified, the authorization of the user is checked whose
<a href="javascript:call_link('abenuser_name_glosry.html')" class="grey" title="Glossary Entry">user name</a> is specified in
<span class="qtext">user</span>. <span class="qtext">user</span> expects a field of the same type as
the system field <span class="qtext">sy-uname</span>. If the user name is invalid, <span class="qtext">sy-subrc</span> is set to 40. <br><br>
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
This addition replaces the function module <span class="lnkgrey">AUTHORITY_CHECK</span>.
<br><br></li>
<li>
Using the addition <span class="qtext">FOR USER</span> produces a security risk. This addition can be
misused to bypass an authorization check by specifying a user with extensive authorizations. User names
passed to the program from the outside should never be specified. If this does become necessary, however, the name must be checked carefully.
<br><br></li>
<li>
The current user should not be specified explicitly using <span class="qtext">USER sy-uname</span>.
Not only is the user specified redundantly, the system field is also at risk of being overwritten, for example in ABAP Debugger.
<br><br></li>
<li>
See also <a href="javascript:call_link('abenuser_dependent_scrty.html')" class="blue">User-Specific Program Flow</a>. <br><br>
<br></li>
</ul>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapauthority-check.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:36 GMT -->
</html>
