<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPCREATE_OBJECT_OLE2 -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapcreate_object_ole2.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:44 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="CREATE OBJECT - OLE">
<meta name="keywords" content="ABAP, CREATE OBJECT - OLE">
<title>
CREATE OBJECT - OLE - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapcreate_object_ole2.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapcreate_object_ole2.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_data_communication.html')" class="blue">Data Interfaces and Communication Interfaces</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenole2.html')" class="blue">ABAP and OLE</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@CREATE OBJECT - OLE@@!ABAP_STATEMENT!@@"></A>
<p><span class="h1">
CREATE OBJECT - OLE <br><br>
</span></p>
<P>
<a href="javascript:call_link('abapcreate_object_ole_shortref.html')" class="blue">Quick Reference</a> <br><br>
</P>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">CREATE OBJECT ole class <i class=bn>[</i>NO FLUSH<i class=bn>]</i> <i class=bn>[</i>QUEUE-ONLY<i class=bn>]</i>.</span> <br><br>
</P>
<p><span class="h3">
Extras:
</span></p>
<P>
   <A HREF="#!ABAP_ADDITION_1@1@" class="blue"> 1. <span class="qtext">... NO FLUSH</span> </A> <br><br><A HREF="#!ABAP_ADDITION_2@2@" class="blue"> 2. <span class="qtext">... QUEUE-ONLY</span> </A> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This statement creates the automation object <span class="qtext">ole</span> of the automation class
<span class="qtext">class</span>. The object <span class="qtext">ole</span> must be of type <span class="qtext">ole2_object</span>, which is defined in ABAP Dictionary in the
<a href="javascript:call_link('abentype_group_1_glosry.html')" class="grey" title="Glossary Entry">type group</a> <span class="lnkgrey">OLE2</span>.
The automation class <span class="qtext">class</span> expects a character-like data object is expected that contains the name of the class.
</P>
<P>
The system automatically executes an authorization check if the column AUTH_CHK in the database table
<span class="lnkgrey">TOLE</span> contains the value "X" for the class. The authorization status can be checked with the function module <span class="lnkgrey">AUTHORITY_CHECK_OLE</span>. <br><br>
</P>
<P>
<span class="bold">System Fields</span>
</P>
<table border>
<tr>
<td><span class="qtext">sy-subrc</span></td>
<td><span class="bold">Meaning</span></td>
</tr>
<tr>
<td>0</td>
<td>Automation object created.</td>
</tr>
<tr>
<td>1</td>
<td>Error in communication to the SAP GUI</td>
</tr>
<tr>
<td>2</td>
<td>Error in function call in the SAP GUI</td>
</tr>
<tr>
<td>3</td>
<td>Problems with memory allocation in the presentation layer.</td>
</tr>
</table><br>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
For the declaration of <span class="qtext">ole</span>, exactly the type <span class="qtext">ole2_object</span>
must be specified. It is not sufficient to specify another type declared with a reference to <span class="qtext">ole2_object</span>.
<br><br></li>
<li>
An automation object <span class="qtext">ole</span> created using <span class="qtext">CREATE OBJECT
ole</span> must also be released by using <span class="qtext">FREE OBJECT ole</span> to avoid memory bottle necks and terminations of the application to be controlled.
<br><br></li>
<li>
<span class="qtext">CREATE OBJECT</span> for OLE should not be confused with the statement of the same name in ABAP Objects. <br><br>
<br></li>
</ul>
<A NAME="@@NO FLUSH@@CREATE OBJECT - OLE@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_1@1@"></A> <span class="bold">Addition 1</span>
</span></p>
<P>
<span class="qtext">... NO FLUSH</span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
When using the addition <span class="qtext">NO FLUSH</span>, calls from automation methods are collected
in the automation buffer until the function module FLUSH (which is provided for this purpose) is called and the <span class="qtext">FREE OBJECT</span> statement is passed or, at the most, until a change of
<a href="javascript:call_link('abenscreen_glosry.html')" class="grey" title="Glossary Entry">screen</a>. They are then passed
to the automation server in the current presentation layer for asynchronous execution. Without this
addition, the flush is executed and the pass takes place as soon as a statement that does not belong
to the automation command set is reached. Note that in the ABAP Debugger, the return values of the individual automation statements are not available until after the pass to the presentation layer. <br><br>
</P>
<A NAME="@@QUEUE-ONLY@@CREATE OBJECT - OLE@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_2@2@"></A> <span class="bold">Addition 2</span>
</span></p>
<P>
<span class="qtext">... QUEUE-ONLY</span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
The addition <span class="qtext">QUEUE-ONLY</span> dictates that, in flushes, the new object is not
passed to the specified ABAP data object <span class="qtext">rc</span> as a return code using methods
called by <span class="qtext">CALL METHOD OF</span>. In this case, the automation buffer can only contain
the statements <span class="qtext">CREATE OBJECT</span>, <span class="qtext">CALL METHOD</span>, and
<span class="qtext">GET PROPERTY</span> using the addition <span class="qtext">QUEUE-ONLY</span>. When executing the program in the ABAP Debugger, the return values are passed by default.
</P>
<p><span class="h4">
Example
</span></p>
<P>
In this example, the automation object <span class="qtext">app</span> is created, which has access to
all methods and attributes of the class APPLICATION in the MS Excel Library. This class contains methods with which, for example, an Excel document can be opened or copied.
</P>
<p class="qtextml1">
<span class="qtext">
DATA app TYPE ole2_object. <br> <br>CREATE OBJECT app 'Excel.Application' NO FLUSH.
</span>
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapcreate_object_ole2.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:44 GMT -->
</html>
