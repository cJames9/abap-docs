<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPEXEC_CONNECTION -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapexec_connection.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:43 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="EXEC SQL - CONNECT">
<title>
EXEC SQL - CONNECT - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapexec_connection.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapexec_connection.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_language_external_data.html')" class="blue">Processing External Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_sql.html')" class="blue">ABAP Database Access</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abennative_sql.html')" class="blue">Native SQL</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abennativesql.html')" class="blue">EXEC SQL - Embedded Native SQL</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abapexec.html')" class="blue">EXEC SQL</a>&nbsp;&rarr;&nbsp;
</span>
<p><span class="h1">
EXEC SQL - CONNECT
</span></p>
<P>
A connection must be defined with the database before
<a href="javascript:call_link('abennative_sql_glosry.html')" class="grey" title="Glossary Entry">Native SQL</a> statements can be used. When
<a href="javascript:call_link('abensap_nw_abap_glosry.html')" class="grey" title="Glossary Entry">AS ABAP</a> is started, a
<a href="javascript:call_link('abenstandard_db_connection_glosry.html')" class="grey" title="Glossary Entry">standard connection</a> from the database interface to the
<a href="javascript:call_link('abenstandard_db_glosry.html')" class="grey" title="Glossary Entry">standard
AS ABAP database</a> is opened. This connection is defined as the current connection for embedded Native SQL statements and as a standard connection for
<a href="javascript:call_link('abenopen_sql_glosry.html')" class="grey" title="Glossary Entry">ABAP SQL</a> statements when an
ABAP program is started. Use the following SAP-specific Native SQL statements, to start additional database connections. These connections can be accessed in static Native SQL.
</P>
<P>
The possible additional AS ABAP connections to database systems are
<a href="javascript:call_link('abensecondary_db_connection_glosry.html')" class="grey" title="Glossary Entry">secondary connections</a> defined in the database table <span class="lnkgrey">DBCON</span> or
<a href="javascript:call_link('abenservice_connection_glosry.html')" class="grey" title="Glossary Entry">service connections</a> whose name starts with <span class="qtext400">R/3*</span>.
</P>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABAPEXEC_CONNECTION_1" class="blue">Open Connection</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABAPEXEC_CONNECTION_2" class="blue">Selecting a Connection</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABAPEXEC_CONNECTION_3" class="blue">Determining the Connection</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABAPEXEC_CONNECTION_4" class="blue">Close connection</A></li>
</ul>
<ul class="disc">
<li><A HREF="#@@ITOC@@ABAPEXEC_CONNECTION_5" class="blue">Example</A></li>
</ul>
<p><span class="h4">
Note
</span></p>
<P>
Detailed information about database connections can be found <a href="javascript:call_link('abenopensql_multiconnect.html')" class="blue">here</a>.
</P>
<A NAME="@@CONNECT TO@@EXEC SQL@@"></A>
<A name="@@ITOC@@ABAPEXEC_CONNECTION_1"></A>
<p><span class="h2">
Open Connection
</span></p>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">EXEC SQL.</span> <br><span class="qtext">&nbsp;&nbsp;CONNECT TO conn <i class=bn>[</i>AS name<i class=bn>]</i></span> <br><span class="qtext">ENDEXEC.</span> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This static Native SQL statement requests a database connection called <span class="qtext">conn</span>.
This connection is opened (or reused) if it already exists in an inactive state for the current work
process. Once <span class="qtext">CONNECT TO</span> is executed, the specified connection is the current
connection of the internal session, which means that all subsequent static Native SQL statements work
with this connection until a connection other than the current is set using a new <span class="qtext">CONNECT TO</span> statement or using <span class="qtext">SET CONNECTION</span>.
</P>
<P>
For <span class="qtext">conn</span>, a a literal or a <a href="javascript:call_link('abapexec_host.html')" class="blue">host variable</a> that contains one of the following values can be specified:
</P>
<ul class="disc">
<li>
A name from the column CON_NAME of the database table <span class="lnkgrey">DBCON</span> used to specify a <a href="javascript:call_link('abensecondary_db_connection_glosry.html')" class="grey" title="Glossary Entry">secondary connection</a>
<br><br></li>
<li>
A name with the prefix <span class="qtext400">R/3*</span> used to specify a <a href="javascript:call_link('abenservice_connection_glosry.html')" class="grey" title="Glossary Entry">service connection</a>
<br></li>
</ul>
<P>
Both of these instances are case-sensitive. If a secondary connection that is not in the database table <span class="lnkgrey">DBCON</span> is specified, a handleable exception of the class CX_SY_NATIVE_SQL_ERROR is raised. If a
<a href="javascript:call_link('abensecondary_db_glosry.html')" class="grey" title="Glossary Entry">secondary database</a> cannot be reached, <span class="qtext">sy-subrc</span> is set to 4.
</P>
<P>
The addition <span class="qtext">AS</span> can be used to specify a name <span class="qtext">name</span>
for the connection. For <span class="qtext">name</span>, a literal or a character-like host variable
can be specified whose content is used as the name. A connection called <span class="qtext">name</span>
is not the same connection as a connection requested without using the addition <span class="qtext">AS</span>.
This makes it possible to open parallel connections with separate database LUWs for the same secondary
connection or service connection within an internal session, In an internal session, only one active
database session can be called <span class="qtext">name</span>. Any attempt to activate a further connection
with the same name produces a runtime error. A connection called <span class="qtext">name</span> can only be specified in the statement <span class="qtext">SET CONNECTION</span> using this name.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
The <a href="javascript:call_link('abenstandard_db_connection_glosry.html')" class="grey" title="Glossary Entry">standard connection</a> cannot be requested using <span class="qtext">CONNECT TO</span>.
<br><br></li>
<li>
A name granted using <span class="qtext">AS</span> can also be used in ABAP SQL after the addition <span class="qtext">
CONNECTION</span> and in the statements <a href="javascript:call_link('abapcommit_rollback_connection.html')" class="blue"><span class="qtext">
COMMIT CONNECTION</span></a> and <a href="javascript:call_link('abapcommit_rollback_connection.html')" class="blue"><span class="qtext">ROLLBACK CONNECTION</span></a>, as long as it is in uppercase letters.
<br></li>
</ul>
<A NAME="@@SET CONNECTION@@EXEC SQL@@"></A>
<A name="@@ITOC@@ABAPEXEC_CONNECTION_2"></A>
<p><span class="h2">
Selecting a Connection
</span></p>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">EXEC SQL.</span> <br><span class="qtext">&nbsp;&nbsp;SET CONNECTION <i class=bn>{</i>conn<i class=bn>|</i>DEFAULT<i class=bn>}</i></span> <br><span class="qtext">ENDEXEC.</span>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This static Native SQL statement sets the current connection for all following static Native SQL statements.
For <span class="qtext">conn</span>, a literal or a character-like host variable can be specified that contains the name of connection activated in the current connection.
</P>
<ul class="disc">
<li>
<span class="qtext400">DEFAULT</span> in uppercase letters or <span class="qtext">DEFAULT</span> specified directly can be used to specified the
<a href="javascript:call_link('abenstandard_db_connection_glosry.html')" class="grey" title="Glossary Entry">standard connection</a>.
<br><br></li>
<li>
A secondary or service connection activated using <span class="qtext">CONNECT TO</span> without specifying a name after <span class="qtext">AS</span> can be specified under its name <span class="qtext">conn</span>.
<br><br></li>
<li>
A secondary or service connection activated using <span class="qtext">CONNECT TO</span> while specifying a name after <span class="qtext">AS</span> can be specified under this name <span class="qtext">name</span>.
<br></li>
</ul>
<P>
All of these instances are case-sensitive. When an unknown connection is specified, the current connection remains unchanged and <span class="qtext">sy-subrc</span> is set to 4.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
When a current connection is switched to a different current connection, no database LUW is closed and no new LUW is opened.
<br><br></li>
<li>
Any changes to the current connection are applied only in static Native SQL after <span class="qtext">EXEC SQL</span>. ABAP SQL and any other variant of Native SQL remain unaffected.
<br><br></li>
<li>
The current connection is switched regardless of whether the connections in question are active or (after their database LUWs are closed) inactive.
<br></li>
</ul>
<A NAME="@@GET CONNECTION@@EXEC SQL@@"></A>
<A name="@@ITOC@@ABAPEXEC_CONNECTION_3"></A>
<p><span class="h2">
Determining the Connection
</span></p>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">EXEC SQL.</span> <br><span class="qtext">&nbsp;&nbsp;GET CONNECTION :conn</span> <br><span class="qtext">ENDEXEC.</span>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This static Native SQL statement assigns the name of the current connection to <span class="qtext">conn</span>.
<span class="qtext">conn</span> expects a character-like host variable. If the current connection was
activated using the statement <span class="qtext">CONNECT TO</span> and <span class="qtext">AS</span>
was used to give it a name at the same time, this name is assigned. If the connection is activated without
being given a name, the name of the secondary connection or service connection is assigned. If the current connection is the standard connection, the value <span class="qtext400">DEFAULT</span> is assigned.
</P>
<p><span class="h4">
Note
</span></p>
<P>
The current connection can be active or (after its database LUW is closed) inactive.
</P>
<A NAME="@@DISCONNECT@@EXEC SQL@@"></A>
<A name="@@ITOC@@ABAPEXEC_CONNECTION_4"></A>
<p><span class="h2">
Close connection
</span></p>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">EXEC SQL.</span> <br><span class="qtext">&nbsp;&nbsp;DISCONNECT conn</span> <br><span class="qtext">ENDEXEC.</span>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This static Native SQL statement closes the connection <span class="qtext">conn</span> for the current work process, which discards all database changes not yet committed using a
<a href="javascript:call_link('abendb_commit.html')" class="blue">database commit</a>. For <span class="qtext">conn</span>, a
literal or a character-like host variable can be specified that contains the name of a secondary connection or service connection activated in the internal session.
</P>
<ul class="disc">
<li>
A secondary or service connection activated using <span class="qtext">CONNECT TO</span> without specifying a name after <span class="qtext">AS</span> can be specified under its name <span class="qtext">conn</span>.
<br><br></li>
<li>
A secondary or service connection activated using <span class="qtext">CONNECT TO</span> while specifying a name after <span class="qtext">AS</span> can be specified under this name <span class="qtext">name</span>.
<br></li>
</ul>
<P>
If anything else is specified (most specifically <span class="qtext400">DEFAULT</span>), a runtime error
occurs. If the closed secondary connection or service connection is the current connection, the standard connection is set as the new current connection implicitly. All of these instances are case-sensitive.
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
The closed connection can be active or (after its database LUW is closed) inactive.
<br><br></li>
<li>
It is recommended that database connections are only closed implicitly by the ABAP runtime environment and not explicitly, since it takes a lot of resources to restore a connection.
<br></li>
</ul>
<A name="@@ITOC@@ABAPEXEC_CONNECTION_5"></A>
<p><span class="h2">
Example
</span></p>
<p><span class="h4">
Example
</span></p>
<P>
Opens a connection to an SAP HANA database and imports all entries of a column in the database table SCARR.
</P>
<p class="qtextml1">
<span class="qtext">
DATA conn TYPE dbcon-con_name. <br>cl_demo_input=>request( CHANGING field = conn ). <br> <br>SELECT SINGLE dbms <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM dbcon <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE con_name = @conn AND <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbms&nbsp;&nbsp;&nbsp;&nbsp; = 'HDB' <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INTO @DATA(dbtype). <br> <br>IF sy-subrc &lt;> 0. <br>&nbsp;&nbsp;RETURN. <br>
ENDIF. <br> <br>TRY. <br>&nbsp;&nbsp;&nbsp;&nbsp;EXEC SQL. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNECT TO :conn <br>
&nbsp;&nbsp;&nbsp;&nbsp;ENDEXEC. <br>&nbsp;&nbsp;&nbsp;&nbsp;IF sy-subrc &lt;> 0. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RAISE EXCEPTION TYPE cx_sy_native_sql_error <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textid = cx_sy_native_sql_error=>cx_sy_native_sql_error. <br>
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF. <br>&nbsp;&nbsp;&nbsp;&nbsp;EXEC SQL. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OPEN dbcur FOR <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT carrid <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM scarr <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE mandt = :sy-mandt <br>
&nbsp;&nbsp;&nbsp;&nbsp;ENDEXEC. <br>&nbsp;&nbsp;&nbsp;&nbsp;DATA carrid TYPE scarr-carrid. <br>&nbsp;&nbsp;&nbsp;&nbsp;DO. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC SQL. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FETCH NEXT dbcur INTO :carrid <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDEXEC. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF sy-subrc &lt;> 0. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_demo_output=>write( |{ carrid }| ). <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF. <br>
&nbsp;&nbsp;&nbsp;&nbsp;ENDDO. <br>&nbsp;&nbsp;&nbsp;&nbsp;EXEC SQL. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLOSE dbcur <br>
&nbsp;&nbsp;&nbsp;&nbsp;ENDEXEC. <br>&nbsp;&nbsp;&nbsp;&nbsp;EXEC SQL. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISCONNECT :conn <br>
&nbsp;&nbsp;&nbsp;&nbsp;ENDEXEC. <br>&nbsp;&nbsp;CATCH cx_sy_native_sql_error INTO DATA(exc). <br>&nbsp;&nbsp;&nbsp;&nbsp;cl_demo_output=>write( exc->get_text( ) ). <br>
ENDTRY. <br> <br>cl_demo_output=>display( ). <br><br>
</span>
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapexec_connection.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:43 GMT -->
</html>
