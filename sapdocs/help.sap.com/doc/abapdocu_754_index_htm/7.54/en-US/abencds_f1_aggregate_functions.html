<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABENCDS_F1_AGGREGATE_FUNCTIONS -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_f1_aggregate_functions.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:36 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="ABAP CDS - aggr_expr">
<title>
ABAP CDS - aggr_expr - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abencds_f1_aggregate_functions.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abencds_f1_aggregate_functions.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_dictionary.html')" class="blue">ABAP - Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds.html')" class="blue">ABAP CDS in ABAP Dictionary</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenddic_cds_entities.html')" class="blue">ABAP CDS - Data Definitions</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_ddl_syntax.html')" class="blue">ABAP CDS - DDL for Data Definitions</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_define_view.html')" class="blue">ABAP CDS - DEFINE VIEW</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_f1_select_statement.html')" class="blue">ABAP CDS - SELECT</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abencds_operands_and_expressions.html')" class="blue">ABAP CDS - SELECT, Operands and Expressions</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@MAX@@!ABAP_CDS_EXPRESSION!@@"></A>
<A NAME="@@MIN@@!ABAP_CDS_EXPRESSION!@@"></A>
<A NAME="@@AVG@@!ABAP_CDS_EXPRESSION!@@"></A>
<A NAME="@@SUM@@!ABAP_CDS_EXPRESSION!@@"></A>
<A NAME="@@COUNT@@!ABAP_CDS_EXPRESSION!@@"></A>
<p><span class="h1">
ABAP CDS - aggr_expr
</span></p>
<A name="@@ITOC@@ABENCDS_F1_AGGREGATE_FUNCTIONS_1"></A>
<p><span class="h2">
Syntax
</span></p>
<p>
<span class="qtext400">... <i class=bn>{</i> MAX( <i class=bn>[</i>ALL<i class=bn>|</i>DISTINCT<i class=bn>]</i> operand ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i class=bn>|</i> MIN( <i class=bn>[</i>ALL<i class=bn>|</i>DISTINCT<i class=bn>]</i> operand ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i class=bn>|</i> AVG( <i class=bn>[</i>ALL<i class=bn>|</i>DISTINCT<i class=bn>]</i> operand <a href="javascript:call_link('abencds_f1_avg_as.html')" class="blue"><i
class=bn>[</i>AS dtype<i class=bn>]</i></a> ) <br>&nbsp;&nbsp;&nbsp;&nbsp;<i class=bn>|</i> SUM( <i class=bn>[</i>ALL<i class=bn>|</i>DISTINCT<i class=bn>]</i> operand ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;<i class=bn>|</i> COUNT( DISTINCT operand ) <br>&nbsp;&nbsp;&nbsp;&nbsp;<i class=bn>|</i> COUNT(*) <i class=bn>}</i> ...</span>
</p>
<p><span class="h4">
Effect
</span></p>
<p>
Aggregate expression in a <a href="javascript:call_link('abencds_f1_select_statement.html')" class="blue"><span class="qtext400">SELECT</span> statement</a> of a
<a href="javascript:call_link('abencds_view_glosry.html')" class="grey" title="Glossary Entry">CDS view</a>. An aggregate expression
calculates a single value from an operand <span class="qtext400">operand</span> by calling an aggregate function from multiple rows of a results set. The following table shows the possible aggregate functions:
</p>
<table border>
<tr>
<td><span class="bold">Aggregate Function</span></td>
<td><span class="bold">Meaning</span></td>
<td><span class="bold">Result Type</span></td>
</tr>
<tr>
<td><span class="qtext400">MAX</span></td>
<td>Greatest value of <span class="qtext400">operand</span></td>
<td>Data type of <span class="qtext400">operand</span></td>
</tr>
<tr>
<td><span class="qtext400">MIN</span></td>
<td>Least value of <span class="qtext400">operand</span></td>
<td>Data type of <span class="qtext400">operand</span></td>
</tr>
<tr>
<td><span class="qtext400">AVG</span></td>
<td>Average value of <span class="qtext400">operand</span> (the operand must be numeric). Type
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">INT8</a> is only supported with addition <a href="javascript:call_link('abencds_f1_avg_as.html')" class="blue"><span class="qtext400">AS dtype</span></a>. The types
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DF16_...</a>, <a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DF34_...</a> for decimal free floating numbers are not supported.</td>
<td><a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">FLTP</a>, platform-specific interim result or <a href="javascript:call_link('abencds_f1_avg_as.html')" class="blue"><span class="qtext400">dtype</span></a></td>
</tr>
<tr>
<td><span class="qtext400">SUM</span></td>
<td>Sum of <span class="qtext400">operand</span> (the operand must be numeric). The types
<a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DF16_...</a>, <a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">DF34_...</a> for decimal free floating numbers are not supported.</td>
<td>Data type of <span class="qtext400">operand</span></td>
</tr>
<tr>
<td><span class="qtext400">COUNT</span></td>
<td>If <span class="qtext400">DISTINCT operand</span> is specified, the number of distinct values of
<span class="qtext400">operand</span>; if <span class="qtext400">*</span> is specified, the number of rows in the results set.</td>
<td><a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">INT4</a></td>
</tr>
</table><br>
<p>
If <span class="qtext400">ALL</span> is used, all rows in the results set are respected (standard setting).
If <span class="qtext400">DISTINCT</span> is used, only distinct values of <span class="qtext400">operand</span> are respected.
</p>
<p>
The following can be specified for <span class="qtext400">operand</span>:
</p>
<ul class="disc">
<li>A <a href="javascript:call_link('abencds_f1_literal.html')" class="blue">literal</a></li>
</ul>
<ul class="disc">
<li>A field of a data source <a href="javascript:call_link('abencds_f1_data_source.html')" class="blue"><span class="qtext400">data_source</span></a> of the current CDS view</li>
</ul>
<ul class="disc">
<li>A <a href="javascript:call_link('abencds_f1_path_expression.html')" class="blue">path expression</a> that identifies a field
of a data source <a href="javascript:call_link('abencds_f1_data_source.html')" class="blue"><span class="qtext400">data_source</span></a></li>
</ul>
<ul class="disc">
<li>A case distinction <a href="javascript:call_link('abencds_f1_case_expression.html')" class="blue"><span class="qtext400">CASE</span></a> that returns a value</li>
</ul>
<p>
The data type of the result is defined when the CDS view is activated and is determined by the aggregate
function and the value range of the data types of the operands. If the result of aggregate function
<span class="qtext400">AVG</span> is returned in a results set, the result type is FLTP. As the interim
result in a clause, the result type can be platform-specific. With addition <a href="javascript:call_link('abencds_f1_avg_as.html')" class="blue">
<span class="qtext400">AS dtype</span></a>, the result type can be defined for every operand position.
</p>
<p>
Aggregate expressions can be used as <a href="javascript:call_link('abencds_f1_select_list_entry.html')" class="blue">elements</a>
of a <a href="javascript:call_link('abencds_f1_select_list.html')" class="blue"><span class="qtext400">SELECT</span> list</a>.
Here they need an alternative element name defined using <span class="qtext400">AS</span> and require
a <a href="javascript:call_link('abencds_f1_group_by.html')" class="blue"><span class="qtext400">GROUP BY</span> clause</a> to be used. Aggregate expressions can be compared with
<a href="javascript:call_link('abencds_f1_literal.html')" class="blue">literals</a> in a <a href="javascript:call_link('abencds_f1_having_clause.html')" class="blue"><span class="qtext400">HAVING</span> condition</a>.
</p>
<p>
The operands cannot have the <a href="javascript:call_link('abenddic_builtin_types.html')" class="blue">type</a> LCHR, LRAW, STRING, RAWSTRING, or GEOM_EWKB.
</p>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>The names of the aggregate functions <span class="qtext400">AVG</span>, <span class="qtext400">COUNT</span>,
<span class="qtext400">MAX</span>, <span class="qtext400">MIN</span>, and <span class="qtext400">SUM</span> are protected and cannot be used as self-defined names.</li>
</ul>
<ul class="disc">
<li>To add aggregate expressions in the <span class="qtext400">SELECT</span> list to a CDS view using
<a href="javascript:call_link('abencds_f1_extend_view.html')" class="blue"><span class="qtext400">EXTEND VIEW</span></a>, the
values <span class="qtext400">#PROJECTION_LIST</span> and <span class="qtext400">#GROUP_BY</span> must
be specified with the annotation <a href="javascript:call_link('abencds_f1_view_entity_annotations.html')" class="blue"><span class="qtext400">AbapCatalog.viewEnhancementCategory[ ]</span></a>.</li>
</ul>
<ul class="disc">
<li>The result of the aggregate functions <span class="qtext400">AVG</span> in data type FLTP is platform-dependent.</li>
</ul>
<p><span class="h4">
Example
</span></p>
<p>
In the <span class="qtext400">SELECT</span> list of the CDS view <span class="qtext400">sales_order</span>,
aggregate expressions calculate the sum, the minimum, and the maximum of the gross amounts of each business
partner. Also, the number of requests is determined. An alternative element name is defined for each
aggregation. The non-aggregated fields <span class="qtext400">buyer_guid</span> and <span class="qtext400">currency_code</span> are specified in the <span class="qtext400">GROUP BY</span> clause.
</p>
<dl><dd>
<span class="qtext400">@AbapCatalog.sqlViewName: 'SALES_ORDER_VW' <br>define view sales_order as <br>&nbsp;&nbsp;select from snwd_so <br>
&nbsp;&nbsp;{ key buyer_guid, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Semantics.currencyCode <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currency_code, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Semantics.amount.currencyCode: 'currency_code' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum(gross_amount) as sum_gross_amount, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Semantics.amount.currencyCode: 'currency_code' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min(gross_amount) as min_gross_amount, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Semantics.amount.currencyCode: 'currency_code' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max(gross_amount) as max_gross_amount, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Semantics.amount.currencyCode: 'currency_code' <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avg(gross_amount) as avg_gross_amount, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count(*) as sales_orders_count } <br>&nbsp;&nbsp;group by buyer_guid, currency_code</span>
</dd></dl>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abencds_f1_avg_as.html')" class="blue">ABAP CDS - AVG, AS</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abencds_f1_aggregate_functions.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:36 GMT -->
</html>
