<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPSORT_EXTRACT -->

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapsort_extract.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:35 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="SORT - Extract">
<title>
SORT - Extract - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script language="javascript" type="text/javascript" src="functions.js"></script>
<script type="text/JavaScript">
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapsort_extract.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapsort_extract.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<div style="float:right;">
<input type="button" value="URL"
style="font-size:10px; width:30px; height:18px; padding:0; "
onclick="urlToClipboard('url')" title="Copy URL to Clipboard" ></div>
<p>
<input name="query" id="query" value="" type="text" title="Suchbegriff" size="30" maxlength="30" onkeyup="getInput()">&nbsp;
<input type="button" value="Search"
style="font-size:12px; width:50px; height:18px; padding:0"
onclick="call_search('search.html')" title="Search in ABAP Keyword Documentation" >
<hr style="width:100%;height:1px"></p>
<p class="copyright">AS ABAP Release 754, &copy;Copyright 2019 SAP SE. All rights reserved.</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP &#x2212; Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_obsolete.html')" class="blue">Obsolete Language Elements</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abendata_internal_obsolete.html')" class="blue">Obsolete Processing of Internal Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_extracts_extended.html')" class="blue">Obsolete Extracts</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@SORT - extract@@!ABAP_STATEMENT_OBS!@@"></A>
<p><span class="h1">
SORT - Extract <br><br>
</span></p>
<P>
<a href="javascript:call_link('abapsort_shortref.html')" class="blue">Quick Reference</a> <br><br>
</P>
<p><span class="h2">
<span class="bold">Obsolete Syntax</span>
</span></p>
<P>
<span class="qtext">SORT <i class=bn>[</i>ASCENDING<i class=bn>|</i>DESCENDING<i class=bn>]</i></span> <br>
<span class="qtext">&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i>AS TEXT<i class=bn>]</i></span> <br><span class="qtext">&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i>STABLE<i class=bn>]</i></span> <br>
<span class="qtext">&nbsp;&nbsp;&nbsp;&nbsp; <i class=bn>[</i><a href="javascript:call_link('abapsort_key.html')" class="blue">sort_key</a><i class=bn>]</i>.</span> <br><br>
</P>
<p><span class="h3">
Extras:
</span></p>
<P>
   <A HREF="#!ABAP_ADDITION_1@1@" class="blue"> 1. <span class="qtext">... ASCENDING<i class=bn>|</i>DESCENDING</span> </A> <br>
<br><A HREF="#!ABAP_ADDITION_2@2@" class="blue"> 2. <span class="qtext">... AS TEXT</span> </A> <br><br><A HREF="#!ABAP_ADDITION_3@3@" class="blue"> 3. <span class="qtext">... STABLE</span> </A> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
This statement sorts the <a href="javascript:call_link('abenextract_dataset_glosry.html')" class="grey" title="Glossary Entry">extract
dataset</a> of the program. A prerequisite for executing the statement is that the field group <span class="qtext">
header</span> is defined using the statement <a href="javascript:call_link('abapfield-groups.html')" class="blue"><span class="qtext">FIELD-GROUPS</span></a>,
and is therefore a component of all field groups. If no explicit sort key <a href="javascript:call_link('abapsort_key.html')" class="blue">
<span class="qtext">sort_key</span></a> is specified, the extract dataset is sorted by the components
of the field group <span class="qtext">header</span>. Numeric and byte-like components are sorted according to their value and character-like components are sorted by default according to their binary representation
(<a href="javascript:call_link('abencodepage_glosry.html')" class="grey" title="Glossary Entry">code page</a>). Here, components
containing hexadecimal 0 are placed before other entries. Text sorting for character-like components can be done using the addition <span class="qtext">AS TEXT</span>.
</P>
<P>
The priority of sorting is based on the order in which the components are inserted into the field group
<span class="qtext">header</span> using <a href="javascript:call_link('abapinsert_fg.html')" class="blue"><span class="qtext">INSERT</span></a>.
</P>
<P>
Sorting is unstable by default, which means that the relative order of rows that do not have different
sort keys is not preserved when they are sorted, and can change when a sort is performed multiple times. The addition <span class="qtext">STABLE</span> can be used for stable sorting.
</P>
<P>
The statement <span class="qtext">SORT</span> also finalizes the structure of the extract dataset. Executing
the statement <a href="javascript:call_link('abapextract.html')" class="blue"><span class="qtext">EXTRACT</span></a> after executing the statement <span class="qtext">SORT</span> raises an non-handleable exception. <br><br>
</P>
<p><span class="h4">
Notes
</span></p>
<ul class="disc">
<li>
The only difference in the syntax of the statement <span class="qtext">SORT</span> for the
<a href="javascript:call_link('abenextract_dataset_glosry.html')" class="grey" title="Glossary Entry">extract dataset</a> and
the statement <a href="javascript:call_link('abapsort_itab.html')" class="blue"><span class="qtext">SORT</span> for internal tables</a> is that no internal table is specified. Regardless of this, the two should not be confused with one another.
<br><br></li>
<li>
If components with the content hexadecimal 0 are placed before other entries, this can lead to unexpected behavior when sorting numeric data types.
<br><br></li>
<li>
In global classes, no field groups can be defined or edited. In methods of local classes of programs other than class pools, the statement <span class="qtext">SORT</span> is possible for globally defined field groups.
<br><br></li>
<li>
Extracts are obsolete. <a href="javascript:call_link('abenitab.html')" class="blue">Internal tables</a> are recommended instead. <br><br>
<br></li>
</ul>
<A NAME="@@ASCENDING@@SORT - extract (obsolete)@@"></A>
<A NAME="@@DESCENDING@@SORT - extract (obsolete)@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_1@1@"></A> <span class="bold">Addition 1</span>
</span></p>
<P>
<span class="qtext">... ASCENDING<i class=bn>|</i>DESCENDING</span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<ul class="disc">
<li>
The addition <span class="qtext">ASCENDING</span> or <span class="qtext">DESCENDING</span> can be used
to specify the sort direction explicitly as ascending or descending. If neither addition is specified,
the data is sorted in ascending order by default. The sort direction can be overwritten for individual components in the explicit sort key <span class="qtext">sort_key</span>. <br><br>
<br></li>
</ul>
<A NAME="@@AS TEXT@@SORT - extract (obsolete)@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_2@2@"></A> <span class="bold">Addition 2</span>
</span></p>
<P>
<span class="qtext">... AS TEXT</span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
The addition <span class="qtext">AS TEXT</span> specifies that
<a href="javascript:call_link('abentextlike_data_type_glosry.html')" class="grey" title="Glossary Entry">text-like</a> components are sorted according to the
<a href="javascript:call_link('abenlocale_glosry.html')" class="grey" title="Glossary Entry">locale</a> of the current text environment.
If <span class="qtext">AS TEXT</span> is not specified, text-like components are sorted according to
the encoding in the code page of the current text environment. For more information, see <a href="javascript:call_link('abapsort_itab.html')" class="blue"><span class="qtext">SORT</span> for internal tables</a>. <br><br> <br><br>
</P>
<A NAME="@@STABLE@@SORT - extract (obsolete)@@"></A>
<p><span class="h3">
<A NAME="!ABAP_ADDITION_3@3@"></A> <span class="bold">Addition 3</span>
</span></p>
<P>
<span class="qtext">... STABLE</span>   <br><!-- /A -->
</P>
<p><span class="h4">
Effect
</span></p>
<P>
<span class="qtext">STABLE</span> can be used to perform stable sorting. The relative order of rows,
which is the same in the sort key, remains unchanged when sorting. Without the addition <span class="qtext">STABLE</span>,
the order is not stable and repeated sorting of the extract dataset with the same sort key can change the order in each sort. <br><br>
</P>
<p><span class="h4">
Executable Example
</span></p>
<P>
<a href="javascript:call_link('abenextract_at_abexa.html')" class="blue">Extracts, Processing</a> <br><br>
</P>
<p><span class="h4">
<a href="javascript:call_link('abenabap_language_exceptions.html')" class="blue">Exceptions</a>
</span></p>
<P>
<span class="bold">Non-Handleable Exceptions</span> <br><br>
</P>
<ul class="disc">
<li>
<span class="italic">Cause:</span> A sort field with the explicit addition <span class="qtext">AS TEXT</span> is not text-like. <br>
<span class="italic">Runtime error:</span> <span class="qtext">SORT_AS_TEXT_EX_BAD_TYPE</span>
<br><br></li>
<li>
<span class="italic">Cause:</span> More than 50 sort criteria. <br><span class="italic">Runtime error:</span> <span class="qtext">SORT_EXTRACT_TOO_MANY_FIELDS</span>
<br><br></li>
<li>
<span class="italic">Cause:</span> The field group <span class="qtext">HEADER</span> does not contain a sort criterion. <br><span class="italic">Runtime error:</span> <span class="qtext">SORT_FIELD_NOT_IN_HEADER</span>
<br><br></li>
<li>
<span class="italic">Cause:</span> The field group <span class="qtext">HEADER</span> is not defined. <br><span class="italic">Runtime error:</span> <span class="qtext">SORT_NO_HEADER</span>
<br><br></li>
<li>
<span class="italic">Cause:</span> It is not possible to use <span class="qtext">SORT</span> in a loop through an extract dataset. <br>
<span class="italic">Runtime error:</span> <span class="qtext"> SORT_WITHIN_LOOP</span>
<br><br></li>
<li>
<span class="italic">Cause:</span> Insufficient memory space. <br><span class="italic">Runtime error:</span> <span class="qtext"> SORT_EXTRACT_INDEX_NO_ROLL</span> <br><br> <br><br>
<br></li>
</ul>
<br>
<br>
<!-- POSTFIX --><span class="h4">Continue</span><br>
<a href="javascript:call_link('abapsort_key.html')" class="blue">SORT - sort_key</a><br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_754_index_htm/7.54/en-US/abapsort_extract.htm by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 18 Feb 2024 14:51:35 GMT -->
</html>
